{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Keycloak MCP Server Documentation","text":""},{"location":"#introduction","title":"Introduction","text":"<p>The Keycloak MCP Server is a Model Context Protocol (MCP) server implementation that provides programmatic access to Keycloak administration functionality. This server enables AI assistants and development tools to interact with Keycloak through a standardized interface, supporting operations such as user management, realm configuration, client administration, and authentication flow management.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>User JWT Token Authentication: Each user authenticates with their own Keycloak credentials, ensuring proper permission enforcement</li> <li>Comprehensive Keycloak Operations: Support for users, realms, clients, roles, groups, identity providers, and authentication flows</li> <li>SSE Transport: Server-Sent Events (SSE) transport for HTTP-based communication</li> <li>Production Ready: Deployable on Kubernetes/OpenShift with proper security configurations</li> <li>Containerized: Available as container images with multi-architecture support</li> <li>Native Compilation: Supports GraalVM native image for fast startup and low memory footprint</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<p>The server is built using:</p> <ul> <li>Quarkus Framework: Modern Java framework optimized for cloud-native applications</li> <li>Keycloak Admin Client: Official Keycloak Java client for administrative operations</li> <li>MCP Protocol: Implements the Model Context Protocol for AI assistant integration</li> <li>JWT Authentication: Uses Keycloak's native JWT tokens for user authentication</li> </ul>"},{"location":"#table-of-contents","title":"Table of Contents","text":""},{"location":"#getting-started","title":"Getting Started","text":"<ul> <li>Getting Started Guide - Complete setup instructions for Docker, OpenShift, native binaries, and development mode</li> <li>Authentication Guide - Detailed guide on user JWT token authentication and configuration</li> </ul>"},{"location":"#deployment","title":"Deployment","text":"<ul> <li>OpenShift Deployment - Production deployment guide for OpenShift/Kubernetes</li> <li>Keycloak TLS Setup - Configure HTTPS/TLS for Keycloak in production environments</li> <li>Container Guide - Container image building and deployment using Jib</li> </ul>"},{"location":"#configuration","title":"Configuration","text":"<ul> <li>Port Configuration - Smart port configuration for local development and containers</li> <li>Git Commit Tagging - Automatic container image tagging with git commit SHA</li> <li>Version Automation - Automated version extraction from Maven POM</li> </ul>"},{"location":"#cicd","title":"CI/CD","text":"<ul> <li>GitHub Actions Setup - Configure GitHub Actions for automated builds and deployments</li> <li>CI/CD Updates - Overview of CI/CD pipeline configuration and benefits</li> </ul>"},{"location":"#migration-guides","title":"Migration Guides","text":"<ul> <li>SSE Migration Guide - Migrate from stdio to SSE transport</li> <li>Migration Guide - Migrate from individual tools to unified KeycloakTool</li> </ul>"},{"location":"#technical-documentation","title":"Technical Documentation","text":"<ul> <li>Parametric Collapse - Design pattern for consolidating multiple tools into a single parameterized tool</li> <li>Architecture Diagram - System architecture and component relationships</li> <li>Implementation Summary - Technical implementation details</li> <li>Authentication Implementation - JWT authentication implementation details</li> </ul>"},{"location":"#development","title":"Development","text":"<ul> <li>Developers Guide - Guide for developers contributing to the project</li> <li>Contributors Guide - How to contribute to the project</li> <li>Scripts Guide - Helper scripts for token management and setup</li> </ul>"},{"location":"#release-information","title":"Release Information","text":"<ul> <li>Changelog v0.3.0 - Release notes for version 0.3.0</li> <li>Completion Checklist - Project completion status and milestones</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":""},{"location":"#authentication","title":"Authentication","text":"<p>The MCP server uses JWT Bearer token authentication. Each user must obtain their own JWT token from Keycloak and configure it in their MCP client.</p> <p>Get Token: <pre><code>./scripts/get-mcp-token.sh \\\n  --keycloak-url https://keycloak.example.com \\\n  --username your-username \\\n  --password your-password\n</code></pre></p> <p>Configure MCP Client: <pre><code>{\n  \"mcpServers\": {\n    \"keycloak\": {\n      \"transport\": \"sse\",\n      \"url\": \"https://mcp-server.example.com/mcp/sse\",\n      \"headers\": {\n        \"Authorization\": \"Bearer &lt;your-jwt-token&gt;\"\n      }\n    }\n  }\n}\n</code></pre></p>"},{"location":"#deployment-options","title":"Deployment Options","text":""},{"location":"#docker-container","title":"Docker Container","text":"<pre><code>docker run -d \\\n  --name keycloak-mcp-server \\\n  -p 8080:8080 \\\n  -e KC_URL=https://keycloak.example.com \\\n  -e KC_REALM=master \\\n  -e OIDC_CLIENT_ID=mcp-server \\\n  quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"#openshift","title":"OpenShift","text":"<pre><code>oc apply -f deploy/openshift/\n</code></pre> <p>See the OpenShift Deployment Guide for complete instructions.</p>"},{"location":"#native-binary","title":"Native Binary","text":"<p>Download the native binary for your platform from the releases page and run:</p> <pre><code>export KC_URL=https://keycloak.example.com\nexport KC_REALM=master\nexport OIDC_CLIENT_ID=mcp-server\nexport QUARKUS_HTTP_PORT=8080\n\n./keycloak-mcp-server-linux-x64\n</code></pre>"},{"location":"#available-operations","title":"Available Operations","text":"<p>The Keycloak MCP Server supports the following operations:</p>"},{"location":"#user-management","title":"User Management","text":"<ul> <li>GET_USERS - List all users</li> <li>GET_USER_BY_ID - Get user by ID</li> <li>GET_USER_BY_USERNAME - Get user by username</li> <li>CREATE_USER - Create new user</li> <li>UPDATE_USER - Update existing user</li> <li>DELETE_USER - Delete user</li> <li>RESET_PASSWORD - Reset user password</li> <li>SEND_VERIFICATION_EMAIL - Send verification email</li> <li>COUNT_USERS - Count users in realm</li> </ul>"},{"location":"#realm-management","title":"Realm Management","text":"<ul> <li>GET_REALMS - List all realms</li> <li>GET_REALM - Get specific realm</li> <li>CREATE_REALM - Create new realm</li> </ul>"},{"location":"#client-management","title":"Client Management","text":"<ul> <li>GET_CLIENTS - List all clients</li> <li>GET_CLIENT - Get specific client</li> <li>CREATE_CLIENT - Create new client</li> <li>DELETE_CLIENT - Delete client</li> <li>GENERATE_CLIENT_SECRET - Generate client secret</li> <li>GET_CLIENT_ROLES - Get client roles</li> <li>CREATE_CLIENT_ROLE - Create client role</li> <li>DELETE_CLIENT_ROLE - Delete client role</li> </ul>"},{"location":"#role-management","title":"Role Management","text":"<ul> <li>GET_REALM_ROLES - List realm roles</li> <li>GET_REALM_ROLE - Get specific realm role</li> <li>ADD_ROLE_TO_USER - Assign role to user</li> <li>REMOVE_ROLE_FROM_USER - Remove role from user</li> <li>GET_USER_ROLES - Get user's roles</li> </ul>"},{"location":"#group-management","title":"Group Management","text":"<ul> <li>GET_GROUPS - List all groups</li> <li>GET_GROUP_MEMBERS - Get group members</li> <li>CREATE_GROUP - Create new group</li> <li>UPDATE_GROUP - Update group</li> <li>DELETE_GROUP - Delete group</li> <li>CREATE_SUBGROUP - Create subgroup</li> <li>ADD_USER_TO_GROUP - Add user to group</li> <li>REMOVE_USER_FROM_GROUP - Remove user from group</li> <li>GET_USER_GROUPS - Get user's groups</li> </ul>"},{"location":"#identity-provider-management","title":"Identity Provider Management","text":"<ul> <li>GET_IDENTITY_PROVIDERS - List identity providers</li> <li>GET_IDENTITY_PROVIDER - Get specific identity provider</li> <li>GET_IDENTITY_PROVIDER_MAPPERS - Get identity provider mappers</li> </ul>"},{"location":"#authentication-flow-management","title":"Authentication Flow Management","text":"<ul> <li>GET_AUTHENTICATION_FLOWS - List authentication flows</li> <li>GET_AUTHENTICATION_FLOW - Get specific flow</li> <li>CREATE_AUTHENTICATION_FLOW - Create new flow</li> <li>DELETE_AUTHENTICATION_FLOW - Delete flow</li> <li>GET_FLOW_EXECUTIONS - Get flow executions</li> <li>UPDATE_FLOW_EXECUTION - Update flow execution</li> </ul>"},{"location":"#search","title":"Search","text":"<ul> <li>SEARCH_DISCOURSE - Search Keycloak community forum</li> </ul>"},{"location":"#security-considerations","title":"Security Considerations","text":""},{"location":"#authentication_1","title":"Authentication","text":"<ul> <li>Each user authenticates with their own JWT token</li> <li>Keycloak enforces its native permission system</li> <li>No shared credentials or service accounts</li> <li>Full audit trail by user identity</li> </ul>"},{"location":"#token-management","title":"Token Management","text":"<ul> <li>Tokens have configurable expiration times (recommended: 15-30 minutes)</li> <li>Tokens can be refreshed using refresh tokens</li> <li>Use HTTPS for all token transmission</li> <li>Store tokens securely in client configuration</li> </ul>"},{"location":"#production-deployment","title":"Production Deployment","text":"<ul> <li>Always use HTTPS for Keycloak in production</li> <li>Configure proper TLS certificates</li> <li>Use Kubernetes secrets for sensitive configuration</li> <li>Enable audit logging in Keycloak</li> <li>Implement network policies for pod communication</li> </ul>"},{"location":"#support-and-contributing","title":"Support and Contributing","text":""},{"location":"#documentation","title":"Documentation","text":"<p>Complete documentation is available in this directory. Start with the Getting Started Guide for setup instructions.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome. Please see the Contributors Guide for information on how to contribute to the project.</p>"},{"location":"#issues","title":"Issues","text":"<p>Report issues on the GitHub repository issue tracker.</p>"},{"location":"#community","title":"Community","text":"<ul> <li>Keycloak Discourse: https://keycloak.discourse.group</li> <li>GitHub Repository: https://github.com/sshaaf/keycloak-mcp-server</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the MIT License. See the LICENSE file in the repository root for details.</p> <p>Version: 0.3.0 Last Updated: November 2025 Maintainer: Shaaf Syed</p>"},{"location":"architecture-diagram/","title":"Architecture Diagrams: Before and After Parametric Collapse","text":""},{"location":"architecture-diagram/#before-multiple-tool-classes-original-design","title":"Before: Multiple Tool Classes (Original Design)","text":"<pre><code> MCP Protocol\n (AI Model Interface)\n\n\n Exposes 37+ Individual Tools\n\n\n Tools Layer\n\n UserTool RealmTool ClientTool\n (9 methods) (3 methods) (9 methods)\n\n\n\n RoleTool GroupTool IdPTool\n (2 methods) (5 methods) (3 methods)\n\n\n\n AuthTool\n (6 methods)\n\n\n\n All delegate to...\n\n\n Service Layer\n\n UserService RealmService ClientService\n\n\n\n RoleService GroupService IdPService\n\n\n\n AuthService\n\n\n\n\n\n Keycloak Server\n\n\nPROBLEMS:\n 37+ tools exposed to AI models\n Cluttered API surface\n Difficult to maintain consistency\n Duplicated error handling logic\n Complex tool selection for AI\n</code></pre>"},{"location":"architecture-diagram/#after-single-unified-tool-parametric-collapse","title":"After: Single Unified Tool (Parametric Collapse)","text":"<pre><code> MCP Protocol\n (AI Model Interface)\n\n\n Exposes 1 Tool\n\n\n Tools Layer\n\n\n KeycloakTool\n\n executeKeycloak\n Operation()\n\n params:\n - operation\n - JSON params\n\n\n\n Switch Router\n (45+ operations)\n\n\n\n Routes based on operation enum\n\n\n\n\n\n Service Layer\n\n UserService RealmService ClientService\n\n\n\n RoleService GroupService IdPService\n\n\n\n AuthService\n\n\n\n\n\n Keycloak Server\n\n\nBENEFITS:\n 1 tool exposed to AI models\n Clean, simple API surface\n Centralized error handling\n Consistent logging &amp; validation\n Fast, type-safe routing\n</code></pre>"},{"location":"architecture-diagram/#call-flow-comparison","title":"Call Flow Comparison","text":""},{"location":"architecture-diagram/#before-multiple-tool-classes","title":"Before: Multiple Tool Classes","text":"<pre><code>AI Model Request: \"Create user John Doe\"\n\n\n\n MCP Layer\n\n\n Selects from 37+ tools\n\n UserTool\n .addUser()\n\n\n Delegates\n\n UserService\n .addUser()\n\n\n\n\n Keycloak\n</code></pre>"},{"location":"architecture-diagram/#after-single-unified-tool","title":"After: Single Unified Tool","text":"<pre><code>AI Model Request: \"Create user John Doe\"\n\n\n\n MCP Layer\n\n\n Selects the 1 tool\n\n KeycloakTool\n .executeKeycloak\n Operation()\n\n operation: CREATE_USER\n params: {\n realm: \"quarkus\"\n username: \"jdoe\"\n firstName: \"John\"\n lastName: \"Doe\"\n email: \"...\"\n password: \"...\"\n }\n\n\n Routes via switch\n\n Switch Statement\n case CREATE_USER:\n\n\n Delegates\n\n UserService\n .addUser()\n\n\n\n\n Keycloak\n</code></pre>"},{"location":"architecture-diagram/#operation-routing-detail","title":"Operation Routing Detail","text":"<pre><code> KeycloakTool.executeKeycloakOperation\n\n Input: (operation: KeycloakOperation, params: JSON)\n\n\n Parse JSON params\n JsonNode paramsNode = mapper.readTree()\n\n\n\n\n Switch on operation\n\n switch(operation) {\n case GET_USERS: UserService.getUsers()\n case CREATE_USER: UserService.addUser()\n case GET_REALMS: RealmService.getRealms()\n case CREATE_CLIENT: ClientService.createClient()\n case ADD_ROLE_TO_USER: UserService.addRoleToUser()\n case GET_GROUPS: GroupService.getGroups()\n case GET_AUTHENTICATION_FLOWS: AuthService.getAuthFlows()\n // ... 38 more cases\n }\n\n\n\n\n Serialize result to JSON\n return mapper.writeValueAsString()\n\n\n Exception Handling:\n - Centralized logging\n - Consistent error messages\n - Operation context in errors\n</code></pre>"},{"location":"architecture-diagram/#parameter-structure-comparison","title":"Parameter Structure Comparison","text":""},{"location":"architecture-diagram/#before-individual-parameters","title":"Before: Individual Parameters","text":"<pre><code>// UserTool.addUser() - 6 individual parameters\n@Tool(description = \"Create user\")\nString addUser(\n @ToolArg String realm,\n @ToolArg String username,\n @ToolArg String firstName,\n @ToolArg String lastName,\n @ToolArg String email,\n @ToolArg String password\n)\n</code></pre>"},{"location":"architecture-diagram/#after-structured-json-parameters","title":"After: Structured JSON Parameters","text":"<pre><code>// KeycloakTool.executeKeycloakOperation()\n@Tool(description = \"Execute Keycloak operations\")\nString executeKeycloakOperation(\n @ToolArg KeycloakOperation operation, // Type-safe enum\n @ToolArg String params // Flexible JSON\n)\n\n// Example params:\n{\n \"realm\": \"quarkus\",\n \"username\": \"jdoe\",\n \"firstName\": \"John\",\n \"lastName\": \"Doe\",\n \"email\": \"john@example.com\",\n \"password\": \"secure123\"\n}\n</code></pre>"},{"location":"architecture-diagram/#code-organization-comparison","title":"Code Organization Comparison","text":""},{"location":"architecture-diagram/#before-scattered-across-multiple-files","title":"Before: Scattered Across Multiple Files","text":"<pre><code>src/main/java/dev/shaaf/keycloak/mcp/server/\n user/\n UserService.java (Service logic)\n UserTool.java (9 @Tool methods)\n realm/\n RealmService.java (Service logic)\n RealmTool.java (3 @Tool methods)\n client/\n ClientService.java (Service logic)\n ClientTool.java (9 @Tool methods)\n role/\n RoleService.java (Service logic)\n RoleTool.java (2 @Tool methods)\n group/\n GroupService.java (Service logic)\n GroupTool.java (5 @Tool methods)\n idp/\n IdentityProviderService.java (Service logic)\n IdentityProviderTool.java (3 @Tool methods)\n authentication/\n AuthenticationService.java (Service logic)\n AuthenticationTool.java (6 @Tool methods)\n\nTotal: 14 files for tools layer\n</code></pre>"},{"location":"architecture-diagram/#after-centralized-in-single-file","title":"After: Centralized in Single File","text":"<pre><code>src/main/java/dev/shaaf/keycloak/mcp/server/\n KeycloakTool.java (1 @Tool method, 45+ operations)\n\n user/\n UserService.java (Service logic - unchanged)\n realm/\n RealmService.java (Service logic - unchanged)\n client/\n ClientService.java (Service logic - unchanged)\n role/\n RoleService.java (Service logic - unchanged)\n group/\n GroupService.java (Service logic - unchanged)\n idp/\n IdentityProviderService.java (Service logic - unchanged)\n authentication/\n AuthenticationService.java (Service logic - unchanged)\n\nTotal: 1 file for tools layer\n</code></pre>"},{"location":"architecture-diagram/#complexity-metrics","title":"Complexity Metrics","text":""},{"location":"architecture-diagram/#before","title":"Before","text":"<ul> <li>Tool Classes: 7</li> <li>Tool Methods: 37+</li> <li>MCP Exposed Tools: 37+</li> <li>Lines of Tool Code: ~800 (scattered)</li> <li>Error Handling Patterns: 7 (one per class)</li> <li>JSON Serialization Points: 37+</li> </ul>"},{"location":"architecture-diagram/#after","title":"After","text":"<ul> <li>Tool Classes: 1</li> <li>Tool Methods: 1</li> <li>MCP Exposed Tools: 1</li> <li>Lines of Tool Code: ~450 (centralized)</li> <li>Error Handling Patterns: 1 (unified)</li> <li>JSON Serialization Points: 1</li> </ul>"},{"location":"architecture-diagram/#performance-characteristics","title":"Performance Characteristics","text":"<pre><code> Operation Overhead\n\n\n Before (Direct Method Call):\n MCP \u2192 Tool Method \u2192 Service Method\n Overhead: ~0\u03bcs (direct call)\n\n After (Unified Tool):\n MCP \u2192 Switch \u2192 Service Method\n Overhead: &lt;1\u03bcs (switch statement O(1))\n\n JSON Parsing:\n 100-500\u03bcs (depends on parameter size)\n\n Service Execution:\n 1-1000ms (majority of execution time)\n\n Total Additional Overhead: &lt;0.1% in typical use\n</code></pre>"},{"location":"architecture-diagram/#extension-pattern","title":"Extension Pattern","text":""},{"location":"architecture-diagram/#adding-a-new-operation","title":"Adding a New Operation","text":"<pre><code> Step 1: Add Enum Value\n\n\n public enum KeycloakOperation {\n // ... existing operations\n MY_NEW_OPERATION\n }\n\n\n\n\n\n Step 2: Add Switch Case\n\n\n switch (operation) {\n // ... existing cases\n case MY_NEW_OPERATION:\n return myService.myNewMethod(\n paramsNode.get(\"param1\").asText()\n );\n }\n\n\n\n\n\n Step 3: Update Tool Description\n\n\n @Tool(description = \"... MY_NEW_OPERATION; ...\")\n\n\n\n\n DONE\n</code></pre>"},{"location":"architecture-diagram/#summary","title":"Summary","text":"<p>The Parametric Collapse transformation:</p> <p>Reduced: - 7 tool classes \u2192 1 tool class - 37+ MCP tools \u2192 1 MCP tool - ~800 lines of scattered code \u2192 ~450 lines centralized - 7 error handling patterns \u2192 1 unified pattern</p> <p>Maintained: - All 45+ operations - All service layer code (0 changes) - All functionality - Performance characteristics</p> <p>Improved: - API simplicity for AI models - Code maintainability - Error handling consistency - Extension ease - Documentation clarity</p> <p>Result: Clean, maintainable, scalable architecture</p>"},{"location":"authentication-implementation-summary/","title":"JWT Bearer Token Authentication Implementation Summary","text":""},{"location":"authentication-implementation-summary/#overview","title":"Overview","text":"<p>Implemented user-based authentication for the Keycloak MCP Server using JWT Bearer tokens. This eliminates the security flaw where users could access Keycloak without proper authentication and enables Keycloak's native permission enforcement.</p> <p>Implementation Date: November 21, 2024 Version: 0.4.0 Status: Complete</p>"},{"location":"authentication-implementation-summary/#problem-statement","title":"Problem Statement","text":""},{"location":"authentication-implementation-summary/#security-requirement","title":"Security Requirement","text":"<p>All MCP server operations must enforce user-specific permissions through Keycloak's native access control system.</p>"},{"location":"authentication-implementation-summary/#solution","title":"Solution","text":"<p>Implement JWT Bearer token authentication where: - Each user obtains their own JWT token from Keycloak - The MCP server validates the token - The MCP server uses the user's token for all Keycloak API calls - Keycloak enforces permissions naturally</p>"},{"location":"authentication-implementation-summary/#architecture","title":"Architecture","text":""},{"location":"authentication-implementation-summary/#authentication-flow","title":"Authentication Flow","text":"<pre><code>User \u2192 Keycloak (authenticate)\n \u2193\nUser receives JWT token\n \u2193\nUser \u2192 MCP Server (with JWT in Authorization header)\n \u2193\nMCP Server validates JWT token (OIDC)\n \u2193\nMCP Server \u2192 Keycloak Admin API (using user's token)\n \u2193\nKeycloak enforces user's permissions\n</code></pre>"},{"location":"authentication-implementation-summary/#key-principles","title":"Key Principles","text":"<ul> <li>User tokens only: No shared credentials or service accounts</li> <li>Native permissions: Keycloak enforces its own access control</li> <li>Request-scoped: Each request uses the authenticated user's token</li> <li>Stateless: No session management required</li> </ul>"},{"location":"authentication-implementation-summary/#implementation-details","title":"Implementation Details","text":""},{"location":"authentication-implementation-summary/#1-dependencies-added","title":"1. Dependencies Added","text":"<p>File: <code>pom.xml</code></p> <pre><code>&lt;!-- Security and Authentication --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n  &lt;artifactId&gt;quarkus-oidc&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n  &lt;artifactId&gt;quarkus-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;\n  &lt;artifactId&gt;quarkus-smallrye-health&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Purpose: Enable OIDC token validation, security policies, and health checks</p>"},{"location":"authentication-implementation-summary/#2-oidc-configuration","title":"2. OIDC Configuration","text":"<p>File: <code>src/main/resources/application.properties</code></p> <pre><code># OIDC Configuration - Token Validation\nquarkus.oidc.auth-server-url=${KC_URL}/realms/${KC_REALM:master}\nquarkus.oidc.client-id=${OIDC_CLIENT_ID:mcp-server}\nquarkus.oidc.application-type=service\nquarkus.oidc.token.issuer=${KC_URL}/realms/${KC_REALM:master}\n\n# Security Policies - Require authentication for MCP endpoints\nquarkus.http.auth.permission.mcp.paths=/mcp/*\nquarkus.http.auth.permission.mcp.policy=authenticated\n\n# Public endpoints (health checks, metrics)\nquarkus.http.auth.permission.public.paths=/q/*\nquarkus.http.auth.permission.public.policy=permit\n</code></pre> <p>Purpose: - Validate incoming JWT tokens using OIDC discovery - Require authentication for MCP endpoints - Allow public access to health checks</p>"},{"location":"authentication-implementation-summary/#3-keycloak-client-factory","title":"3. Keycloak Client Factory","text":"<p>File: <code>src/main/java/dev/shaaf/keycloak/mcp/server/KeycloakClientFactory.java</code> (NEW)</p> <p>Purpose: Create Keycloak admin clients using the authenticated user's JWT token</p> <p>Key Features: - Request-scoped (creates client per request) - Uses authenticated user's JWT token for all operations - Validates user authentication before creating client</p> <p>Code Structure:</p> <pre><code>@RequestScoped\npublic class KeycloakClientFactory {\n\n    @Inject SecurityIdentity securityIdentity;\n    @Inject JsonWebToken jwt;\n\n    public Keycloak createClient() {\n        // Requires user authentication\n        if (!securityIdentity.isAnonymous() &amp;&amp; jwt != null) {\n            return KeycloakBuilder.builder()\n                .serverUrl(serverUrl)\n                .realm(realm)\n                .authorization(\"Bearer \" + jwt.getRawToken())\n                .build();\n        }\n\n        throw new IllegalStateException(\"Authentication required\");\n    }\n}\n</code></pre>"},{"location":"authentication-implementation-summary/#4-service-updates","title":"4. Service Updates","text":"<p>Updated Files: All 7 service classes: - <code>UserService.java</code> - <code>RealmService.java</code> - <code>ClientService.java</code> - <code>RoleService.java</code> - <code>GroupService.java</code> - <code>IdentityProviderService.java</code> - <code>AuthenticationFlowService.java</code></p> <p>Changes: - Replaced direct <code>Keycloak</code> injection with <code>KeycloakClientFactory</code> - Updated all methods to use <code>clientFactory.createClient()</code> - Added proper error handling for authentication failures</p>"},{"location":"authentication-implementation-summary/#5-token-helper-script","title":"5. Token Helper Script","text":"<p>File: <code>scripts/get-mcp-token.sh</code></p> <p>Purpose: Help users obtain JWT tokens and generate MCP configuration</p> <p>Features: - Authenticates with Keycloak - Retrieves JWT token - Generates Cursor MCP configuration - Shows token expiration time - Displays user roles</p> <p>Usage:</p> <pre><code>./scripts/get-mcp-token.sh \\\n  --keycloak-url https://keycloak.example.com \\\n  --username your-username \\\n  --password your-password\n</code></pre>"},{"location":"authentication-implementation-summary/#6-deployment-configuration","title":"6. Deployment Configuration","text":"<p>File: <code>deploy/openshift/deployment.yaml</code></p> <p>Environment Variables:</p> <pre><code>env:\n- name: KC_URL\n  valueFrom:\n    configMapKeyRef:\n      name: keycloak-mcp-config\n      key: keycloak-url\n- name: KC_REALM\n  valueFrom:\n    configMapKeyRef:\n      name: keycloak-mcp-config\n      key: keycloak-realm\n- name: OIDC_CLIENT_ID\n  valueFrom:\n    configMapKeyRef:\n      name: keycloak-mcp-config\n      key: client-id\n</code></pre> <p>Note: No secrets required. Token validation uses public OIDC discovery.</p>"},{"location":"authentication-implementation-summary/#user-configuration","title":"User Configuration","text":""},{"location":"authentication-implementation-summary/#mcp-client-configuration","title":"MCP Client Configuration","text":"<p>File: <code>~/.cursor/mcp.json</code></p> <pre><code>{\n  \"mcpServers\": {\n    \"keycloak\": {\n      \"transport\": \"sse\",\n      \"url\": \"https://mcp-server.example.com/mcp/sse\",\n      \"headers\": {\n        \"Authorization\": \"Bearer &lt;user-jwt-token&gt;\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"authentication-implementation-summary/#obtaining-token","title":"Obtaining Token","text":"<p>Users obtain their token using the helper script:</p> <pre><code>./scripts/get-mcp-token.sh \\\n  --keycloak-url https://keycloak.example.com \\\n  --username their-username \\\n  --password their-password\n</code></pre> <p>The script outputs the complete MCP configuration with the token.</p>"},{"location":"authentication-implementation-summary/#security-benefits","title":"Security Benefits","text":""},{"location":"authentication-implementation-summary/#1-user-specific-permissions","title":"1. User-Specific Permissions","text":"<p>Each user's permissions are enforced by Keycloak:</p> <ul> <li>Realm Access: Users only see realms they have access to</li> <li>Role-Based Access: Admin, manager, viewer roles work naturally</li> <li>Client Access: Limited to authorized clients</li> <li>Operation Restrictions: Based on assigned roles</li> </ul>"},{"location":"authentication-implementation-summary/#2-no-shared-credentials","title":"2. No Shared Credentials","text":"<ul> <li>No service account secrets in deployment</li> <li>No shared admin passwords</li> <li>Each user authenticates individually</li> <li>Tokens expire automatically</li> </ul>"},{"location":"authentication-implementation-summary/#3-full-audit-trail","title":"3. Full Audit Trail","text":"<p>Keycloak logs show:</p> <ul> <li>Which user performed each action</li> <li>When the action occurred</li> <li>What operations were performed</li> <li>Success or failure status</li> </ul>"},{"location":"authentication-implementation-summary/#4-native-access-control","title":"4. Native Access Control","text":"<ul> <li>Uses Keycloak's built-in permission system</li> <li>No duplicate authorization logic in MCP server</li> <li>Consistent with other Keycloak clients</li> <li>Leverage existing role assignments</li> </ul>"},{"location":"authentication-implementation-summary/#testing-and-validation","title":"Testing and Validation","text":""},{"location":"authentication-implementation-summary/#validation-steps","title":"Validation Steps","text":"<ol> <li> <p>Deploy Updated MCP Server <pre><code>oc apply -f deploy/openshift/\n</code></pre></p> </li> <li> <p>User Obtains Token <pre><code>./scripts/get-mcp-token.sh --keycloak-url &lt;url&gt; --username &lt;user&gt;\n</code></pre></p> </li> <li> <p>Configure MCP Client    Update <code>~/.cursor/mcp.json</code> with user token</p> </li> <li> <p>Test Operations</p> </li> <li>List realms - should only show accessible realms</li> <li>List users - should respect permissions</li> <li>Attempt restricted operation - should fail appropriately</li> </ol>"},{"location":"authentication-implementation-summary/#test-results","title":"Test Results","text":"<ul> <li>User with admin role: Full access to all operations</li> <li>User with view-only role: Can read but not modify</li> <li>User without realm access: Cannot see other realms</li> <li>Expired token: Returns 401 Unauthorized</li> </ul>"},{"location":"authentication-implementation-summary/#documentation","title":"Documentation","text":""},{"location":"authentication-implementation-summary/#new-documentation-created","title":"New Documentation Created","text":"<ol> <li>authentication.md - Complete authentication guide</li> <li>AUTHENTICATION_implementation-summary.md - This document</li> <li>Updated getting-started.md - JWT authentication instructions</li> <li>Updated openshift-deployment.md - Simplified deployment (no secrets)</li> </ol>"},{"location":"authentication-implementation-summary/#documentation-updates","title":"Documentation Updates","text":"<ul> <li>Removed all service account references</li> <li>Updated environment variable lists</li> <li>Added token management instructions</li> <li>Included troubleshooting guides</li> </ul>"},{"location":"authentication-implementation-summary/#migration-impact","title":"Migration Impact","text":""},{"location":"authentication-implementation-summary/#breaking-changes","title":"Breaking Changes","text":"<ul> <li>Users must now obtain their own JWT tokens</li> <li>MCP client configuration requires Authorization header</li> <li>No unauthenticated access to MCP endpoints</li> </ul>"},{"location":"authentication-implementation-summary/#migration-path","title":"Migration Path","text":"<ol> <li>Deploy updated MCP server</li> <li>Users run token helper script</li> <li>Users update their MCP configuration</li> <li>Users reload MCP servers in client</li> </ol>"},{"location":"authentication-implementation-summary/#technical-achievements","title":"Technical Achievements","text":""},{"location":"authentication-implementation-summary/#code-quality","title":"Code Quality","text":"<ul> <li>Simplified authentication logic (removed fallback code)</li> <li>Better separation of concerns</li> <li>Request-scoped client creation</li> <li>Proper error handling</li> </ul>"},{"location":"authentication-implementation-summary/#security-improvements","title":"Security Improvements","text":"<ul> <li>Eliminated shared credential vulnerability</li> <li>Enforces principle of least privilege</li> <li>Provides full audit trail</li> <li>Uses industry-standard OAuth2/OIDC</li> </ul>"},{"location":"authentication-implementation-summary/#operational-benefits","title":"Operational Benefits","text":"<ul> <li>No secrets in deployment manifests</li> <li>Simplified configuration</li> <li>Better user experience (own permissions)</li> <li>Easier to debug (per-user operations)</li> </ul>"},{"location":"authentication-implementation-summary/#summary","title":"Summary","text":"<p>Successfully implemented JWT Bearer token authentication for the Keycloak MCP Server. The implementation:</p> <ol> <li>Eliminates security flaws - no shared admin access</li> <li>Enforces user permissions - Keycloak's native access control</li> <li>Provides audit trail - all actions under user identity</li> <li>Simplifies deployment - no secrets required</li> <li>Includes tooling - helper scripts for easy adoption</li> <li>Documented thoroughly - guides for users and administrators</li> </ol> <p>The MCP server now operates as a transparent, authenticated proxy that enforces Keycloak's existing permission system, making it suitable for production use with proper access control.</p> <p>Status: Implementation Complete Version: 0.4.0 Date: November 21, 2024</p>"},{"location":"authentication/","title":"Keycloak MCP Server Authentication","text":""},{"location":"authentication/#overview","title":"Overview","text":"<p>The Keycloak MCP Server implements user-based authentication using JWT Bearer tokens. This means:</p> <p>Each user authenticates with their own credentials Keycloak enforces its existing permission system No duplicate permission logic in the MCP server Realm isolation works automatically Role-based access control (RBAC) works naturally</p>"},{"location":"authentication/#how-it-works","title":"How It Works","text":"<pre><code> User MCP Server Keycloak\n(Cursor)\n\n\n 1. Get JWT Token\n &gt;\n &lt;\n JWT Token (with user's permissions)\n\n 2. MCP Request + JWT Token\n &gt;\n 3. Validate Token\n &gt;\n &lt;\n Token Valid\n\n 4. Call Admin API (user token)\n &gt;\n\n 5. Keycloak checks permissions\n - Realm access?\n - Role permissions?\n - Client access?\n &lt;\n &lt; Response (filtered)\n MCP Response\n</code></pre>"},{"location":"authentication/#key-benefits","title":"Key Benefits","text":"<ol> <li>Automatic Permission Enforcement</li> <li>The MCP server uses the user's token to call Keycloak</li> <li>Keycloak naturally enforces its own permissions</li> <li> <p>No need to duplicate permission logic</p> </li> <li> <p>Realm Isolation</p> </li> <li>Users can only access realms they have permissions for</li> <li>Read-only users can't modify resources</li> <li> <p>Admin users have full access</p> </li> <li> <p>Audit Trail</p> </li> <li>All actions are logged under the user's identity</li> <li>No shared admin account</li> <li>Clear accountability</li> </ol>"},{"location":"authentication/#authentication-methods","title":"Authentication Methods","text":""},{"location":"authentication/#1-user-token-authentication-production","title":"1. User Token Authentication (Production)","text":"<p>Recommended for: Production deployments, multi-user environments</p> <p>How it works: - User authenticates with Keycloak and gets a JWT token - Token is added to Cursor MCP configuration - MCP server validates token and uses it for Keycloak API calls - Keycloak enforces user's permissions</p> <p>Setup:</p> <pre><code># Get your personal token\n./scripts/get-mcp-token.sh \\\n --keycloak-url https://keycloak.example.com \\\n --username alice \\\n --password alice-password\n\n# Add to ~/.cursor/mcp.json\n{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"https://mcp-server.example.com/mcp/sse\",\n \"headers\": {\n \"Authorization\": \"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...\"\n }\n }\n }\n}\n</code></pre>"},{"location":"authentication/#configuration","title":"Configuration","text":""},{"location":"authentication/#application-properties","title":"Application Properties","text":"<pre><code># ============================================================\n# AUTHENTICATION &amp; AUTHORIZATION\n# ============================================================\n\n# OIDC Configuration - Token Validation\nquarkus.oidc.auth-server-url=${KC_URL}/realms/${KC_REALM:master}\nquarkus.oidc.client-id=${OIDC_CLIENT_ID:mcp-server}\nquarkus.oidc.credentials.secret=${OIDC_CLIENT_SECRET:}\nquarkus.oidc.application-type=service\nquarkus.oidc.token.issuer=${KC_URL}/realms/${KC_REALM:master}\n\n# Security Policies - Require authentication for MCP endpoints\nquarkus.http.auth.permission.mcp.paths=/mcp/*\nquarkus.http.auth.permission.mcp.policy=authenticated\n\n# Public endpoints (health checks, metrics)\nquarkus.http.auth.permission.public.paths=/q/*\nquarkus.http.auth.permission.public.policy=permit\n\n# Development Mode - Disable authentication for local dev\n%dev.quarkus.http.auth.permission.mcp.policy=permit\n%dev.quarkus.oidc.enabled=false\n</code></pre>"},{"location":"authentication/#environment-variables","title":"Environment Variables","text":"Variable Description Required Example <code>KC_URL</code> Keycloak server URL Yes <code>https://keycloak.example.com</code> <code>KC_REALM</code> Default Keycloak realm No <code>master</code> (default) <code>OIDC_CLIENT_ID</code> OIDC client ID for token validation No <code>mcp-server</code> (default)"},{"location":"authentication/#getting-your-token","title":"Getting Your Token","text":""},{"location":"authentication/#method-1-using-the-helper-script","title":"Method 1: Using the Helper Script","text":"<pre><code>./scripts/get-mcp-token.sh \\\n --keycloak-url https://keycloak.example.com \\\n --realm master \\\n --username your-username \\\n --password your-password \\\n --mcp-url https://mcp-server.example.com/mcp/sse\n</code></pre> <p>The script will: 1. Authenticate with Keycloak 2. Get your JWT token 3. Generate Cursor MCP configuration 4. Show token expiration time 5. Display your realm roles and permissions</p>"},{"location":"authentication/#method-2-manual-token-request","title":"Method 2: Manual Token Request","text":"<pre><code># Get token\nTOKEN=$(curl -X POST \\\n https://keycloak.example.com/realms/master/protocol/openid-connect/token \\\n -d 'grant_type=password' \\\n -d 'client_id=admin-cli' \\\n -d 'username=your-username' \\\n -d 'password=your-password' | jq -r '.access_token')\n\n# Use in Cursor config\necho $TOKEN\n</code></pre>"},{"location":"authentication/#token-management","title":"Token Management","text":""},{"location":"authentication/#token-expiration","title":"Token Expiration","text":"<p>JWT tokens have a limited lifespan (typically 5-60 minutes). When your token expires:</p> <ol> <li>Symptoms:</li> <li>MCP operations fail with <code>401 Unauthorized</code></li> <li> <p>\"Token expired\" errors in logs</p> </li> <li> <p>Solution:</p> </li> <li>Generate a new token</li> <li>Update <code>~/.cursor/mcp.json</code></li> <li>Reload MCP servers in Cursor</li> </ol>"},{"location":"authentication/#token-refresh","title":"Token Refresh","text":"<p>If you have a refresh token:</p> <pre><code># Refresh your token\nNEW_TOKEN=$(curl -X POST \\\n https://keycloak.example.com/realms/master/protocol/openid-connect/token \\\n -d 'grant_type=refresh_token' \\\n -d 'client_id=admin-cli' \\\n -d 'refresh_token=your-refresh-token' | jq -r '.access_token')\n</code></pre>"},{"location":"authentication/#long-lived-tokens-development-only","title":"Long-Lived Tokens (Development Only)","text":"<p>For development convenience, you can increase token lifespan in Keycloak:</p> <ol> <li>Keycloak Admin Console</li> <li>Realm Settings \u2192 Tokens tab</li> <li>Access Token Lifespan \u2192 Set to desired duration (e.g., 24 hours)</li> </ol> <p>Warning: Long-lived tokens are a security risk in production!</p>"},{"location":"authentication/#permission-examples","title":"Permission Examples","text":""},{"location":"authentication/#scenario-1-admin-user","title":"Scenario 1: Admin User","text":"<p>User: Alice (admin role in master realm)</p> <p>What Alice can do: <pre><code> List all realms\n Create/delete realms\n Manage users in all realms\n Configure clients\n Manage authentication flows\n Everything!\n</code></pre></p> <p>Token claims: <pre><code>{\n \"realm_access\": {\n \"roles\": [\"admin\", \"create-realm\", \"offline_access\", \"uma_authorization\"]\n },\n \"resource_access\": {\n \"master-realm\": {\n \"roles\": [\"view-realm\", \"manage-users\", \"manage-clients\", ...]\n }\n }\n}\n</code></pre></p>"},{"location":"authentication/#scenario-2-realm-specific-user","title":"Scenario 2: Realm-Specific User","text":"<p>User: Bob (manager role in <code>quarkus</code> realm only)</p> <p>What Bob can do: <pre><code> List realm: quarkus\n Manage users in quarkus realm\n View clients in quarkus realm\n Access master realm\n Access other realms\n Create new realms\n</code></pre></p> <p>Token claims: <pre><code>{\n \"realm_access\": {\n \"roles\": [\"offline_access\"]\n },\n \"resource_access\": {\n \"quarkus-realm\": {\n \"roles\": [\"view-realm\", \"manage-users\", \"view-clients\"]\n }\n }\n}\n</code></pre></p>"},{"location":"authentication/#scenario-3-read-only-user","title":"Scenario 3: Read-Only User","text":"<p>User: Carol (viewer role)</p> <p>What Carol can do: <pre><code> List realms (that she has access to)\n View users\n View clients\n View authentication flows\n Create/delete/update anything\n</code></pre></p> <p>Token claims: <pre><code>{\n \"realm_access\": {\n \"roles\": [\"offline_access\"]\n },\n \"resource_access\": {\n \"master-realm\": {\n \"roles\": [\"view-realm\", \"view-users\", \"view-clients\"]\n }\n }\n}\n</code></pre></p>"},{"location":"authentication/#security-best-practices","title":"Security Best Practices","text":""},{"location":"authentication/#1-use-strong-passwords","title":"1. Use Strong Passwords","text":"<pre><code># Bad\n--password admin\n\n# Good\n--password \"Str0ng!P@ssw0rd#2024\"\n</code></pre>"},{"location":"authentication/#2-rotate-tokens-regularly","title":"2. Rotate Tokens Regularly","text":"<pre><code># Set shorter token lifespan in Keycloak\nAccess Token Lifespan: 5 minutes (for sensitive operations)\nRefresh Token Lifespan: 30 minutes\n</code></pre>"},{"location":"authentication/#3-use-different-accounts-per-environment","title":"3. Use Different Accounts per Environment","text":"<pre><code>Development: dev-user\nStaging: staging-user\nProduction: prod-user\n</code></pre>"},{"location":"authentication/#4-monitor-token-usage","title":"4. Monitor Token Usage","text":"<p>Check Keycloak's admin console: - Events \u2192 Login Events - Monitor failed authentication attempts - Review active sessions</p>"},{"location":"authentication/#5-revoke-compromised-tokens","title":"5. Revoke Compromised Tokens","text":"<p>If a token is compromised:</p> <pre><code># Logout user (revokes all tokens)\ncurl -X POST \\\n https://keycloak.example.com/realms/master/protocol/openid-connect/logout \\\n -d 'client_id=admin-cli' \\\n -d 'refresh_token=compromised-token'\n</code></pre>"},{"location":"authentication/#development-mode","title":"Development Mode","text":"<p>For local development without authentication:</p> <pre><code># Start in dev mode\nmvn quarkus:dev\n\n# No authentication required\ncurl http://localhost:8080/mcp/sse\n</code></pre> <p>Dev mode automatically: - Disables OIDC authentication - Allows unauthenticated access for development convenience</p>"},{"location":"authentication/#troubleshooting","title":"Troubleshooting","text":""},{"location":"authentication/#issue-401-unauthorized","title":"Issue: 401 Unauthorized","text":"<p>Cause: Token is invalid or expired</p> <p>Solution: 1. Check token expiration:  <pre><code>echo \"$TOKEN\" | cut -d'.' -f2 | base64 -d | jq '.exp'\n</code></pre></p> <ol> <li> <p>Generate new token:  <pre><code>./scripts/get-mcp-token.sh --keycloak-url ... --username ... --password ...\n</code></pre></p> </li> <li> <p>Update Cursor config and reload MCP servers</p> </li> </ol>"},{"location":"authentication/#issue-403-forbidden","title":"Issue: 403 Forbidden","text":"<p>Cause: User doesn't have required permissions</p> <p>Solution: 1. Check your Keycloak roles:  <pre><code># In Keycloak Admin Console\nUsers \u2192 Your User \u2192 Role Mappings\n</code></pre></p> <ol> <li>Assign necessary roles:</li> <li><code>admin</code> - Full access</li> <li><code>manage-users</code> - User management</li> <li><code>view-realm</code> - Read-only access</li> </ol>"},{"location":"authentication/#issue-token-validation-failed","title":"Issue: Token Validation Failed","text":"<p>Cause: OIDC configuration mismatch</p> <p>Solution: 1. Verify environment variables:  <pre><code>echo $KC_URL\necho $KC_REALM\necho $OIDC_CLIENT_ID\n</code></pre></p> <ol> <li> <p>Check MCP server logs:  <pre><code># Look for OIDC validation errors\noc logs deployment/keycloak-mcp-server | grep OIDC\n</code></pre></p> </li> <li> <p>Ensure Keycloak issuer matches:  <pre><code>curl -s $KC_URL/realms/$KC_REALM/.well-known/openid-configuration | jq .issuer\n</code></pre></p> </li> </ol>"},{"location":"authentication/#issue-different-user-than-expected","title":"Issue: Different User Than Expected","text":"<p>Cause: Token belongs to different user</p> <p>Solution: 1. Decode your token to see who you are:  <pre><code>echo \"$TOKEN\" | cut -d'.' -f2 | base64 -d | jq .preferred_username\n</code></pre></p> <ol> <li>Ensure you are using the correct username when getting token</li> </ol>"},{"location":"authentication/#summary","title":"Summary","text":"<p>User Authentication: Each user gets their own JWT token  Permission Enforcement: Keycloak handles all authorization  Realm Isolation: Users can only access their authorized realms  Audit Trail: All actions logged under user identity  No Duplicate Logic: No permission code in MCP server  Standard OAuth2: Industry-standard authentication  Simple &amp; Secure: No shared credentials or service accounts</p> <p>For more information: - getting-started.md - Setup instructions - get-mcp-token.sh - Token helper script - openshift-deployment.md - Production deployment guide</p> <p>**Happy Keycloak management! **</p>"},{"location":"changelog-v0.3.0/","title":"Changelog v0.3.0 - SSE Migration","text":""},{"location":"changelog-v0.3.0/#release-date","title":"Release Date","text":"<p>November 20, 2025</p>"},{"location":"changelog-v0.3.0/#major-changes","title":"Major Changes","text":""},{"location":"changelog-v0.3.0/#sse-transport-breaking-change","title":"SSE Transport (Breaking Change)","text":"<p>Migrated from stdin/stdout communication to SSE (Server-Sent Events) HTTP-based transport.</p> <p>Impact: This is a breaking change for client configurations. Clients need to be updated to use HTTP/SSE instead of process-based stdin/stdout.</p>"},{"location":"changelog-v0.3.0/#what-changed","title":"What Changed","text":""},{"location":"changelog-v0.3.0/#1-dependency-update","title":"1. Dependency Update","text":"<ul> <li>Removed: <code>quarkus-mcp-server-stdio</code> (v1.4.0)</li> <li>Added: <code>quarkus-mcp-server-sse</code> (v1.4.0)</li> </ul>"},{"location":"changelog-v0.3.0/#2-quarkus-version-update","title":"2. Quarkus Version Update","text":"<ul> <li>Updated from 3.24.5 to 3.29.4</li> </ul>"},{"location":"changelog-v0.3.0/#3-configuration-changes","title":"3. Configuration Changes","text":"<p>New <code>application.properties</code> settings: <pre><code># HTTP Server\nquarkus.http.port=8080\nquarkus.http.host=0.0.0.0\n\n# CORS (for browser access)\nquarkus.http.cors=true\nquarkus.http.cors.origins=*\n\n# MCP SSE Endpoint\nquarkus.mcp.server.sse.path=/mcp/sse\nquarkus.mcp.server.sse.enabled=true\n</code></pre></p>"},{"location":"changelog-v0.3.0/#4-server-endpoints","title":"4. Server Endpoints","text":"<p>New HTTP endpoints available: - MCP SSE: <code>http://localhost:8080/mcp/sse</code> - Health: <code>http://localhost:8080/q/health</code> - Metrics: <code>http://localhost:8080/q/metrics</code></p>"},{"location":"changelog-v0.3.0/#what-stayed-the-same","title":"What Stayed the Same","text":"<ul> <li>All 46 operations work exactly as before</li> <li>Parametric Collapse pattern unchanged</li> <li>KeycloakTool unified tool interface unchanged</li> <li>Service layer (UserService, RealmService, etc.) unchanged</li> <li>All functionality preserved</li> </ul>"},{"location":"changelog-v0.3.0/#new-features","title":"New Features","text":""},{"location":"changelog-v0.3.0/#http-based-communication","title":"HTTP-Based Communication","text":"<ul> <li>Server runs as HTTP service on port 8080</li> <li>Can be accessed via standard HTTP clients</li> <li>Works through firewalls and proxies</li> </ul>"},{"location":"changelog-v0.3.0/#multiple-client-support","title":"Multiple Client Support","text":"<ul> <li>Multiple clients can connect simultaneously</li> <li>Browser-based clients supported</li> <li>Network distribution enabled</li> </ul>"},{"location":"changelog-v0.3.0/#observability","title":"Observability","text":"<ul> <li>Health check endpoints</li> <li>Prometheus metrics</li> <li>Better logging and monitoring</li> </ul>"},{"location":"changelog-v0.3.0/#container-friendly","title":"Container-Friendly","text":"<ul> <li>Docker/Kubernetes ready</li> <li>Better for microservices</li> <li>Load balancer compatible</li> </ul>"},{"location":"changelog-v0.3.0/#migration-guide","title":"Migration Guide","text":"<p>See sse-migration-guide.md for complete migration instructions.</p>"},{"location":"changelog-v0.3.0/#quick-start","title":"Quick Start","text":"<ol> <li> <p>Start the server: <pre><code>./mvnw quarkus:dev\n</code></pre></p> </li> <li> <p>Update client config (Cursor example): <pre><code>{\n \"mcpServers\": {\n \"keycloak-mcp-server\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\",\n \"env\": {\n \"KC_URL\": \"http://localhost:8180\",\n \"KC_USER\": \"admin\",\n \"KC_PASSWORD\": \"admin\"\n }\n }\n }\n}\n</code></pre></p> </li> <li> <p>Test the connection: <pre><code>curl http://localhost:8080/q/health\n</code></pre></p> </li> </ol>"},{"location":"changelog-v0.3.0/#documentation-updates","title":"Documentation Updates","text":""},{"location":"changelog-v0.3.0/#new-files","title":"New Files","text":"<ul> <li><code>sse-migration-guide.md</code> - Complete SSE migration guide</li> <li><code>CHANGELOG_v0.3.0.md</code> - This file</li> </ul>"},{"location":"changelog-v0.3.0/#updated-files","title":"Updated Files","text":"<ul> <li><code>README.md</code> - Updated with SSE configuration</li> <li><code>pom.xml</code> - Dependency and version updates</li> <li><code>application.properties</code> - SSE configuration</li> </ul>"},{"location":"changelog-v0.3.0/#breaking-changes","title":"Breaking Changes","text":""},{"location":"changelog-v0.3.0/#client-configuration-required","title":"Client Configuration Required","text":"<p>Before (v0.2.0 - stdin): <pre><code>{\n \"mcpServers\": {\n \"keycloak-mcp-server\": {\n \"command\": \"java\",\n \"args\": [\"-jar\", \"path/to/keycloak-mcp-server.jar\"],\n \"env\": {...}\n }\n }\n}\n</code></pre></p> <p>After (v0.3.0 - SSE): <pre><code>{\n \"mcpServers\": {\n \"keycloak-mcp-server\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\",\n \"env\": {...}\n }\n }\n}\n</code></pre></p>"},{"location":"changelog-v0.3.0/#server-must-be-started-separately","title":"Server Must Be Started Separately","text":"<p>With SSE, the server runs independently as an HTTP service: - v0.2.0: Client started the server process - v0.3.0: Server must be running before clients connect</p>"},{"location":"changelog-v0.3.0/#upgrade-path","title":"Upgrade Path","text":""},{"location":"changelog-v0.3.0/#for-developers","title":"For Developers","text":"<ol> <li>Update to v0.3.0</li> <li>Start server: <code>./mvnw quarkus:dev</code></li> <li>Update client configs to use SSE</li> <li>Test operations</li> </ol>"},{"location":"changelog-v0.3.0/#for-production","title":"For Production","text":"<ol> <li>Build new version: <code>./mvnw package</code></li> <li>Update deployment configs (Docker/K8s)</li> <li>Configure CORS for production domains</li> <li>Consider adding authentication</li> <li>Deploy and update client configurations</li> </ol>"},{"location":"changelog-v0.3.0/#advantages-over-stdin","title":"Advantages Over stdin","text":"Feature stdin (v0.2.0) SSE (v0.3.0) Transport Process-based HTTP-based Multiple Clients No Yes Browser Access No Yes Network Distribution No Yes Load Balancing No Yes Health Checks No Yes Metrics Limited Full Debugging Difficult Easy Container-Friendly Moderate Excellent"},{"location":"changelog-v0.3.0/#known-issues","title":"Known Issues","text":"<p>None at this time.</p>"},{"location":"changelog-v0.3.0/#future-enhancements","title":"Future Enhancements","text":"<p>Planned for future releases: - WebSocket transport option - Built-in authentication - Rate limiting - Request caching - GraphQL endpoint</p>"},{"location":"changelog-v0.3.0/#contributors","title":"Contributors","text":"<p>Thank you to all contributors who helped with this release!</p>"},{"location":"changelog-v0.3.0/#references","title":"References","text":"<ul> <li>Quarkus 3.29.4 Release Notes</li> <li>MCP Protocol Specification</li> <li>Server-Sent Events (SSE) MDN Docs</li> </ul> <p>Full Changelog: v0.2.0...v0.3.0</p>"},{"location":"ci-cd-updates/","title":"CI/CD Updates - Automatic Container Push to Quay.io","text":""},{"location":"ci-cd-updates/#summary","title":"Summary","text":"<p>The GitHub Actions workflows have been updated to automatically build and push container images to Quay.io on every push to the <code>main</code> branch and during releases.</p>"},{"location":"ci-cd-updates/#what-changed","title":"What Changed","text":""},{"location":"ci-cd-updates/#1-updated-githubworkflowsbuild-artifactsyml","title":"1. Updated <code>.github/workflows/build-artifacts.yml</code>","text":"<p>Added new job: <code>build-and-push-container</code></p> <ul> <li>Triggers: Only on push to <code>main</code> branch (not on PRs)</li> <li>Purpose: Build and push container images automatically</li> <li>Images pushed:</li> <li><code>quay.io/sshaaf/keycloak-mcp-server:&lt;git-sha&gt;</code> (e.g., <code>49ff54e</code>)</li> <li><code>quay.io/sshaaf/keycloak-mcp-server:latest</code></li> </ul> <p>Features: - Full git history checkout for git SHA tagging - Maven caching for faster builds - Automatic git commit SHA extraction - GitHub Actions summary with image details - No Docker daemon required (uses Jib)</p>"},{"location":"ci-cd-updates/#2-updated-githubworkflowsreleaseyml","title":"2. Updated <code>.github/workflows/release.yml</code>","text":"<p>Added new job: <code>build-and-push-container</code></p> <ul> <li>Triggers: Manual workflow dispatch (releases)</li> <li>Purpose: Build and push container images with version tagging</li> <li>Images pushed:</li> <li><code>quay.io/sshaaf/keycloak-mcp-server:&lt;git-sha&gt;</code> (e.g., <code>49ff54e</code>)</li> <li><code>quay.io/sshaaf/keycloak-mcp-server:&lt;version&gt;</code> (e.g., <code>0.3.0</code>)</li> <li><code>quay.io/sshaaf/keycloak-mcp-server:latest</code></li> </ul> <p>Features: - Automatic version extraction from <code>pom.xml</code> (no hardcoded versions!) - Creates semantic version tag - Integrated with release workflow - Runs before GitHub release creation</p> <p>Version Management: The workflow automatically extracts the version from <code>pom.xml</code> using Maven: <pre><code>mvn help:evaluate -Dexpression=project.version -q -DforceStdout\n</code></pre> This ensures the GitHub Actions version always matches your Maven project version - no manual updates needed!</p>"},{"location":"ci-cd-updates/#3-created-github-actions-setupmd","title":"3. Created <code>github-actions-setup.md</code>","text":"<p>Comprehensive guide covering: - How to set up GitHub Secrets (<code>QUAY_USERNAME</code>, <code>QUAY_PASSWORD</code>) - Robot account setup on Quay.io - Workflow triggers and conditions - Tagging strategy explained - Troubleshooting guide - Security best practices</p>"},{"location":"ci-cd-updates/#4-updated-readmemd","title":"4. Updated <code>README.md</code>","text":"<ul> <li>Added \"CI/CD and Container Images\" section</li> <li>Linked to GitHub Actions Setup guide</li> <li>Highlighted automatic container builds</li> </ul>"},{"location":"ci-cd-updates/#required-setup","title":"Required Setup","text":""},{"location":"ci-cd-updates/#github-secrets","title":"GitHub Secrets","text":"<p>You must configure these secrets in your GitHub repository:</p> <ol> <li><code>QUAY_USERNAME</code>: Your Quay.io username or robot account</li> <li><code>QUAY_PASSWORD</code>: Your Quay.io password or robot token</li> </ol> <p>How to add secrets: 1. Go to repository \u2192 Settings \u2192 Secrets and variables \u2192 Actions 2. Click New repository secret 3. Add <code>QUAY_USERNAME</code> and <code>QUAY_PASSWORD</code></p> <p>Recommended: Use a Quay.io robot account for better security: - Create robot account at: https://quay.io/repository/sshaaf/keycloak-mcp-server - Use robot name as username (e.g., <code>sshaaf+github_actions</code>) - Use robot token as password</p>"},{"location":"ci-cd-updates/#how-it-works","title":"How It Works","text":""},{"location":"ci-cd-updates/#workflow-1-regular-development-push-to-main","title":"Workflow 1: Regular Development (Push to main)","text":"<pre><code># Developer pushes to main\ngit commit -m \"Add new feature\"\ngit push origin main\n\n# GitHub Actions automatically:\n# 1. Builds JAR and native binaries\n# 2. Builds container image with Jib\n# 3. Tags with git commit SHA + latest\n# 4. Pushes to quay.io/sshaaf/keycloak-mcp-server\n\n# Result:\n# - quay.io/sshaaf/keycloak-mcp-server:49ff54e\n# - quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"ci-cd-updates/#workflow-2-pull-request","title":"Workflow 2: Pull Request","text":"<pre><code># Developer creates PR\ngit push origin feature-branch\n\n# GitHub Actions:\n# 1. Builds JAR and native binaries\n# 2. Does NOT push container image\n#\n# Why? Saves resources and prevents cluttering the registry\n</code></pre>"},{"location":"ci-cd-updates/#workflow-3-release","title":"Workflow 3: Release","text":"<pre><code># Maintainer triggers release workflow\n\n# GitHub Actions:\n# 1. Builds JAR and native binaries\n# 2. Builds container image with Jib\n# 3. Tags with git SHA + version + latest\n# 4. Pushes to Quay.io\n# 5. Creates GitHub release\n\n# Result:\n# - quay.io/sshaaf/keycloak-mcp-server:49ff54e\n# - quay.io/sshaaf/keycloak-mcp-server:0.3.0\n# - quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"ci-cd-updates/#tag-strategy","title":"Tag Strategy","text":"Event Git SHA Tag Version Tag Latest Tag Push to main Yes No Yes Pull Request No build No build No build Release Yes Yes Yes"},{"location":"ci-cd-updates/#why-this-strategy","title":"Why This Strategy?","text":"<ol> <li>Git SHA Tags: Perfect traceability</li> <li>Every commit gets a unique tag</li> <li>Production deployments can reference exact code</li> <li> <p>Easy rollbacks</p> </li> <li> <p>Version Tags: Semantic releases</p> </li> <li>Only created during official releases</li> <li>Manual control over versioning</li> <li> <p>Clear release history</p> </li> <li> <p>Latest Tag: Development convenience</p> </li> <li>Always points to most recent build</li> <li>Good for testing</li> <li>Not recommended for production</li> </ol>"},{"location":"ci-cd-updates/#using-the-images","title":"Using the Images","text":""},{"location":"ci-cd-updates/#pull-latest","title":"Pull Latest","text":"<pre><code>docker pull quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"ci-cd-updates/#pull-specific-commit","title":"Pull Specific Commit","text":"<pre><code>docker pull quay.io/sshaaf/keycloak-mcp-server:49ff54e\n</code></pre>"},{"location":"ci-cd-updates/#pull-release-version","title":"Pull Release Version","text":"<pre><code>docker pull quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre>"},{"location":"ci-cd-updates/#run-container","title":"Run Container","text":"<pre><code>docker run -d \\\n -p 8080:8080 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n -e KC_USER=admin \\\n -e KC_PASSWORD=admin \\\n --name keycloak-mcp \\\n quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"ci-cd-updates/#benefits","title":"Benefits","text":""},{"location":"ci-cd-updates/#1-automation","title":"1. Automation","text":"<ul> <li>No manual container builds</li> <li>No manual tagging</li> <li>No manual pushing</li> <li>Consistent process every time</li> </ul>"},{"location":"ci-cd-updates/#2-traceability","title":"2. Traceability","text":"<ul> <li>Every image has git SHA</li> <li>Can trace back to exact source code</li> <li>Easy to find what changed</li> </ul>"},{"location":"ci-cd-updates/#3-efficiency","title":"3. Efficiency","text":"<ul> <li>PRs don't push images (saves resources)</li> <li>Only tested code gets published</li> <li>Multi-architecture builds (AMD64 + ARM64)</li> </ul>"},{"location":"ci-cd-updates/#4-security","title":"4. Security","text":"<ul> <li>Robot accounts with minimal permissions</li> <li>Secrets never exposed in logs</li> <li>Automatic vulnerability scanning on Quay.io</li> </ul>"},{"location":"ci-cd-updates/#5-flexibility","title":"5. Flexibility","text":"<ul> <li>Manual releases still available</li> <li>Can override tags when needed</li> <li>Local builds work the same way</li> </ul>"},{"location":"ci-cd-updates/#verification","title":"Verification","text":""},{"location":"ci-cd-updates/#1-check-github-actions","title":"1. Check GitHub Actions","text":"<p>Go to: https://github.com/sshaaf/keycloak-mcp-server/actions</p> <p>Look for the \"Build and Push\" workflow and check the summary.</p>"},{"location":"ci-cd-updates/#2-check-quayio","title":"2. Check Quay.io","text":"<p>Go to: https://quay.io/repository/sshaaf/keycloak-mcp-server?tab=tags</p> <p>You should see: - <code>latest</code> tag - Git commit SHA tags (e.g., <code>49ff54e</code>) - Version tags (e.g., <code>0.3.0</code>) for releases</p>"},{"location":"ci-cd-updates/#3-pull-and-test","title":"3. Pull and Test","text":"<pre><code># Pull the image\ndocker pull quay.io/sshaaf/keycloak-mcp-server:latest\n\n# Check image labels\ndocker inspect quay.io/sshaaf/keycloak-mcp-server:latest | grep -A5 Labels\n\n# Run it\ndocker run --rm quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"ci-cd-updates/#troubleshooting","title":"Troubleshooting","text":""},{"location":"ci-cd-updates/#issue-container-push-fails","title":"Issue: Container Push Fails","text":"<p>Check: 1. Are secrets configured correctly? 2. Is the Quay.io repository created? 3. Does the robot account have write permissions?</p> <p>Solution: See github-actions-setup.md</p>"},{"location":"ci-cd-updates/#issue-images-not-pushed-on-main","title":"Issue: Images Not Pushed on Main","text":"<p>Check: 1. Did you push to <code>main</code> branch? 2. Check workflow condition in YAML 3. Review GitHub Actions logs</p>"},{"location":"ci-cd-updates/#issue-git-sha-shows-as-placeholder","title":"Issue: Git SHA Shows as Placeholder","text":"<p>Check: 1. Ensure <code>fetch-depth: 0</code> in checkout 2. Verify git-commit-id-maven-plugin is working 3. Check Maven build logs</p>"},{"location":"ci-cd-updates/#next-steps","title":"Next Steps","text":"<ol> <li>Set up secrets: Configure <code>QUAY_USERNAME</code> and <code>QUAY_PASSWORD</code></li> <li>Test push: Push a commit to <code>main</code> and watch the workflow</li> <li>Verify images: Check Quay.io for the pushed images</li> <li>Pull and test: Try pulling and running the image</li> </ol>"},{"location":"ci-cd-updates/#documentation","title":"Documentation","text":"<ul> <li>github-actions-setup.md - Complete setup guide</li> <li>git-commit-tagging.md - Git SHA tagging details</li> <li>jib-container-guide.md - Jib configuration</li> <li>index.md - Main project documentation</li> </ul>"},{"location":"ci-cd-updates/#summary_1","title":"Summary","text":"<p>Automatic Builds: Every push to <code>main</code> builds and pushes images  Git SHA Tagging: Perfect traceability with commit SHAs  Release Versioning: Semantic versions on releases  Multi-Architecture: AMD64 and ARM64 support  No Docker Required: Jib handles everything  Secure: Robot accounts and GitHub Secrets</p> <p>Your CI/CD pipeline is now fully automated!</p> <p>Next push to <code>main</code> will automatically build and publish your container images to Quay.io.</p>"},{"location":"completion-checklist/","title":"Implementation Complete: Parametric Collapse Strategy","text":""},{"location":"completion-checklist/#completion-status-100","title":"Completion Status: 100%","text":""},{"location":"completion-checklist/#deliverables","title":"Deliverables","text":""},{"location":"completion-checklist/#1-core-implementation","title":"1. Core Implementation","text":"<ul> <li>[x] KeycloakTool.java - Single unified tool class</li> <li>Location: <code>src/main/java/dev/shaaf/keycloak/mcp/server/KeycloakTool.java</code></li> <li>Lines: ~450</li> <li>Operations: 45+</li> <li>Status: Compiled Successfully</li> </ul>"},{"location":"completion-checklist/#2-example-code","title":"2. Example Code","text":"<ul> <li>[x] KeycloakToolExample.java - Practical usage examples</li> <li>Location: <code>src/main/java/dev/shaaf/keycloak/mcp/server/examples/KeycloakToolExample.java</code></li> <li>Examples: 10+ real-world scenarios</li> <li>Status: Compiled Successfully</li> </ul>"},{"location":"completion-checklist/#3-documentation","title":"3. Documentation","text":"<ul> <li>[x] parametric-collapse.md - Comprehensive pattern documentation</li> <li>Size: ~350 lines</li> <li>Content: Pattern explanation, 15+ examples, complete operation list</li> <li> <p>Status: Complete</p> </li> <li> <p>[x] migration-guide.md - Migration from old tools</p> </li> <li>Size: ~450 lines</li> <li>Content: Before/after comparisons, 45+ operation mappings</li> <li> <p>Status: Complete</p> </li> <li> <p>[x] architecture-diagram.md - Visual architecture documentation</p> </li> <li>Content: Before/after diagrams, call flows, metrics</li> <li> <p>Status: Complete</p> </li> <li> <p>[x] implementation-summary.md - High-level summary</p> </li> <li>Content: Overview, statistics, benefits, future enhancements</li> <li> <p>Status: Complete</p> </li> <li> <p>[x] README.md - Updated main documentation</p> </li> <li>Added: Parametric Collapse feature section</li> <li>Added: Architecture explanation</li> <li>Status: Updated</li> </ul>"},{"location":"completion-checklist/#4-build-status","title":"4. Build Status","text":"<ul> <li>[x] Compilation: SUCCESS</li> <li>[x] No Linter Errors: CLEAN</li> <li>[x] Build Output: 22 source files compiled successfully</li> </ul>"},{"location":"completion-checklist/#implementation-statistics","title":"Implementation Statistics","text":""},{"location":"completion-checklist/#code-metrics","title":"Code Metrics","text":"Metric Before After Change Tool Classes 7 1 -86% Tool Methods 37+ 1 -97% MCP Exposed Tools 37+ 1 -97% Tool Code Lines ~800 ~450 -44% Service Classes 7 7 No change"},{"location":"completion-checklist/#operations-supported","title":"Operations Supported","text":"Category Operations User 15 Realm 3 Client 8 Role 2 Group 6 Identity Provider 3 Authentication 6 Total 45+"},{"location":"completion-checklist/#files-created","title":"Files Created","text":"<ol> <li><code>src/main/java/dev/shaaf/keycloak/mcp/server/KeycloakTool.java</code></li> <li><code>src/main/java/dev/shaaf/keycloak/mcp/server/examples/KeycloakToolExample.java</code></li> <li><code>parametric-collapse.md</code></li> <li><code>migration-guide.md</code></li> <li><code>architecture-diagram.md</code></li> <li><code>implementation-summary.md</code></li> <li><code>COMPLETION_CHECKLIST.md</code> (this file)</li> </ol>"},{"location":"completion-checklist/#files-modified","title":"Files Modified","text":"<ol> <li><code>README.md</code> - Added Parametric Collapse sections</li> </ol>"},{"location":"completion-checklist/#files-preserved-unchanged","title":"Files Preserved (Unchanged)","text":"<p>All service layer files remain untouched : - <code>src/main/java/dev/shaaf/keycloak/mcp/server/user/UserService.java</code> - <code>src/main/java/dev/shaaf/keycloak/mcp/server/realm/RealmService.java</code> - <code>src/main/java/dev/shaaf/keycloak/mcp/server/client/ClientService.java</code> - <code>src/main/java/dev/shaaf/keycloak/mcp/server/role/RoleService.java</code> - <code>src/main/java/dev/shaaf/keycloak/mcp/server/group/GroupService.java</code> - <code>src/main/java/dev/shaaf/keycloak/mcp/server/idp/IdentityProviderService.java</code> - <code>src/main/java/dev/shaaf/keycloak/mcp/server/authentication/AuthenticationService.java</code></p>"},{"location":"completion-checklist/#quality-assurance","title":"Quality Assurance","text":""},{"location":"completion-checklist/#compilation","title":"Compilation","text":"<pre><code>[INFO] BUILD SUCCESS\n[INFO] Compiling 22 source files with javac [debug release 21]\n[INFO] Total time: 1.674 s\n</code></pre>"},{"location":"completion-checklist/#code-quality","title":"Code Quality","text":"<ul> <li>[x] No linter errors</li> <li>[x] Follows project conventions</li> <li>[x] Consistent error handling</li> <li>[x] Comprehensive logging</li> <li>[x] Type-safe enum usage</li> </ul>"},{"location":"completion-checklist/#documentation-quality","title":"Documentation Quality","text":"<ul> <li>[x] Clear examples provided</li> <li>[x] Before/after comparisons</li> <li>[x] Visual diagrams included</li> <li>[x] Complete operation reference</li> <li>[x] Migration guidance</li> </ul>"},{"location":"completion-checklist/#usage-quick-start","title":"Usage Quick Start","text":""},{"location":"completion-checklist/#basic-example","title":"Basic Example","text":"<pre><code>keycloakTool.executeKeycloakOperation(\n KeycloakOperation.GET_USERS,\n \"{\\\"realm\\\": \\\"quarkus\\\"}\"\n)\n</code></pre>"},{"location":"completion-checklist/#advanced-example","title":"Advanced Example","text":"<pre><code>keycloakTool.executeKeycloakOperation(\n KeycloakOperation.CREATE_USER,\n \"{\" +\n \" \\\"realm\\\": \\\"quarkus\\\",\" +\n \" \\\"username\\\": \\\"jdoe\\\",\" +\n \" \\\"firstName\\\": \\\"John\\\",\" +\n \" \\\"lastName\\\": \\\"Doe\\\",\" +\n \" \\\"email\\\": \\\"john@example.com\\\",\" +\n \" \\\"password\\\": \\\"secure123\\\"\" +\n \"}\"\n)\n</code></pre>"},{"location":"completion-checklist/#key-benefits-achieved","title":"Key Benefits Achieved","text":""},{"location":"completion-checklist/#1-simplified-api","title":"1. Simplified API","text":"<ul> <li>From 37+ tools to 1 tool</li> <li>Cleaner interface for AI models</li> <li>Faster tool selection</li> </ul>"},{"location":"completion-checklist/#2-improved-maintainability","title":"2. Improved Maintainability","text":"<ul> <li>Centralized routing logic</li> <li>Unified error handling</li> <li>Single point for updates</li> </ul>"},{"location":"completion-checklist/#3-better-developer-experience","title":"3. Better Developer Experience","text":"<ul> <li>Type-safe operations via enum</li> <li>Flexible JSON parameters</li> <li>Clear documentation</li> </ul>"},{"location":"completion-checklist/#4-enhanced-extensibility","title":"4. Enhanced Extensibility","text":"<ul> <li>Easy to add new operations</li> <li>Consistent patterns</li> <li>Minimal code changes required</li> </ul>"},{"location":"completion-checklist/#testing-instructions","title":"Testing Instructions","text":""},{"location":"completion-checklist/#compile-the-project","title":"Compile the Project","text":"<pre><code>cd /Users/sshaaf/git/java/keycloak-mcp-server\nmvn clean compile\n</code></pre>"},{"location":"completion-checklist/#build-the-jar","title":"Build the JAR","text":"<pre><code>mvn package\n</code></pre>"},{"location":"completion-checklist/#run-the-server","title":"Run the Server","text":"<pre><code>java -jar target/keycloak-mcp-server-0.2.0-runner.jar\n</code></pre>"},{"location":"completion-checklist/#test-with-mcp-client","title":"Test with MCP Client","text":"<p>Configure your MCP client (Goose, Claude Desktop, etc.) and try: 1. Get all users: <code>operation: GET_USERS, params: {realm: \"quarkus\"}</code> 2. Create a user: <code>operation: CREATE_USER, params: {...}</code> 3. Add role to user: <code>operation: ADD_ROLE_TO_USER, params: {...}</code></p>"},{"location":"completion-checklist/#documentation-reference","title":"Documentation Reference","text":"Document Purpose Location parametric-collapse.md Complete pattern guide Link migration-guide.md Migration instructions Link architecture-diagram.md Visual architecture Link implementation-summary.md High-level overview Link KeycloakToolExample.java Code examples (deleted) N/A index.md Main documentation Link"},{"location":"completion-checklist/#next-steps-optional","title":"Next Steps (Optional)","text":""},{"location":"completion-checklist/#for-production-use","title":"For Production Use","text":"<ol> <li>Code is ready to use immediately</li> <li>Consider keeping old tool classes for backward compatibility</li> <li>Plan deprecation timeline for old tools</li> <li>Update any existing integrations</li> </ol>"},{"location":"completion-checklist/#for-further-enhancement","title":"For Further Enhancement","text":"<ul> <li>[ ] Add JSON schema validation for parameters</li> <li>[ ] Implement rate limiting per operation</li> <li>[ ] Add operation-level metrics</li> <li>[ ] Consider async operation support</li> <li>[ ] Add bulk/batch operation support</li> </ul>"},{"location":"completion-checklist/#for-old-tool-classes","title":"For Old Tool Classes","text":"<p>Two options: 1. Keep for backward compatibility (Recommended)  - Deprecate with @Deprecated annotation  - Add warnings in documentation  - Plan removal in future major version</p> <ol> <li>Remove immediately (Clean break)</li> <li>Delete all *Tool.java files (except KeycloakTool)</li> <li>Update any tests</li> <li>Force migration to new tool</li> </ol>"},{"location":"completion-checklist/#sign-off","title":"Sign-Off","text":""},{"location":"completion-checklist/#implementation-details","title":"Implementation Details","text":"<ul> <li>Pattern: Parametric Collapse Strategy</li> <li>Implementation Date: November 20, 2025</li> <li>Project: Keycloak MCP Server v0.2.0</li> <li>Language: Java 21</li> <li>Framework: Quarkus 3.24.5</li> </ul>"},{"location":"completion-checklist/#status-summary","title":"Status Summary","text":"<p>COMPLETE AND READY FOR USE</p> <ul> <li>Core implementation: DONE</li> <li>Example code: DONE</li> <li>Documentation: COMPREHENSIVE</li> <li>Compilation: SUCCESS</li> <li>Testing: VERIFIED</li> </ul>"},{"location":"completion-checklist/#contact-support","title":"Contact &amp; Support","text":"<p>For questions or issues: - Check the documentation files listed above - Review KeycloakToolExample.java for code patterns - Open an issue on GitHub - Refer to the migration-guide.md for migration help</p> <p>**Implementation completed successfully! **</p> <p>The Keycloak MCP Server now implements the Parametric Collapse pattern, reducing complexity from 37+ tools to 1 unified tool while maintaining all functionality and improving maintainability.</p>"},{"location":"contributors/","title":"Contributing to Keycloak MCP Server","text":"<p>Thank you for your interest in contributing to Keycloak MCP Server! This document provides guidelines and instructions for contributors.</p>"},{"location":"contributors/#code-of-conduct","title":"Code of Conduct","text":"<p>Please be respectful and considerate of others when contributing to this project. We aim to foster an inclusive and welcoming community.</p>"},{"location":"contributors/#how-to-contribute","title":"How to Contribute","text":""},{"location":"contributors/#reporting-issues","title":"Reporting Issues","text":"<p>If you find a bug or have a suggestion for improving Keycloak MCP Server: 1. Check if the issue already exists in the GitHub Issues 2. If not, create a new issue with a descriptive title and detailed information about:  - What you expected to happen  - What actually happened  - Steps to reproduce the issue  - Your environment (OS, Java version, Keycloak version, etc.)</p>"},{"location":"contributors/#pull-requests","title":"Pull Requests","text":"<p>Pull requests are welcomed for bug fixes, improvements, and new features: 1. Fork the repository 2. Create a new branch for your changes 3. Make your changes 4. Write or update tests as needed 5. Ensure all tests pass with <code>./gradlew test</code> 6. Make a sanity test locally, to check nothing is broken 7. Submit a pull request</p>"},{"location":"contributors/#pull-request-process","title":"Pull Request Process","text":"<ol> <li>Update the README.md or documentation with details of changes if appropriate</li> <li>The PR should work on all supported platforms (Linux, macOS, Windows)</li> <li>PRs require review from at least one maintainer before merging</li> <li>Once approved, a maintainer will merge your PR</li> </ol>"},{"location":"contributors/#development-workflow","title":"Development Workflow","text":"<ol> <li>Clone your fork of the repository</li> <li>Set up the development environment as described in the developers.md file</li> <li>Make your changes in a new git branch</li> <li>Test your changes thoroughly</li> <li>Push your branch to GitHub and submit a pull request</li> </ol>"},{"location":"contributors/#coding-standards","title":"Coding Standards","text":"<ul> <li>Follow the existing code style in the project</li> <li>Write clear, readable, and maintainable code</li> <li>Include comments where necessary</li> <li>Write unit tests for new functionality</li> <li>Follow Java best practices</li> </ul>"},{"location":"contributors/#commit-message-format","title":"Commit Message Format","text":"<p>To control the version number, use conventional commit messages: - <code>fix: ...</code> - for bug fixes (creates a PATCH release) - <code>feat: ...</code> - for new features (creates a MINOR release) - <code>feat!: ...</code> or <code>fix!: ...</code> or any commit with <code>BREAKING CHANGE:</code> in the footer - for breaking changes (creates a MAJOR release)</p>"},{"location":"contributors/#working-with-keycloak","title":"Working with Keycloak","text":"<p>When contributing features that interact with Keycloak: 1. Ensure your code works with the supported Keycloak versions 2. Test your changes against a running Keycloak instance 3. Document any Keycloak-specific configuration requirements</p>"},{"location":"contributors/#license","title":"License","text":"<p>This project is distributed under the MIT License. See the <code>LICENSE</code> file for more information.</p>"},{"location":"developers/","title":"Keycloak MCP Server Developer Guide","text":"<p>This guide provides detailed technical information for developers working on the Keycloak MCP Server project.</p>"},{"location":"developers/#building-from-source","title":"Building from Source","text":"<ol> <li>Clone the repository:  <pre><code>git clone https://github.com/yourusername/keycloak-mcp-server.git\ncd keycloak-mcp-server\n</code></pre></li> <li>Build the project:  <pre><code>./mvnw clean package\n</code></pre></li> </ol>"},{"location":"developers/#github-actions-builds","title":"GitHub Actions Builds","text":"<p>Keycloak MCP Server uses GitHub Actions to automatically build and test the project on every commit.</p>"},{"location":"developers/#accessing-built-artifacts","title":"Accessing Built Artifacts","text":"<ol> <li>Go to the Actions tab in the GitHub repository.</li> <li>Click on the latest workflow run.</li> <li>Scroll down to the \"Artifacts\" section to download the built artifacts.</li> </ol>"},{"location":"developers/#releases","title":"Releases","text":"<p>Official releases are created when changes are pushed to the main branch. You can find the latest release with all artifacts on the Releases page.</p>"},{"location":"developers/#running-the-application","title":"Running the Application","text":"<p>The Keycloak MCP Server is built using Quarkus, which provides fast startup times and a low memory footprint.</p>"},{"location":"developers/#prerequisites","title":"Prerequisites","text":"<ul> <li>Java 21 or higher</li> <li>Maven 3.6 or higher</li> <li>Keycloak server (for integration)</li> </ul>"},{"location":"developers/#running-in-development-mode","title":"Running in Development Mode","text":"<p>To run the application in development mode: <pre><code>./mvnw quarkus:dev\n</code></pre></p> <p>This enables hot deployment with background compilation, allowing you to make changes to the code and automatically reload the application.</p>"},{"location":"developers/#configuration","title":"Configuration","text":"<p>The application can be configured using the <code>application.properties</code> file located in <code>src/main/resources/</code>. Key configuration properties include:</p> <ul> <li><code>quarkus.keycloak.url</code>: The URL of the Keycloak server</li> </ul> <p>An example docker-compose file is provided for local development.</p>"},{"location":"developers/#testing","title":"Testing","text":"<p>Keycloak MCP Server includes a comprehensive test suite to ensure code quality and prevent regressions.</p>"},{"location":"developers/#running-tests","title":"Running Tests","text":"<p>To run the tests locally: <pre><code>./mvnw test\n</code></pre></p> <p>This will execute all tests and generate a report in <code>build/reports/tests/test/index.html</code>.</p>"},{"location":"developers/#continuous-integration","title":"Continuous Integration","text":"<p>The GitHub Actions workflow automatically runs all tests for: - Every push to the main branch - Every pull request targeting the main branch</p> <p>This ensures that all code changes pass tests before being merged, maintaining code quality and preventing regressions.</p>"},{"location":"developers/#project-architecture","title":"Project Architecture","text":"<p>Follows a layered architecture with tool classes that expose functionality through the MCP protocol and service classes that handle the actual operations with Keycloak. Each tool class follows a similar pattern: - Injects a corresponding service class that handles the actual operations with Keycloak - Injects an ObjectMapper for JSON serialization/deserialization - Exposes methods with @Tool annotations that delegate to the service class</p>"},{"location":"developers/#class-structure","title":"Class Structure","text":"<p>The project includes the following main components:</p> <ul> <li>Service Layer: Handles the actual operations with Keycloak</li> <li><code>UserService</code>: Manages user-related operations</li> <li><code>RealmService</code>: Manages realm-related operations</li> <li><code>ClientService</code>: Manages client-related operations</li> <li><code>RoleService</code>: Manages role-related operations</li> <li><code>GroupService</code>: Manages group-related operations</li> <li><code>IdentityProviderService</code>: Manages identity provider-related operations</li> <li> <p><code>AuthenticationService</code>: Manages authentication flow-related operations</p> </li> <li> <p>Tools Layer: Exposes functionality through the MCP protocol</p> </li> <li><code>UserTool</code>: Exposes user-related operations</li> <li><code>RealmTool</code>: Exposes realm-related operations</li> <li><code>ClientTool</code>: Exposes client-related operations</li> <li><code>RoleTool</code>: Exposes role-related operations</li> <li><code>GroupTool</code>: Exposes group-related operations</li> <li><code>IdentityProviderTool</code>: Exposes identity provider-related operations</li> <li><code>AuthenticationTool</code>: Exposes authentication flow-related operations</li> </ul>"},{"location":"developers/#class-diagram","title":"Class Diagram","text":"<p>Below is a class diagram showing the structure of the tools package and its relationships with the service layer:</p> <pre><code>graph TD\n subgraph \"Goose CLI\"\n GooseCLI[Goose CLI]\n end\n\n subgraph \"Tools Layer\"\n UserTool[\"UserTool\"]\n RealmTool[\"RealmTool\"]\n ClientTool[\"ClientTool\"]\n RoleTool[\"RoleTool\"]\n GroupTool[\"GroupTool\"]\n end\n\n subgraph \"Service Layer\"\n UserService[\"UserService\"]\n RealmService[\"RealmService\"]\n ClientService[\"ClientService\"]\n RoleService[\"RoleService\"]\n GroupService[\"GroupService\"]\n end\n\n subgraph \"External Services\"\n Keycloak[(\"Keycloak\")]\n end\n\n %% Define Relationships\n GooseCLI --&gt; UserTool\n GooseCLI --&gt; RealmTool\n GooseCLI --&gt; ClientTool\n GooseCLI --&gt; RoleTool\n GooseCLI --&gt; GroupTool\n\n UserTool --&gt; UserService\n RealmTool --&gt; RealmService\n ClientTool --&gt; ClientService\n RoleTool --&gt; RoleService\n GroupTool --&gt; GroupService\n\n UserService --&gt; Keycloak\n RealmService --&gt; Keycloak\n ClientService --&gt; Keycloak\n RoleService --&gt; Keycloak\n GroupService --&gt; Keycloak\n\n %% Styling\n style GooseCLI fill:#d4edda,stroke:#c3e6cb\n style Keycloak fill:#f8d7da,stroke:#f5c6cb\n</code></pre>"},{"location":"developers/#architecture","title":"Architecture","text":"<p>The project follows a layered architecture with tool classes that expose functionality through the MCP protocol and service classes that handle the actual operations with Keycloak.</p>"},{"location":"developers/#tools-package-explanation","title":"Tools Package Explanation","text":"<p>The tools package contains classes that expose Keycloak functionality through the MCP protocol:</p> <ol> <li> <p>UserTool: Manages Keycloak users, including creation, deletion, updating user information, and managing user roles and groups.</p> </li> <li> <p>RealmTool: Manages Keycloak realms, including creation, deletion, updating realm settings, and managing realm events configuration.</p> </li> <li> <p>ClientTool: Manages Keycloak clients, including creation, deletion, updating client settings, managing client secrets, and client roles.</p> </li> <li> <p>RoleTool: Manages Keycloak roles, including creation, deletion, updating role settings, and managing role composites.</p> </li> <li> <p>GroupTool: Manages Keycloak groups, including creation, deletion, updating group settings, managing group members, and group roles.</p> </li> </ol> <p>Each tool class follows a similar pattern: - Injects a corresponding service class that handles the actual operations with Keycloak - Injects an ObjectMapper for JSON serialization/deserialization - Exposes methods with @Tool annotations that delegate to the service class - Handles exceptions and provides meaningful error messages</p>"},{"location":"developers/#building-via-source-and-running-locally","title":"Building via source and running locally","text":"<p>You can start a local Keycloak instance using Docker Compose:</p> <pre><code>docker-compose -f deploy/docker-compose.yml up\n</code></pre>"},{"location":"developers/#building-the-application","title":"Building the Application","text":"<p>To build the application using Maven:</p> <pre><code>./mvnw clean package\n</code></pre> <p>To build an uber jar:</p> <pre><code>./mvnw clean package -Dquarkus.package.type=uber-jar\n</code></pre>"},{"location":"getting-started/","title":"Getting Started with Keycloak MCP Server","text":"<p>This guide will help you get started with the Keycloak MCP Server using different deployment methods.</p>"},{"location":"getting-started/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Prerequisites</li> <li>Deployment Options</li> <li>Option 1: Docker Container (Local)</li> <li>Option 2: OpenShift Deployment</li> <li>Option 3: Native Binary</li> <li>Option 4: Development Mode (Username/Password)</li> <li>Configuring Cursor IDE</li> <li>Testing Your Setup</li> <li>Available Operations</li> <li>Troubleshooting</li> </ol>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":""},{"location":"getting-started/#for-all-deployment-methods","title":"For All Deployment Methods","text":"<ul> <li>Keycloak Instance: A running Keycloak server (v22.0+)</li> <li>Local: <code>http://localhost:8180</code> or <code>https://localhost:8543</code></li> <li>Production: <code>https://keycloak.example.com</code></li> <li>Cursor IDE: Latest version with MCP support</li> </ul>"},{"location":"getting-started/#for-authentication","title":"For Authentication","text":"<ul> <li>Keycloak instance running (v20.0 or later)</li> <li>Keycloak user account with appropriate permissions</li> <li>Access to obtain JWT tokens from Keycloak</li> </ul>"},{"location":"getting-started/#for-development-mode-legacy","title":"For Development Mode (Legacy)","text":"<ul> <li>Keycloak admin username and password</li> </ul>"},{"location":"getting-started/#deployment-options","title":"Deployment Options","text":""},{"location":"getting-started/#option-1-docker-container-local","title":"Option 1: Docker Container (Local)","text":""},{"location":"getting-started/#step-1-pull-the-container-image","title":"Step 1: Pull the Container Image","text":"<pre><code>docker pull quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"getting-started/#step-2-configure-keycloak-client","title":"Step 2: Configure Keycloak Client","text":"<p>Note: The MCP server validates JWT tokens using OIDC discovery. No client secret is required.</p> <ol> <li>(Optional) Create a client in Keycloak for OIDC validation:</li> <li>Client ID: <code>mcp-server</code></li> <li>Client authentication: OFF (public client)</li> <li>Standard flow: ON</li> <li> <p>Direct access grants: ON</p> </li> <li> <p>Users authenticate with their own Keycloak credentials to obtain JWT tokens</p> </li> </ol>"},{"location":"getting-started/#step-3-run-the-container","title":"Step 3: Run the Container","text":"<p>Production/Remote Keycloak:</p> <pre><code>docker run -d \\\n --name keycloak-mcp-server \\\n -p 8080:8080 \\\n -e KC_URL=https://keycloak.example.com \\\n -e KC_REALM=master \\\n -e OIDC_CLIENT_ID=mcp-server \\\n quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre> <p>Local Keycloak (macOS/Windows):</p> <pre><code>docker run -d \\\n --name keycloak-mcp-server \\\n -p 8080:8080 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n -e KC_REALM=master \\\n -e OIDC_CLIENT_ID=mcp-server \\\n quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre> <p>Note: Use <code>host.docker.internal</code> instead of <code>localhost</code> to access services running on your host</p> <p>Local Keycloak (Linux):</p> <pre><code>docker run -d \\\n --name keycloak-mcp-server \\\n --network host \\\n -e KC_URL=http://localhost:8180 \\\n -e KC_REALM=master \\\n -e OIDC_CLIENT_ID=mcp-server \\\n quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"getting-started/#step-4-verify-the-container-is-running","title":"Step 4: Verify the Container is Running","text":"<pre><code># Check container status\ndocker ps | grep keycloak-mcp-server\n\n# Check logs\ndocker logs keycloak-mcp-server\n\n# Test health endpoint\ncurl http://localhost:8080/q/health\n</code></pre>"},{"location":"getting-started/#step-5-configure-cursor-mcp","title":"Step 5: Configure Cursor MCP","text":"<p>Edit <code>~/.cursor/mcp.json</code>:</p> <pre><code>{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\"\n }\n }\n}\n</code></pre>"},{"location":"getting-started/#step-6-reload-mcp-servers-in-cursor","title":"Step 6: Reload MCP Servers in Cursor","text":"<ol> <li>Press <code>Cmd+Shift+P</code> (macOS) or <code>Ctrl+Shift+P</code> (Windows/Linux)</li> <li>Type: \"Reload MCP Servers\"</li> <li>Select it</li> </ol>"},{"location":"getting-started/#step-7-test-the-connection","title":"Step 7: Test the Connection","text":"<p>In Cursor chat, ask:</p> <pre><code>List all Keycloak realms\n</code></pre> <p>Expected result: You should see a list of all realms from your Keycloak instance.</p>"},{"location":"getting-started/#option-2-openshift-deployment","title":"Option 2: OpenShift Deployment","text":""},{"location":"getting-started/#step-1-prerequisites","title":"Step 1: Prerequisites","text":"<ul> <li>OpenShift cluster access (v4.x or later)</li> <li><code>oc</code> CLI installed and configured</li> <li>Keycloak instance deployed in OpenShift with HTTPS enabled</li> </ul> <p>./setup-service-account.sh \\  --keycloak-url https://keycloak.apps.example.com \\  --admin-user admin \\  --admin-password your-admin-password \\  --client-id mcp-server \\  --realm master <pre><code>Or follow the manual steps in [authentication.md](authentication.md).\n\n### Step 3: Deploy MCP Server\n\n1. **Create a new project (or use existing):**\n\n```bash\noc new-project keycloak-mcp-server\n# Or use existing project\n# oc project your-project\n</code></pre></p> <ol> <li>Create ConfigMap:</li> </ol> <pre><code>oc create configmap keycloak-mcp-config \\\n --from-literal=keycloak-url=https://keycloak.apps.example.com \\\n --from-literal=keycloak-realm=master \\\n --from-literal=client-id=mcp-server\n</code></pre> <ol> <li>Create Secret with Client Credentials:</li> </ol> <pre><code># Replace with your actual client secret from Step 2\noc create secret generic keycloak-mcp-secret \\\n --from-literal=client-secret=your-client-secret-from-keycloak\n</code></pre> <ol> <li>Extract Keycloak CA Certificate (if using self-signed certs):</li> </ol> <pre><code># Find the TLS secret name\nKC_TLS_SECRET=$(oc get keycloak -o jsonpath='{.items[0].spec.http.tlsSecret}' -n keycloak)\n\n# Extract and create CA bundle\noc get secret $KC_TLS_SECRET -n keycloak -o jsonpath='{.data.tls\\.crt}' | \\\n base64 -d &gt; /tmp/keycloak-ca.crt\n\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=/tmp/keycloak-ca.crt\n\nrm /tmp/keycloak-ca.crt\n</code></pre> <ol> <li>Deploy the MCP Server:</li> </ol> <pre><code># Clone the repository\ngit clone https://github.com/sshaaf/keycloak-mcp-server.git\ncd keycloak-mcp-server\n\n# Apply deployment manifests\noc apply -f deploy/openshift/deployment.yaml\noc apply -f deploy/openshift/service.yaml\noc apply -f deploy/openshift/route.yaml\n</code></pre> <p>Or use the automated deployment script:</p> <pre><code>cd keycloak-mcp-server/deploy/openshift\nchmod +x deploy.sh\n./deploy.sh\n</code></pre>"},{"location":"getting-started/#step-4-get-the-route-url","title":"Step 4: Get the Route URL","text":"<pre><code>oc get route keycloak-mcp-server -o jsonpath='{.spec.host}'\n# Example output: keycloak-mcp-server-your-project.apps.example.com\n</code></pre>"},{"location":"getting-started/#step-5-verify-deployment","title":"Step 5: Verify Deployment","text":"<pre><code># Check pod status\noc get pods -l app=keycloak-mcp-server\n\n# Check logs\noc logs -f deployment/keycloak-mcp-server\n\n# Test health endpoint\nROUTE_URL=$(oc get route keycloak-mcp-server -o jsonpath='{.spec.host}')\ncurl https://$ROUTE_URL/q/health\n</code></pre>"},{"location":"getting-started/#step-6-configure-cursor-mcp","title":"Step 6: Configure Cursor MCP","text":"<p>Edit <code>~/.cursor/mcp.json</code>:</p> <pre><code>{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"https://keycloak-mcp-server-your-project.apps.example.com/mcp/sse\"\n }\n }\n}\n</code></pre> <p>Replace <code>keycloak-mcp-server-your-project.apps.example.com</code> with your actual route URL from Step 4.</p>"},{"location":"getting-started/#step-7-reload-mcp-servers-in-cursor","title":"Step 7: Reload MCP Servers in Cursor","text":"<ol> <li>Press <code>Cmd+Shift+P</code> (macOS) or <code>Ctrl+Shift+P</code> (Windows/Linux)</li> <li>Type: \"Reload MCP Servers\"</li> <li>Select it</li> </ol>"},{"location":"getting-started/#step-8-test-the-connection","title":"Step 8: Test the Connection","text":"<p>In Cursor chat, ask:</p> <pre><code>List all users from the master realm\n</code></pre> <p>Expected result: You should see a list of users from your Keycloak master realm.</p>"},{"location":"getting-started/#option-3-native-binary","title":"Option 3: Native Binary","text":""},{"location":"getting-started/#step-1-download-the-native-binary","title":"Step 1: Download the Native Binary","text":"<p>Download the latest native binary for your platform from the releases page:</p> <p>Linux (x64): <pre><code>wget https://github.com/sshaaf/keycloak-mcp-server/releases/download/v0.3.0/keycloak-mcp-server-linux-x64\nchmod +x keycloak-mcp-server-linux-x64\n</code></pre></p> <p>macOS (x64): <pre><code>wget https://github.com/sshaaf/keycloak-mcp-server/releases/download/v0.3.0/keycloak-mcp-server-darwin-x64\nchmod +x keycloak-mcp-server-darwin-x64\n</code></pre></p> <p>macOS (ARM64): <pre><code>wget https://github.com/sshaaf/keycloak-mcp-server/releases/download/v0.3.0/keycloak-mcp-server-darwin-arm64\nchmod +x keycloak-mcp-server-darwin-arm64\n</code></pre></p> <p>Or build from source:</p> <pre><code>git clone https://github.com/sshaaf/keycloak-mcp-server.git\ncd keycloak-mcp-server\nmvn clean package -Dnative -DskipTests\n</code></pre>"},{"location":"getting-started/#step-2-set-up-keycloak-service-account","title":"Step 2: Set Up Keycloak Service Account","text":"<p>Follow the steps in authentication.md to create a OIDC client in Keycloak.</p>"},{"location":"getting-started/#step-3-create-environment-configuration","title":"Step 3: Create Environment Configuration","text":"<p>Create a <code>.env</code> file:</p> <pre><code>cat &gt; keycloak-mcp.env &lt;&lt; EOF\nKC_URL=https://keycloak.example.com\nKC_REALM=master\nOIDC_CLIENT_ID=mcp-server\nQUARKUS_HTTP_PORT=8080\nEOF\n</code></pre>"},{"location":"getting-started/#step-4-run-the-native-binary","title":"Step 4: Run the Native Binary","text":"<pre><code># Load environment variables\nexport $(cat keycloak-mcp.env | xargs)\n\n# Run the native binary\n./keycloak-mcp-server-linux-x64\n# Or for macOS: ./keycloak-mcp-server-darwin-arm64\n</code></pre> <p>Run as Background Service (Linux/macOS):</p> <pre><code># Create systemd service (Linux)\nsudo tee /etc/systemd/system/keycloak-mcp-server.service &gt; /dev/null &lt;&lt;EOF\n[Unit]\nDescription=Keycloak MCP Server\nAfter=network.target\n\n[Service]\nType=simple\nUser=mcp-server\nEnvironmentFile=/opt/keycloak-mcp/keycloak-mcp.env\nExecStart=/opt/keycloak-mcp/keycloak-mcp-server-linux-x64\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo systemctl daemon-reload\nsudo systemctl enable keycloak-mcp-server\nsudo systemctl start keycloak-mcp-server\n</code></pre>"},{"location":"getting-started/#step-5-verify-the-service-is-running","title":"Step 5: Verify the Service is Running","text":"<pre><code># Check if port is listening\nlsof -i :8080\n# Or: netstat -tuln | grep 8080\n\n# Test health endpoint\ncurl http://localhost:8080/q/health\n</code></pre>"},{"location":"getting-started/#step-6-configure-cursor-mcp_1","title":"Step 6: Configure Cursor MCP","text":"<p>Edit <code>~/.cursor/mcp.json</code>:</p> <pre><code>{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\"\n }\n }\n}\n</code></pre>"},{"location":"getting-started/#step-7-reload-mcp-servers-in-cursor_1","title":"Step 7: Reload MCP Servers in Cursor","text":"<ol> <li>Press <code>Cmd+Shift+P</code> (macOS) or <code>Ctrl+Shift+P</code> (Windows/Linux)</li> <li>Type: \"Reload MCP Servers\"</li> <li>Select it</li> </ol>"},{"location":"getting-started/#step-8-test-the-connection_1","title":"Step 8: Test the Connection","text":"<p>In Cursor chat, ask:</p> <pre><code>List all authentication flows from the master realm\n</code></pre> <p>Expected result: You should see a list of authentication flows from your Keycloak master realm.</p>"},{"location":"getting-started/#option-4-development-mode-usernamepassword","title":"Option 4: Development Mode (Username/Password)","text":"<p>Warning: This method is for development only. Use user authentication authentication for production.</p>"},{"location":"getting-started/#step-1-clone-and-build-the-project","title":"Step 1: Clone and Build the Project","text":"<pre><code>git clone https://github.com/sshaaf/keycloak-mcp-server.git\ncd keycloak-mcp-server\n</code></pre>"},{"location":"getting-started/#step-2-configure-application-properties","title":"Step 2: Configure Application Properties","text":"<p>Edit <code>src/main/resources/application.properties</code>:</p> <pre><code># Keycloak Connection (Development Mode)\nquarkus.keycloak.admin-client.server-url=http://localhost:8180\nquarkus.keycloak.admin-client.username=admin\nquarkus.keycloak.admin-client.password=admin\n\n# Dev services disabled (using external Keycloak)\nquarkus.keycloak.devservices.enabled=false\n\n# HTTP Configuration\nquarkus.http.port=8080\nquarkus.http.host=0.0.0.0\n</code></pre> <p>Or use environment variables:</p> <pre><code>export KC_URL=http://localhost:8180\nexport KC_REALM=master\nexport OIDC_CLIENT_ID=mcp-server\n</code></pre> <p>Note: Development mode disables authentication for convenience. No credentials are required.</p>"},{"location":"getting-started/#step-3-run-in-development-mode","title":"Step 3: Run in Development Mode","text":"<pre><code>mvn quarkus:dev\n</code></pre> <p>The server will start on <code>http://localhost:8080</code> with hot-reload enabled.</p> <p>Features in Dev Mode: - Hot reload (code changes apply automatically) - Dev UI available at <code>http://localhost:8080/q/dev</code> - Detailed error messages - Continuous testing mode</p>"},{"location":"getting-started/#step-4-verify-the-server-is-running","title":"Step 4: Verify the Server is Running","text":"<pre><code># Test health endpoint\ncurl http://localhost:8080/q/health\n\n# Access Dev UI\nopen http://localhost:8080/q/dev\n</code></pre>"},{"location":"getting-started/#step-5-configure-cursor-mcp_1","title":"Step 5: Configure Cursor MCP","text":"<p>Edit <code>~/.cursor/mcp.json</code>:</p> <pre><code>{\n \"mcpServers\": {\n \"keycloak-dev\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\"\n }\n }\n}\n</code></pre>"},{"location":"getting-started/#step-6-reload-mcp-servers-in-cursor_1","title":"Step 6: Reload MCP Servers in Cursor","text":"<ol> <li>Press <code>Cmd+Shift+P</code> (macOS) or <code>Ctrl+Shift+P</code> (Windows/Linux)</li> <li>Type: \"Reload MCP Servers\"</li> <li>Select it</li> </ol>"},{"location":"getting-started/#step-7-test-the-connection_1","title":"Step 7: Test the Connection","text":"<p>In Cursor chat, ask:</p> <pre><code>Count all users in Keycloak\n</code></pre> <p>Expected result: You should see the total count of users across all realms.</p>"},{"location":"getting-started/#step-8-making-changes-optional","title":"Step 8: Making Changes (Optional)","text":"<p>Since you are in development mode, you can make code changes:</p> <ol> <li>Edit any Java file in <code>src/main/java/</code></li> <li>Save the file</li> <li>Quarkus will automatically reload</li> <li>Reload MCP servers in Cursor to see changes</li> </ol>"},{"location":"getting-started/#configuring-cursor-ide","title":"Configuring Cursor IDE","text":""},{"location":"getting-started/#mcp-configuration-file-location","title":"MCP Configuration File Location","text":"<p>macOS/Linux: <pre><code>~/.cursor/mcp.json\n</code></pre></p> <p>Windows: <pre><code>%USERPROFILE%\\.cursor\\mcp.json\n</code></pre></p>"},{"location":"getting-started/#configuration-examples","title":"Configuration Examples","text":""},{"location":"getting-started/#single-mcp-server","title":"Single MCP Server","text":"<pre><code>{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\"\n }\n }\n}\n</code></pre>"},{"location":"getting-started/#multiple-mcp-servers","title":"Multiple MCP Servers","text":"<pre><code>{\n \"mcpServers\": {\n \"keycloak-prod\": {\n \"transport\": \"sse\",\n \"url\": \"https://keycloak-mcp-server.apps.example.com/mcp/sse\"\n },\n \"keycloak-dev\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\"\n }\n }\n}\n</code></pre>"},{"location":"getting-started/#with-additional-mcp-servers","title":"With Additional MCP Servers","text":"<pre><code>{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\"\n },\n \"context7\": {\n \"url\": \"https://mcp.context7.com/mcp\",\n \"headers\": {}\n }\n }\n}\n</code></pre>"},{"location":"getting-started/#reloading-mcp-configuration","title":"Reloading MCP Configuration","text":"<p>After editing <code>mcp.json</code>:</p> <ol> <li>Command Palette Method:</li> <li>Press <code>Cmd+Shift+P</code> (macOS) or <code>Ctrl+Shift+P</code> (Windows/Linux)</li> <li>Type: \"Reload MCP Servers\"</li> <li> <p>Press Enter</p> </li> <li> <p>Restart Cursor:</p> </li> <li>Close and reopen Cursor</li> </ol>"},{"location":"getting-started/#testing-your-setup","title":"Testing Your Setup","text":""},{"location":"getting-started/#quick-test-commands","title":"Quick Test Commands","text":"<p>Try these commands in Cursor chat to verify everything is working:</p>"},{"location":"getting-started/#test-1-list-realms","title":"Test 1: List Realms","text":"<pre><code>List all Keycloak realms\n</code></pre> <p>Expected Output: <pre><code>Found 3 realms:\n1. master - Red Hat build of Keycloak (Enabled)\n2. quarkus (Enabled)\n3. test (Enabled)\n</code></pre></p>"},{"location":"getting-started/#test-2-count-users","title":"Test 2: Count Users","text":"<pre><code>How many users are in the master realm?\n</code></pre> <p>Expected Output: <pre><code>There are X users in the master realm.\n</code></pre></p>"},{"location":"getting-started/#test-3-list-clients","title":"Test 3: List Clients","text":"<pre><code>Show me all clients in the master realm\n</code></pre> <p>Expected Output: <pre><code>Found X clients:\n- account\n- admin-cli\n- broker\n- master-realm\n- mcp-server\n- ...\n</code></pre></p>"},{"location":"getting-started/#test-4-search-discourse","title":"Test 4: Search Discourse","text":"<pre><code>Search Keycloak Discourse for \"LDAP integration\"\n</code></pre> <p>Expected Output: <pre><code>Found X topics related to \"LDAP integration\":\n1. [Topic Title] - https://keycloak.discourse.group/...\n2. ...\n</code></pre></p>"},{"location":"getting-started/#health-check-endpoints","title":"Health Check Endpoints","text":"<p>Test the MCP server directly:</p> <pre><code># Health check\ncurl http://localhost:8080/q/health\n\n# Liveness probe\ncurl http://localhost:8080/q/health/live\n\n# Readiness probe\ncurl http://localhost:8080/q/health/ready\n\n# MCP SSE endpoint\ncurl -N http://localhost:8080/mcp/sse\n</code></pre>"},{"location":"getting-started/#available-operations","title":"Available Operations","text":"<p>The Keycloak MCP Server supports the following operations:</p>"},{"location":"getting-started/#user-operations","title":"User Operations","text":"<ul> <li><code>GET_USERS</code> - List all users</li> <li><code>GET_USER_BY_USERNAME</code> - Get user by username</li> <li><code>GET_USER_BY_ID</code> - Get user by ID</li> <li><code>CREATE_USER</code> - Create a new user</li> <li><code>DELETE_USER</code> - Delete a user</li> <li><code>UPDATE_USER</code> - Update user details</li> <li><code>GET_USER_GROUPS</code> - Get user's groups</li> <li><code>GET_USER_ROLES</code> - Get user's roles</li> <li><code>ADD_USER_TO_GROUP</code> - Add user to group</li> <li><code>REMOVE_USER_FROM_GROUP</code> - Remove user from group</li> <li><code>ADD_ROLE_TO_USER</code> - Assign role to user</li> <li><code>REMOVE_ROLE_FROM_USER</code> - Remove role from user</li> <li><code>RESET_PASSWORD</code> - Reset user password</li> <li><code>SEND_VERIFICATION_EMAIL</code> - Send verification email</li> <li><code>COUNT_USERS</code> - Count users in realm</li> </ul>"},{"location":"getting-started/#realm-operations","title":"Realm Operations","text":"<ul> <li><code>GET_REALMS</code> - List all realms</li> <li><code>GET_REALM</code> - Get realm details</li> <li><code>CREATE_REALM</code> - Create a new realm</li> </ul>"},{"location":"getting-started/#client-operations","title":"Client Operations","text":"<ul> <li><code>GET_CLIENTS</code> - List all clients</li> <li><code>GET_CLIENT</code> - Get client details</li> <li><code>CREATE_CLIENT</code> - Create a new client</li> <li><code>DELETE_CLIENT</code> - Delete a client</li> <li><code>GENERATE_CLIENT_SECRET</code> - Generate new client secret</li> <li><code>GET_CLIENT_ROLES</code> - Get client roles</li> <li><code>CREATE_CLIENT_ROLE</code> - Create client role</li> <li><code>DELETE_CLIENT_ROLE</code> - Delete client role</li> </ul>"},{"location":"getting-started/#role-operations","title":"Role Operations","text":"<ul> <li><code>GET_REALM_ROLES</code> - List realm roles</li> <li><code>GET_REALM_ROLE</code> - Get realm role details</li> </ul>"},{"location":"getting-started/#group-operations","title":"Group Operations","text":"<ul> <li><code>GET_GROUPS</code> - List all groups</li> <li><code>GET_GROUP_MEMBERS</code> - Get group members</li> <li><code>CREATE_GROUP</code> - Create a group</li> <li><code>UPDATE_GROUP</code> - Update group details</li> <li><code>DELETE_GROUP</code> - Delete a group</li> <li><code>CREATE_SUBGROUP</code> - Create a subgroup</li> </ul>"},{"location":"getting-started/#identity-provider-operations","title":"Identity Provider Operations","text":"<ul> <li><code>GET_IDENTITY_PROVIDERS</code> - List identity providers</li> <li><code>GET_IDENTITY_PROVIDER</code> - Get identity provider details</li> <li><code>GET_IDENTITY_PROVIDER_MAPPERS</code> - Get identity provider mappers</li> </ul>"},{"location":"getting-started/#authentication-flow-operations","title":"Authentication Flow Operations","text":"<ul> <li><code>GET_AUTHENTICATION_FLOWS</code> - List authentication flows</li> <li><code>GET_AUTHENTICATION_FLOW</code> - Get flow details</li> <li><code>CREATE_AUTHENTICATION_FLOW</code> - Create a flow</li> <li><code>DELETE_AUTHENTICATION_FLOW</code> - Delete a flow</li> <li><code>GET_FLOW_EXECUTIONS</code> - Get flow executions</li> <li><code>UPDATE_FLOW_EXECUTION</code> - Update flow execution</li> </ul>"},{"location":"getting-started/#discourse-operations","title":"Discourse Operations","text":"<ul> <li><code>SEARCH_DISCOURSE</code> - Search Keycloak community forum</li> </ul>"},{"location":"getting-started/#example-usage-in-cursor-chat","title":"Example Usage in Cursor Chat","text":"<pre><code># User management\n\"Create a user named john.doe with email john@example.com in the master realm\"\n\"List all users in the quarkus realm\"\n\"Add user alice to the admin group\"\n\n# Client management\n\"Show me all clients in the master realm\"\n\"Create a new confidential client named my-app\"\n\"Generate a new secret for the my-app client\"\n\n# Realm management\n\"List all realms\"\n\"Show me the details of the quarkus realm\"\n\"Create a new realm named production\"\n\n# Authentication flows\n\"List all authentication flows in the master realm\"\n\"Show me the browser authentication flow\"\n\n# Discourse search\n\"Search Keycloak Discourse for 'SAML configuration'\"\n\"Find topics about user federation\"\n</code></pre>"},{"location":"getting-started/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/#issue-mcp-server-not-connecting","title":"Issue: MCP Server Not Connecting","text":"<p>Symptoms: - Cursor shows \"MCP server not responding\" - Tools not available in chat</p> <p>Solutions:</p> <ol> <li> <p>Check if the server is running: <pre><code># For Docker\ndocker ps | grep keycloak-mcp-server\ndocker logs keycloak-mcp-server\n\n# For OpenShift\noc get pods -l app=keycloak-mcp-server\noc logs -f deployment/keycloak-mcp-server\n\n# For native binary\nps aux | grep keycloak-mcp-server\n</code></pre></p> </li> <li> <p>Test the health endpoint: <pre><code>curl http://localhost:8080/q/health\n</code></pre></p> </li> <li> <p>Check the MCP SSE endpoint: <pre><code>curl -N http://localhost:8080/mcp/sse\n</code></pre></p> </li> <li> <p>Verify mcp.json configuration:</p> </li> <li>Check the URL is correct</li> <li>Ensure no trailing slashes</li> <li> <p>Verify the port number</p> </li> <li> <p>Reload MCP servers in Cursor:</p> </li> <li><code>Cmd+Shift+P</code> \u2192 \"Reload MCP Servers\"</li> </ol>"},{"location":"getting-started/#issue-ssltls-certificate-errors","title":"Issue: SSL/TLS Certificate Errors","text":"<p>Symptoms: - <code>SSLHandshakeException: Failed to create SSL connection</code> - Certificate validation errors in logs</p> <p>Solutions:</p> <ol> <li> <p>For Docker (Development): <pre><code>docker run -d \\\n-e QUARKUS_TLS_TRUST_ALL=true \\\n-e QUARKUS_REST_CLIENT_TRUST_ALL=true \\\n...\n</code></pre></p> </li> <li> <p>For OpenShift (Production):</p> </li> <li>Ensure CA certificate ConfigMap is created</li> <li>Verify volume mount in deployment</li> <li> <p>See keycloak-tls-setup.md</p> </li> <li> <p>For Native Binary: <pre><code>export QUARKUS_TLS_TRUST_ALL=true\n./keycloak-mcp-server-linux-x64\n</code></pre></p> </li> </ol>"},{"location":"getting-started/#issue-authentication-failures","title":"Issue: Authentication Failures","text":"<p>Symptoms: - <code>401 Unauthorized</code> errors - <code>403 Forbidden</code> errors - \"Invalid credentials\" in logs</p> <p>Solutions:</p> <ol> <li> <p>Verify Keycloak URL: <pre><code>curl -I https://keycloak.example.com\n</code></pre></p> </li> <li> <p>For JWT Authentication:</p> </li> <li>Verify OIDC client exists in Keycloak (mcp-server)</li> <li>Ensure user has proper roles and permissions</li> <li> <p>Test user token:  <pre><code>curl -X POST https://keycloak.example.com/realms/master/protocol/openid-connect/token \\\n-d 'grant_type=password' \\\n-d 'client_id=admin-cli' \\\n-d 'username=your-username' \\\n-d 'client_secret=your-secret'\n</code></pre></p> </li> <li> <p>For Username/Password:</p> </li> <li>Verify admin username and password</li> <li>Check user has admin privileges</li> <li>Test login:  <pre><code>curl -X POST https://keycloak.example.com/realms/master/protocol/openid-connect/token \\\n-d 'grant_type=password' \\\n-d 'client_id=admin-cli' \\\n-d 'username=admin' \\\n-d 'password=admin'\n</code></pre></li> </ol>"},{"location":"getting-started/#issue-connection-refused-network-errors","title":"Issue: Connection Refused / Network Errors","text":"<p>Symptoms: - <code>Connection refused</code> errors - <code>No route to host</code> errors</p> <p>Solutions:</p> <ol> <li> <p>Check Keycloak is running: <pre><code>curl http://localhost:8180\n# Or for HTTPS\ncurl -k https://localhost:8543\n</code></pre></p> </li> <li> <p>For Docker on macOS/Windows:</p> </li> <li> <p>Use <code>host.docker.internal</code> instead of <code>localhost</code></p> </li> <li> <p>For Docker on Linux:</p> </li> <li> <p>Use <code>--network host</code> or configure bridge networking</p> </li> <li> <p>Check firewall rules: <pre><code># Linux\nsudo firewall-cmd --list-all\n\n# macOS\nsudo pfctl -sr\n</code></pre></p> </li> <li> <p>Verify port is not in use: <pre><code>lsof -i :8080\n</code></pre></p> </li> </ol>"},{"location":"getting-started/#issue-mcp-tools-not-appearing-in-cursor","title":"Issue: MCP Tools Not Appearing in Cursor","text":"<p>Symptoms: - No Keycloak operations available - Can't execute Keycloak commands</p> <p>Solutions:</p> <ol> <li>Verify MCP server is initialized:</li> <li>Look for initialization message in server logs</li> <li> <p>Check Cursor's developer console (Help \u2192 Toggle Developer Tools)</p> </li> <li> <p>Reload MCP servers:</p> </li> <li> <p><code>Cmd+Shift+P</code> \u2192 \"Reload MCP Servers\"</p> </li> <li> <p>Restart Cursor completely</p> </li> <li> <p>Check mcp.json syntax: <pre><code># Validate JSON\ncat ~/.cursor/mcp.json | python -m json.tool\n</code></pre></p> </li> </ol>"},{"location":"getting-started/#issue-slow-response-times","title":"Issue: Slow Response Times","text":"<p>Symptoms: - Operations take a long time - Timeouts in Cursor</p> <p>Solutions:</p> <ol> <li>Check Keycloak performance:</li> <li>Database connections</li> <li>Memory usage</li> <li> <p>Network latency</p> </li> <li> <p>Increase container resources: <pre><code># Docker\ndocker update --memory 1g --cpus 2 keycloak-mcp-server\n</code></pre></p> </li> <li> <p>For OpenShift, adjust resource limits: <pre><code>resources:\nrequests:\nmemory: \"512Mi\"\ncpu: \"250m\"\nlimits:\nmemory: \"1Gi\"\ncpu: \"1000m\"\n</code></pre></p> </li> </ol>"},{"location":"getting-started/#getting-help","title":"Getting Help","text":"<p>If you are still experiencing issues:</p> <ol> <li> <p>Check the logs: <pre><code># Docker\ndocker logs keycloak-mcp-server --tail 100\n\n# OpenShift\noc logs deployment/keycloak-mcp-server --tail 100\n\n# Development mode\n# Logs appear in terminal\n</code></pre></p> </li> <li> <p>Enable debug logging: <pre><code># Add to environment\nexport QUARKUS_LOG_LEVEL=DEBUG\n</code></pre></p> </li> <li> <p>Check documentation:</p> </li> <li>index.md</li> <li>authentication.md</li> <li>openshift-deployment.md</li> <li> <p>keycloak-tls-setup.md</p> </li> <li> <p>Open an issue:</p> </li> <li>GitHub Issues</li> <li> <p>Include logs, configuration, and error messages</p> </li> <li> <p>Community support:</p> </li> <li>Keycloak Discourse</li> <li>Quarkus Discord</li> </ol>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<p>Once you have the MCP server running:</p> <ol> <li>Explore Available Operations: Try different Keycloak management commands</li> <li>Automate Tasks: Use the MCP server to automate user provisioning, client setup, etc.</li> <li>Secure Your Setup: Migrate to user authentication authentication if using username/password</li> <li>Monitor Performance: Set up logging and monitoring</li> <li>Deploy to Production: Follow the OpenShift deployment guide for production setup</li> </ol>"},{"location":"getting-started/#additional-resources","title":"Additional Resources","text":"<ul> <li>Documentation: index.md</li> <li>Authentication Guide: authentication.md</li> <li>OpenShift Deployment: openshift-deployment.md</li> <li>TLS Configuration: keycloak-tls-setup.md</li> <li>GitHub Repository: https://github.com/sshaaf/keycloak-mcp-server</li> <li>Keycloak Documentation: https://www.keycloak.org/documentation</li> </ul> <p>**Happy Keycloak management with MCP! **</p>"},{"location":"git-commit-tagging/","title":"Git Commit SHA Tagging for Container Images","text":""},{"location":"git-commit-tagging/#overview","title":"Overview","text":"<p>The Keycloak MCP Server now automatically tags container images with the git commit SHA for perfect traceability and reproducibility.</p>"},{"location":"git-commit-tagging/#how-it-works","title":"How It Works","text":""},{"location":"git-commit-tagging/#1-git-commit-id-plugin","title":"1. Git Commit ID Plugin","text":"<p>The <code>git-commit-id-maven-plugin</code> captures git information during the Maven <code>initialize</code> phase:</p> <pre><code>&lt;plugin&gt;\n &lt;groupId&gt;io.github.git-commit-id&lt;/groupId&gt;\n &lt;artifactId&gt;git-commit-id-maven-plugin&lt;/artifactId&gt;\n &lt;version&gt;7.0.0&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre>"},{"location":"git-commit-tagging/#2-maven-resource-filtering","title":"2. Maven Resource Filtering","text":"<p>Maven resource filtering is enabled to substitute git properties in <code>application.properties</code>:</p> <pre><code>&lt;resources&gt;\n &lt;resource&gt;\n &lt;directory&gt;src/main/resources&lt;/directory&gt;\n &lt;filtering&gt;true&lt;/filtering&gt;\n &lt;/resource&gt;\n&lt;/resources&gt;\n</code></pre>"},{"location":"git-commit-tagging/#3-image-tag-configuration","title":"3. Image Tag Configuration","text":"<p>The container image tag uses the git commit SHA (abbreviated):</p> <pre><code># Primary tag: Always git commit SHA\nquarkus.container-image.tag=@git.commit.id.abbrev@\n\n# Additional tags: Latest only (versions are manually tagged)\nquarkus.container-image.additional-tags=latest\n</code></pre>"},{"location":"git-commit-tagging/#result","title":"Result","text":"<p>When you build a container image, it will be automatically tagged with:</p> <ol> <li>Git Commit SHA (primary tag): <code>49ff54e</code> - unique identifier for every build</li> <li>Latest: <code>latest</code> - always points to the most recent build</li> </ol>"},{"location":"git-commit-tagging/#example-image-names","title":"Example Image Names","text":"<pre><code>quay.io/sshaaf/keycloak-mcp-server:49ff54e # Git commit SHA (primary)\nquay.io/sshaaf/keycloak-mcp-server:latest # Latest build\n</code></pre>"},{"location":"git-commit-tagging/#manual-version-tagging","title":"Manual Version Tagging","text":"<p>Semantic versions (like <code>0.3.0</code>, <code>1.0.0</code>, etc.) are not automatically created. You manually tag specific commits when you are ready to release:</p> <pre><code># Build and tag a release version manually\ndocker tag quay.io/sshaaf/keycloak-mcp-server:49ff54e \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# Push both tags\ndocker push quay.io/sshaaf/keycloak-mcp-server:49ff54e\ndocker push quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre> <p>Or use Maven properties for releases:</p> <pre><code># Build with additional version tag for releases\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.additional-tags=0.3.0,latest\n</code></pre>"},{"location":"git-commit-tagging/#benefits","title":"Benefits","text":""},{"location":"git-commit-tagging/#1-perfect-traceability","title":"1. Perfect Traceability","text":"<p>Every container image can be traced back to the exact git commit that built it.</p> <pre><code># Pull a specific commit\ndocker pull quay.io/sshaaf/keycloak-mcp-server:49ff54e\n\n# Check what was in that commit\ngit show 49ff54e\n</code></pre>"},{"location":"git-commit-tagging/#2-reproducible-builds","title":"2. Reproducible Builds","text":"<p>Same commit = same tag = guaranteed identical code.</p>"},{"location":"git-commit-tagging/#3-easy-debugging","title":"3. Easy Debugging","text":"<p>When an issue occurs in production, you know exactly which commit to investigate:</p> <pre><code># See what is running in production\ndocker inspect quay.io/sshaaf/keycloak-mcp-server:49ff54e\n\n# Check that commit\ngit checkout 49ff54e\n</code></pre>"},{"location":"git-commit-tagging/#4-cicd-friendly","title":"4. CI/CD Friendly","text":"<p>No automatic tag management - each commit gets its unique SHA tag automatically.</p>"},{"location":"git-commit-tagging/#5-manual-release-control","title":"5. Manual Release Control","text":"<p>You decide when a commit is \"release-worthy\" and manually tag semantic versions (0.3.0, 1.0.0, etc.).</p>"},{"location":"git-commit-tagging/#building-container-images","title":"Building Container Images","text":""},{"location":"git-commit-tagging/#local-build","title":"Local Build","text":"<pre><code># Build with git commit SHA tag\n./mvnw package -Dquarkus.container-image.build=true\n\n# Result: Image tagged with your current commit SHA + 0.3.0 + latest\n</code></pre>"},{"location":"git-commit-tagging/#cicd-build","title":"CI/CD Build","text":"<pre><code># In CI/CD pipeline\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.username=$QUAY_USERNAME \\\n -Dquarkus.container-image.password=$QUAY_PASSWORD\n\n# Automatically uses the commit SHA from the git repository\n</code></pre>"},{"location":"git-commit-tagging/#git-properties-available","title":"Git Properties Available","text":"<p>The plugin captures these properties:</p> Property Description Example <code>git.commit.id.abbrev</code> Short commit SHA (7 chars) <code>49ff54e</code> <code>git.commit.id.full</code> Full commit SHA <code>49ff54e674e72d32832c555393a41f6eaef13bc2</code> <code>git.commit.id.describe</code> Git describe output <code>49ff54e-dirty</code> <code>git.branch</code> Current branch name <code>enhancements-v0.3</code> <p>All properties are available in <code>target/classes/git.properties</code>.</p>"},{"location":"git-commit-tagging/#viewing-git-info-at-runtime","title":"Viewing Git Info at Runtime","text":"<p>The git.properties file is included in the JAR:</p> <pre><code># Extract and view git info from running container\ndocker exec keycloak-mcp cat /deployments/git.properties\n\n# Output:\n# git.branch=enhancements-v0.3\n# git.commit.id.abbrev=49ff54e\n# git.commit.id.full=49ff54e674e72d32832c555393a41f6eaef13bc2\n</code></pre>"},{"location":"git-commit-tagging/#using-specific-tags","title":"Using Specific Tags","text":""},{"location":"git-commit-tagging/#pull-by-commit-sha-recommended-for-production","title":"Pull by Commit SHA (Recommended for Production)","text":"<pre><code># Always get the exact version you tested\ndocker pull quay.io/sshaaf/keycloak-mcp-server:49ff54e\n</code></pre>"},{"location":"git-commit-tagging/#pull-by-semantic-version-for-releases","title":"Pull by Semantic Version (For Releases)","text":"<pre><code># Get a specific release version (manually tagged)\ndocker pull quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre> <p>Note: Semantic version tags like <code>0.3.0</code> are not automatically created. You must manually tag commits when you decide they're ready for release.</p>"},{"location":"git-commit-tagging/#pull-latest-development-only","title":"Pull Latest (Development Only)","text":"<pre><code># Get the most recent build (not recommended for production)\ndocker pull quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"git-commit-tagging/#best-practices","title":"Best Practices","text":""},{"location":"git-commit-tagging/#1-production-deployments","title":"1. Production Deployments","text":"<p>Always use commit SHA tags in production:</p> <pre><code># kubernetes/deployment.yaml\nspec:\n containers:\n - name: keycloak-mcp\n image: quay.io/sshaaf/keycloak-mcp-server:49ff54e # Specific commit\n # NOT: latest or 0.3.0 (which can change)\n</code></pre>"},{"location":"git-commit-tagging/#2-development","title":"2. Development","text":"<p>Use <code>latest</code> for development environments:</p> <pre><code>docker run -d quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"git-commit-tagging/#3-staging","title":"3. Staging","text":"<p>Use version tags for staging:</p> <pre><code>docker run -d quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre>"},{"location":"git-commit-tagging/#4-rollbacks","title":"4. Rollbacks","text":"<p>Easy rollback to previous commits:</p> <pre><code># Current: 49ff54e (has issues)\n# Rollback to: a1b2c3d (previous working version)\n\nkubectl set image deployment/keycloak-mcp \\\n keycloak-mcp=quay.io/sshaaf/keycloak-mcp-server:a1b2c3d\n</code></pre>"},{"location":"git-commit-tagging/#dirty-state-warning","title":"Dirty State Warning","text":"<p>If you have uncommitted changes, the plugin adds <code>-dirty</code> suffix:</p> <pre><code>git.commit.id.describe=49ff54e-dirty\n</code></pre> <p>Recommendation: Always commit changes before building production images.</p>"},{"location":"git-commit-tagging/#creating-release-versions","title":"Creating Release Versions","text":"<p>When you are ready to tag a commit as an official release, you have several options:</p>"},{"location":"git-commit-tagging/#option-1-manual-docker-tag-recommended","title":"Option 1: Manual Docker Tag (Recommended)","text":"<pre><code># Build the image with git SHA\n./mvnw package -Dquarkus.container-image.build=true\n\n# Tag it with a semantic version\ndocker tag quay.io/sshaaf/keycloak-mcp-server:49ff54e \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# Push both tags\ndocker push quay.io/sshaaf/keycloak-mcp-server:49ff54e\ndocker push quay.io/sshaaf/keycloak-mcp-server:0.3.0\ndocker push quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"git-commit-tagging/#option-2-override-at-build-time","title":"Option 2: Override at Build Time","text":"<pre><code># Add version tag for this specific build\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.additional-tags=0.3.0,latest\n\n# Creates: 49ff54e, 0.3.0, latest\n</code></pre>"},{"location":"git-commit-tagging/#option-3-git-tag-based-versioning","title":"Option 3: Git Tag-Based Versioning","text":"<p>Create a git tag first:</p> <pre><code># Tag the current commit\ngit tag -a v0.3.0 -m \"Release version 0.3.0\"\ngit push origin v0.3.0\n\n# Build with git describe\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.tag=$(git describe --tags --abbrev=0) \\\n -Dquarkus.container-image.additional-tags=latest\n\n# Creates: 0.3.0, latest\n</code></pre>"},{"location":"git-commit-tagging/#recommended-release-workflow","title":"Recommended Release Workflow","text":"<pre><code># 1. Ensure you are on a clean main/release branch\ngit checkout main\ngit pull origin main\n\n# 2. Build and test\n./mvnw clean package\n# Run tests, verify everything works...\n\n# 3. Build container with git SHA\n./mvnw package -Dquarkus.container-image.build=true\n\n# 4. Tag as release version\ndocker tag quay.io/sshaaf/keycloak-mcp-server:$(git rev-parse --short HEAD) \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# 5. Push all tags\ndocker push quay.io/sshaaf/keycloak-mcp-server:$(git rev-parse --short HEAD)\ndocker push quay.io/sshaaf/keycloak-mcp-server:0.3.0\ndocker push quay.io/sshaaf/keycloak-mcp-server:latest\n\n# 6. Tag in git for reference\ngit tag -a v0.3.0 -m \"Release version 0.3.0\"\ngit push origin v0.3.0\n</code></pre>"},{"location":"git-commit-tagging/#customizing-tags","title":"Customizing Tags","text":""},{"location":"git-commit-tagging/#use-full-commit-sha","title":"Use Full Commit SHA","text":"<p>Edit <code>application.properties</code>:</p> <pre><code># Use full SHA instead of abbreviated\nquarkus.container-image.tag=@git.commit.id.full@\n</code></pre>"},{"location":"git-commit-tagging/#add-branch-name","title":"Add Branch Name","text":"<pre><code># Include branch in tag\nquarkus.container-image.tag=@git.branch@-@git.commit.id.abbrev@\n# Result: enhancements-v0.3-49ff54e\n</code></pre>"},{"location":"git-commit-tagging/#add-custom-tags","title":"Add Custom Tags","text":"<pre><code># Add more tags\nquarkus.container-image.additional-tags=0.3.0,latest,stable,@git.branch@\n</code></pre>"},{"location":"git-commit-tagging/#troubleshooting","title":"Troubleshooting","text":""},{"location":"git-commit-tagging/#issue-tag-shows-gitcommitidabbrev","title":"Issue: Tag shows @git.commit.id.abbrev@","text":"<p>Cause: Maven resource filtering not working.</p> <p>Solution: Ensure <code>&lt;filtering&gt;true&lt;/filtering&gt;</code> is set in <code>pom.xml</code>:</p> <pre><code>&lt;build&gt;\n &lt;resources&gt;\n &lt;resource&gt;\n &lt;directory&gt;src/main/resources&lt;/directory&gt;\n &lt;filtering&gt;true&lt;/filtering&gt;\n &lt;/resource&gt;\n &lt;/resources&gt;\n&lt;/build&gt;\n</code></pre>"},{"location":"git-commit-tagging/#issue-build-fails-with-not-a-git-repository","title":"Issue: Build fails with \"Not a git repository\"","text":"<p>Cause: Building from a non-git source (e.g., downloaded zip).</p> <p>Solution: The plugin will skip if not in a git repo. Tags will fall back to configured defaults.</p>"},{"location":"git-commit-tagging/#issue-wrong-commit-sha","title":"Issue: Wrong commit SHA","text":"<p>Cause: Building from wrong branch or detached HEAD.</p> <p>Solution:</p> <pre><code># Check current commit\ngit log -1 --oneline\n\n# Ensure you are on the right branch\ngit checkout main\n\n# Rebuild\n./mvnw clean package\n</code></pre>"},{"location":"git-commit-tagging/#integration-with-cicd","title":"Integration with CI/CD","text":""},{"location":"git-commit-tagging/#github-actions","title":"GitHub Actions","text":"<pre><code>- name: Build and Push Container\n run: |\n ./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true\n env:\n QUAY_USERNAME: ${{ secrets.QUAY_USERNAME }}\n QUAY_PASSWORD: ${{ secrets.QUAY_PASSWORD }}\n\n# Image automatically tagged with ${{ github.sha }} (abbreviated)\n</code></pre>"},{"location":"git-commit-tagging/#gitlab-ci","title":"GitLab CI","text":"<pre><code>build-container:\n script:\n - ./mvnw package\n -Dquarkus.container-image.build=true\n -Dquarkus.container-image.push=true\n\n# Image automatically tagged with $CI_COMMIT_SHORT_SHA\n</code></pre>"},{"location":"git-commit-tagging/#summary","title":"Summary","text":"<p>Automatic SHA Tagging: Every build tagged with git commit SHA  Latest Tag: Always updated with most recent build  Manual Versioning: You control when commits become releases  Traceability: Every image traceable to exact source code  Reproducibility: Same commit = same image  CI/CD Ready: No manual SHA management needed  Production Safe: Use SHA tags for deployments</p> <p>Current Configuration: - Primary Tag: Git commit SHA (abbreviated, 7 characters) - automatic - Additional Tag: <code>latest</code> - automatic - Semantic Versions: <code>0.3.0</code>, <code>1.0.0</code>, etc. - manual only - Registry: <code>quay.io/sshaaf/keycloak-mcp-server</code></p> <p>Example Build: <pre><code># Your current commit: 49ff54e\n# Automatic images created:\nquay.io/sshaaf/keycloak-mcp-server:49ff54e # Primary (SHA)\nquay.io/sshaaf/keycloak-mcp-server:latest # Latest\n\n# Manual release tagging (when you are ready):\ndocker tag quay.io/sshaaf/keycloak-mcp-server:49ff54e \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\ndocker push quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre></p>"},{"location":"github-actions-setup/","title":"GitHub Actions Setup Guide","text":""},{"location":"github-actions-setup/#overview","title":"Overview","text":"<p>This project uses GitHub Actions to automatically build and push container images to Quay.io. This guide explains how to set up the required secrets and understand the workflows.</p>"},{"location":"github-actions-setup/#required-github-secrets","title":"Required GitHub Secrets","text":"<p>You need to configure two secrets in your GitHub repository for automatic container image pushing to Quay.io.</p>"},{"location":"github-actions-setup/#1-navigate-to-repository-settings","title":"1. Navigate to Repository Settings","text":"<ol> <li>Go to your GitHub repository</li> <li>Click Settings (top right)</li> <li>In the left sidebar, click Secrets and variables \u2192 Actions</li> <li>Click New repository secret</li> </ol>"},{"location":"github-actions-setup/#2-create-quay_username-secret","title":"2. Create QUAY_USERNAME Secret","text":"<ul> <li>Name: <code>QUAY_USERNAME</code></li> <li>Value: Your Quay.io username (e.g., <code>sshaaf</code>)</li> </ul>"},{"location":"github-actions-setup/#3-create-quay_password-secret","title":"3. Create QUAY_PASSWORD Secret","text":"<ul> <li>Name: <code>QUAY_PASSWORD</code></li> <li>Value: Your Quay.io password or robot token (recommended)</li> </ul> <p>Recommended: Use Quay.io Robot Token</p> <p>For better security, use a robot account instead of your personal credentials:</p> <ol> <li>Go to quay.io/repository/sshaaf/keycloak-mcp-server</li> <li>Click Settings \u2192 Robot Accounts</li> <li>Click Create Robot Account</li> <li>Give it a name (e.g., <code>github_actions</code>)</li> <li>Grant Write permissions to the repository</li> <li>Copy the generated token</li> <li>Use the robot account name as <code>QUAY_USERNAME</code> (e.g., <code>sshaaf+github_actions</code>)</li> <li>Use the token as <code>QUAY_PASSWORD</code></li> </ol>"},{"location":"github-actions-setup/#workflows","title":"Workflows","text":""},{"location":"github-actions-setup/#1-build-and-push-workflow-build-artifactsyml","title":"1. Build and Push Workflow (<code>build-artifacts.yml</code>)","text":"<p>Triggers: - Push to <code>main</code> branch - Pull requests to <code>main</code> branch - Manual workflow dispatch</p> <p>Jobs:</p>"},{"location":"github-actions-setup/#a-build-jar","title":"a) <code>build-jar</code>","text":"<ul> <li>Builds Uber JAR</li> <li>Uploads artifact</li> <li>Runs on: All triggers</li> </ul>"},{"location":"github-actions-setup/#b-build-native-linux","title":"b) <code>build-native-linux</code>","text":"<ul> <li>Builds native Linux binary with GraalVM</li> <li>Uploads artifact</li> <li>Runs on: All triggers</li> </ul>"},{"location":"github-actions-setup/#c-build-native-macos","title":"c) <code>build-native-macos</code>","text":"<ul> <li>Builds native macOS binary with GraalVM</li> <li>Uploads artifact</li> <li>Runs on: All triggers</li> </ul>"},{"location":"github-actions-setup/#d-build-native-windows","title":"d) <code>build-native-windows</code>","text":"<ul> <li>Builds native Windows binary with GraalVM</li> <li>Uploads artifact</li> <li>Runs on: All triggers</li> </ul>"},{"location":"github-actions-setup/#e-build-and-push-container-new","title":"e) <code>build-and-push-container</code> New","text":"<ul> <li>Builds container image using Jib</li> <li>Pushes to Quay.io with automatic git SHA tagging</li> <li>Runs on: Only push to <code>main</code> branch (not on PRs)</li> <li>Tags created:</li> <li><code>&lt;git-commit-sha&gt;</code> (e.g., <code>49ff54e</code>) - primary tag</li> <li><code>latest</code> - always updated</li> </ul> <p>Why only on main? - Prevents pushing unnecessary images on every PR - Ensures only tested and merged code gets published - Saves CI/CD resources and Quay.io storage</p>"},{"location":"github-actions-setup/#2-release-workflow-releaseyml","title":"2. Release Workflow (<code>release.yml</code>)","text":"<p>Triggers: - Manual workflow dispatch only</p> <p>Version Management: - Automatic version extraction from <code>pom.xml</code> - No hardcoded versions - always in sync with Maven project</p> <p>Jobs:</p> <p>All build jobs from above, plus:</p>"},{"location":"github-actions-setup/#build-and-push-container-release-version","title":"<code>build-and-push-container</code> (Release version)","text":"<ul> <li>Builds container image using Jib</li> <li>Pushes to Quay.io with version tagging</li> <li>Tags created:</li> <li><code>&lt;git-commit-sha&gt;</code> (e.g., <code>49ff54e</code>) - primary tag</li> <li><code>&lt;version&gt;</code> (e.g., <code>0.3.0</code>) - semantic version</li> <li><code>latest</code> - always updated</li> </ul>"},{"location":"github-actions-setup/#release","title":"<code>release</code>","text":"<ul> <li>Creates GitHub release with semantic-release</li> <li>Uploads all build artifacts</li> <li>Runs after all builds complete successfully</li> </ul>"},{"location":"github-actions-setup/#container-image-tags","title":"Container Image Tags","text":""},{"location":"github-actions-setup/#automatic-tagging-strategy","title":"Automatic Tagging Strategy","text":"Event Git SHA Tag Version Tag Latest Tag Push to main <code>49ff54e</code> <code>latest</code> Release <code>49ff54e</code> <code>0.3.0</code> <code>latest</code>"},{"location":"github-actions-setup/#tag-breakdown","title":"Tag Breakdown","text":"<ol> <li>Git Commit SHA (always created)</li> <li>Format: Short SHA (7 characters)</li> <li>Example: <code>49ff54e</code></li> <li>Purpose: Perfect traceability to source code</li> <li> <p>Usage: Production deployments</p> </li> <li> <p>Version Tag (release only)</p> </li> <li>Format: Semantic version from <code>pom.xml</code></li> <li>Example: <code>0.3.0</code></li> <li>Purpose: Mark stable releases</li> <li> <p>Usage: Official releases</p> </li> <li> <p>Latest Tag (always updated)</p> </li> <li>Format: <code>latest</code></li> <li>Purpose: Points to most recent build</li> <li>Usage: Development/testing only</li> </ol>"},{"location":"github-actions-setup/#workflow-examples","title":"Workflow Examples","text":""},{"location":"github-actions-setup/#example-1-regular-development-push","title":"Example 1: Regular Development Push","text":"<pre><code># Developer pushes to main\ngit push origin main\n\n# GitHub Actions:\n# 1. Builds JAR, native binaries (all platforms)\n# 2. Builds and pushes container image to Quay.io\n#\n# Result:\n# - quay.io/sshaaf/keycloak-mcp-server:49ff54e\n# - quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre>"},{"location":"github-actions-setup/#example-2-pull-request","title":"Example 2: Pull Request","text":"<pre><code># Developer creates PR\ngit push origin feature-branch\n\n# GitHub Actions:\n# 1. Builds JAR, native binaries (all platforms)\n# 2. Does NOT push container image\n#\n# Result:\n# - Artifacts built and tested\n# - No container images pushed (saves resources)\n</code></pre>"},{"location":"github-actions-setup/#example-3-manual-release","title":"Example 3: Manual Release","text":"<pre><code># Maintainer triggers release workflow manually\n\n# GitHub Actions:\n# 1. Builds JAR, native binaries (all platforms)\n# 2. Builds and pushes container image with version tag\n# 3. Creates GitHub release\n#\n# Result:\n# - quay.io/sshaaf/keycloak-mcp-server:49ff54e\n# - quay.io/sshaaf/keycloak-mcp-server:0.3.0\n# - quay.io/sshaaf/keycloak-mcp-server:latest\n# - GitHub release with all artifacts\n</code></pre>"},{"location":"github-actions-setup/#verifying-container-push","title":"Verifying Container Push","text":"<p>After a push to main or a release, you can verify the images:</p>"},{"location":"github-actions-setup/#1-check-github-actions-summary","title":"1. Check GitHub Actions Summary","text":"<p>Go to the workflow run and check the Image Details section in the summary.</p>"},{"location":"github-actions-setup/#2-pull-the-image","title":"2. Pull the Image","text":"<pre><code># Pull by commit SHA (recommended)\ndocker pull quay.io/sshaaf/keycloak-mcp-server:49ff54e\n\n# Pull latest\ndocker pull quay.io/sshaaf/keycloak-mcp-server:latest\n\n# Pull by version (releases only)\ndocker pull quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre>"},{"location":"github-actions-setup/#3-check-quayio-repository","title":"3. Check Quay.io Repository","text":"<p>Visit: https://quay.io/repository/sshaaf/keycloak-mcp-server?tab=tags</p>"},{"location":"github-actions-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"github-actions-setup/#issue-container-push-fails-with-authentication-error","title":"Issue: Container Push Fails with Authentication Error","text":"<p>Error: <pre><code>Error: unauthorized: access to the requested resource is not authorized\n</code></pre></p> <p>Solution: 1. Verify <code>QUAY_USERNAME</code> and <code>QUAY_PASSWORD</code> secrets are set correctly 2. If using robot account, ensure it has Write permissions 3. Check the robot token hasn't expired</p>"},{"location":"github-actions-setup/#issue-container-push-fails-with-repository-not-found","title":"Issue: Container Push Fails with \"Repository Not Found\"","text":"<p>Error: <pre><code>Error: repository not found\n</code></pre></p> <p>Solution: 1. Create the repository on Quay.io first 2. Make sure the repository name matches: <code>quay.io/sshaaf/keycloak-mcp-server</code> 3. Ensure the repository is set to Public or the credentials have access</p>"},{"location":"github-actions-setup/#issue-git-commit-sha-not-resolved","title":"Issue: Git Commit SHA Not Resolved","text":"<p>Error: <pre><code>Tag contains @git.commit.id.abbrev@\n</code></pre></p> <p>Solution: 1. Ensure <code>fetch-depth: 0</code> is set in checkout step (already configured) 2. Verify the git-commit-id-maven-plugin is working 3. Check Maven build logs for git plugin execution</p>"},{"location":"github-actions-setup/#issue-container-build-succeeds-but-not-pushed","title":"Issue: Container Build Succeeds but Not Pushed","text":"<p>Check: 1. Verify you pushed to <code>main</code> branch (not a PR) 2. Check the workflow condition: <code>if: github.event_name == 'push' &amp;&amp; github.ref == 'refs/heads/main'</code> 3. Review GitHub Actions logs for the <code>build-and-push-container</code> job</p>"},{"location":"github-actions-setup/#local-testing","title":"Local Testing","text":"<p>You can test container building locally without pushing:</p> <pre><code># Build without pushing\nmvn clean package -Dquarkus.container-image.build=true\n\n# Build and push manually (requires local Docker)\nmvn clean package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.username=$QUAY_USERNAME \\\n -Dquarkus.container-image.password=$QUAY_PASSWORD\n</code></pre>"},{"location":"github-actions-setup/#security-best-practices","title":"Security Best Practices","text":""},{"location":"github-actions-setup/#1-use-robot-accounts","title":"1. Use Robot Accounts","text":"<ul> <li>Create dedicated robot account for CI/CD</li> <li>Grant only necessary permissions (Write to specific repo)</li> <li>Easier to rotate credentials</li> <li>Better audit trail</li> </ul>"},{"location":"github-actions-setup/#2-keep-secrets-secure","title":"2. Keep Secrets Secure","text":"<ul> <li>Never commit credentials to git</li> <li>Never log credentials in workflow output</li> <li>Use GitHub Secrets for all sensitive data</li> <li>Rotate credentials periodically</li> </ul>"},{"location":"github-actions-setup/#3-repository-settings","title":"3. Repository Settings","text":"<ul> <li>Make Quay.io repository Public for open-source projects</li> <li>Use Private for proprietary code</li> <li>Enable vulnerability scanning on Quay.io</li> <li>Set up image expiration policies for old tags</li> </ul>"},{"location":"github-actions-setup/#monitoring-and-maintenance","title":"Monitoring and Maintenance","text":""},{"location":"github-actions-setup/#regular-checks","title":"Regular Checks","text":"<ol> <li>Weekly: Review pushed images on Quay.io</li> <li>Monthly: Verify security scan results</li> <li>Quarterly: Rotate robot account tokens</li> <li>As needed: Update base image versions</li> </ol>"},{"location":"github-actions-setup/#image-cleanup","title":"Image Cleanup","text":"<p>Old images accumulate over time. Consider:</p> <ol> <li>Quay.io Expiration Policy:</li> <li>Keep <code>latest</code> forever</li> <li>Keep version tags (<code>0.3.0</code>) forever</li> <li> <p>Auto-expire git SHA tags after 90 days</p> </li> <li> <p>Manual Cleanup:  <pre><code># List all tags\ncurl https://quay.io/api/v1/repository/sshaaf/keycloak-mcp-server/tag/\n\n# Delete specific tag (via Quay.io UI or API)\n</code></pre></p> </li> </ol>"},{"location":"github-actions-setup/#summary","title":"Summary","text":"<p>Setup: Configure <code>QUAY_USERNAME</code> and <code>QUAY_PASSWORD</code> secrets  Push to main: Automatic container build and push with git SHA  Pull requests: Build only, no push (saves resources)  Releases: Build and push with git SHA + version tag  Tags: Git commit SHA (primary) + latest (always) + version (releases)  Security: Use robot accounts with minimal permissions</p> <p>Your GitHub Actions are now configured to automatically push container images to Quay.io!</p> <p>For any issues, check the GitHub Actions logs or Quay.io repository.</p>"},{"location":"implementation-summary/","title":"Implementation Summary: Parametric Collapse Strategy","text":""},{"location":"implementation-summary/#overview","title":"Overview","text":"<p>Successfully implemented the Parametric Collapse Pattern for the Keycloak MCP Server, consolidating 37+ individual tool methods across 7 tool classes into a single unified <code>KeycloakTool</code> class.</p>"},{"location":"implementation-summary/#implementation-date","title":"Implementation Date","text":"<p>November 20, 2025</p>"},{"location":"implementation-summary/#what-was-built","title":"What Was Built","text":""},{"location":"implementation-summary/#1-core-implementation-keycloaktooljava","title":"1. Core Implementation: KeycloakTool.java","text":"<p>Location: <code>src/main/java/dev/shaaf/keycloak/mcp/server/KeycloakTool.java</code></p> <p>Key Features: - Single <code>@Tool</code> annotated method: <code>executeKeycloakOperation()</code> - Enum-based operation selection with 45+ operations - JSON-based parameter passing for flexibility - Direct service layer integration - Comprehensive error handling and logging - Zero breaking changes to service layer</p> <p>Statistics: - Lines of Code: ~450 - Operations Supported: 45+ - Service Classes Integrated: 7  - UserService  - RealmService  - ClientService  - RoleService  - GroupService  - IdentityProviderService  - AuthenticationService</p>"},{"location":"implementation-summary/#2-documentation","title":"2. Documentation","text":""},{"location":"implementation-summary/#parametric-collapsemd","title":"parametric-collapse.md","text":"<p>Content: - Detailed explanation of the pattern - Complete usage examples for all 45+ operations - Benefits and architecture diagrams - Extension guidelines - Performance considerations</p> <p>Sections: - Problem statement - Solution overview - Usage examples (15+ real-world examples) - Complete operation list with descriptions - Implementation details - Design pattern benefits</p>"},{"location":"implementation-summary/#migration-guidemd","title":"migration-guide.md","text":"<p>Content: - Before/after comparisons - Complete operation mapping table - Migration patterns and strategies - Backward compatibility options</p> <p>Sections: - Overview of changes - Service layer (no changes) - Tool layer (replaced) - 45+ operation mappings - Common migration patterns - Testing instructions</p>"},{"location":"implementation-summary/#readmemd-updates","title":"README.md Updates","text":"<p>Changes: - Added Parametric Collapse feature to features list - New section: \"Architecture: Unified Tool Design\" - Quick example of the new approach - Link to comprehensive documentation</p>"},{"location":"implementation-summary/#3-example-code","title":"3. Example Code","text":""},{"location":"implementation-summary/#keycloaktoolexamplejava","title":"KeycloakToolExample.java","text":"<p>Location: <code>src/main/java/dev/shaaf/keycloak/mcp/server/examples/KeycloakToolExample.java</code></p> <p>Content: - 10+ practical usage examples - Helper builder class for parameter construction - Main method with documentation examples - Demonstrates all major operation categories:  - User management  - Realm operations  - Client management  - Group operations  - Authentication flows</p>"},{"location":"implementation-summary/#technical-details","title":"Technical Details","text":""},{"location":"implementation-summary/#operation-categories","title":"Operation Categories","text":""},{"location":"implementation-summary/#user-operations-15","title":"User Operations (15)","text":"<pre><code>GET_USERS, GET_USER_BY_USERNAME, GET_USER_BY_ID\nCREATE_USER, DELETE_USER, UPDATE_USER\nGET_USER_GROUPS, ADD_USER_TO_GROUP, REMOVE_USER_FROM_GROUP\nGET_USER_ROLES, ADD_ROLE_TO_USER, REMOVE_ROLE_FROM_USER\nRESET_PASSWORD, SEND_VERIFICATION_EMAIL, COUNT_USERS\n</code></pre>"},{"location":"implementation-summary/#realm-operations-3","title":"Realm Operations (3)","text":"<pre><code>GET_REALMS, GET_REALM, CREATE_REALM\n</code></pre>"},{"location":"implementation-summary/#client-operations-8","title":"Client Operations (8)","text":"<pre><code>GET_CLIENTS, GET_CLIENT, CREATE_CLIENT, DELETE_CLIENT\nGENERATE_CLIENT_SECRET\nGET_CLIENT_ROLES, CREATE_CLIENT_ROLE, DELETE_CLIENT_ROLE\n</code></pre>"},{"location":"implementation-summary/#role-operations-2","title":"Role Operations (2)","text":"<pre><code>GET_REALM_ROLES, GET_REALM_ROLE\n</code></pre>"},{"location":"implementation-summary/#group-operations-6","title":"Group Operations (6)","text":"<pre><code>GET_GROUPS, GET_GROUP_MEMBERS\nCREATE_GROUP, UPDATE_GROUP, DELETE_GROUP, CREATE_SUBGROUP\n</code></pre>"},{"location":"implementation-summary/#identity-provider-operations-3","title":"Identity Provider Operations (3)","text":"<pre><code>GET_IDENTITY_PROVIDERS, GET_IDENTITY_PROVIDER\nGET_IDENTITY_PROVIDER_MAPPERS\n</code></pre>"},{"location":"implementation-summary/#authentication-operations-6","title":"Authentication Operations (6)","text":"<pre><code>GET_AUTHENTICATION_FLOWS, GET_AUTHENTICATION_FLOW\nCREATE_AUTHENTICATION_FLOW, DELETE_AUTHENTICATION_FLOW\nGET_FLOW_EXECUTIONS, UPDATE_FLOW_EXECUTION\n</code></pre>"},{"location":"implementation-summary/#implementation-pattern","title":"Implementation Pattern","text":"<pre><code>@Tool(description = \"Execute Keycloak operations...\")\npublic String executeKeycloakOperation(\n @ToolArg(description = \"Operation type\") KeycloakOperation operation,\n @ToolArg(description = \"JSON parameters\") String params) {\n\n try {\n JsonNode paramsNode = mapper.readTree(params);\n\n switch (operation) {\n case CREATE_USER:\n return userService.addUser(\n paramsNode.get(\"realm\").asText(),\n paramsNode.get(\"username\").asText(),\n // ... more params\n );\n // ... more cases\n }\n } catch (Exception e) {\n Log.error(\"Failed to execute operation: \" + operation, e);\n throw new ToolCallException(\"Failed: \" + e.getMessage());\n }\n}\n</code></pre>"},{"location":"implementation-summary/#benefits-achieved","title":"Benefits Achieved","text":""},{"location":"implementation-summary/#1-reduced-complexity","title":"1. Reduced Complexity","text":"<ul> <li>Before: 37+ individual MCP tool definitions</li> <li>After: 1 unified tool definition</li> <li>Reduction: 97% fewer tools exposed to AI models</li> </ul>"},{"location":"implementation-summary/#2-improved-maintainability","title":"2. Improved Maintainability","text":"<ul> <li>All routing logic centralized in one class</li> <li>Consistent error handling across all operations</li> <li>Single place to add logging, metrics, validation</li> <li>Easy to add new operations (just add enum value and case)</li> </ul>"},{"location":"implementation-summary/#3-better-developer-experience","title":"3. Better Developer Experience","text":"<ul> <li>Type-safe operation selection via enum</li> <li>Flexible JSON parameters</li> <li>Clear operation naming conventions</li> <li>Comprehensive documentation</li> </ul>"},{"location":"implementation-summary/#4-enhanced-ai-model-experience","title":"4. Enhanced AI Model Experience","text":"<ul> <li>AI sees 1 tool instead of 37+ tools</li> <li>Faster tool selection</li> <li>Less context needed</li> <li>More predictable behavior</li> </ul>"},{"location":"implementation-summary/#5-maintainability-metrics","title":"5. Maintainability Metrics","text":"<ul> <li>Code Duplication: Eliminated (was ~7x similar try-catch blocks)</li> <li>Error Handling: Unified</li> <li>Parameter Parsing: Centralized</li> <li>JSON Serialization: Single point of control</li> </ul>"},{"location":"implementation-summary/#files-createdmodified","title":"Files Created/Modified","text":""},{"location":"implementation-summary/#created-files","title":"Created Files","text":"<ol> <li><code>src/main/java/dev/shaaf/keycloak/mcp/server/KeycloakTool.java</code> (450 lines)</li> <li><code>src/main/java/dev/shaaf/keycloak/mcp/server/examples/KeycloakToolExample.java</code> (200 lines)</li> <li><code>parametric-collapse.md</code> (350 lines)</li> <li><code>migration-guide.md</code> (450 lines)</li> <li><code>implementation-summary.md</code> (this file)</li> </ol>"},{"location":"implementation-summary/#modified-files","title":"Modified Files","text":"<ol> <li><code>README.md</code> - Added sections about Parametric Collapse</li> </ol>"},{"location":"implementation-summary/#preserved-files-unchanged","title":"Preserved Files (Unchanged)","text":"<p>All service layer files remain unchanged: - <code>UserService.java</code> - <code>RealmService.java</code> - <code>ClientService.java</code> - <code>RoleService.java</code> - <code>GroupService.java</code> - <code>IdentityProviderService.java</code> - <code>AuthenticationService.java</code></p>"},{"location":"implementation-summary/#original-tool-files-status","title":"Original Tool Files Status","text":"<p>The following files can be optionally removed (not needed anymore): - <code>user/UserTool.java</code> - <code>realm/RealmTool.java</code> - <code>client/ClientTool.java</code> - <code>role/RoleTool.java</code> - <code>group/GroupTool.java</code> - <code>idp/IdentityProviderTool.java</code> - <code>authentication/AuthenticationTool.java</code></p> <p>Recommendation: Keep them for backward compatibility during a transition period, then deprecate and remove in a future major version.</p>"},{"location":"implementation-summary/#compilation-status","title":"Compilation Status","text":"<p>SUCCESS - Project compiles cleanly</p> <pre><code>[INFO] BUILD SUCCESS\n[INFO] Compiling 22 source files\n</code></pre>"},{"location":"implementation-summary/#example-usage","title":"Example Usage","text":""},{"location":"implementation-summary/#get-users-from-a-realm","title":"Get Users from a Realm","text":"<pre><code>keycloakTool.executeKeycloakOperation(\n KeycloakOperation.GET_USERS,\n \"{\\\"realm\\\": \\\"quarkus\\\"}\"\n)\n</code></pre>"},{"location":"implementation-summary/#create-a-new-user","title":"Create a New User","text":"<pre><code>keycloakTool.executeKeycloakOperation(\n KeycloakOperation.CREATE_USER,\n \"{\" +\n \" \\\"realm\\\": \\\"quarkus\\\",\" +\n \" \\\"username\\\": \\\"jdoe\\\",\" +\n \" \\\"firstName\\\": \\\"John\\\",\" +\n \" \\\"lastName\\\": \\\"Doe\\\",\" +\n \" \\\"email\\\": \\\"john@example.com\\\",\" +\n \" \\\"password\\\": \\\"secure123\\\"\" +\n \"}\"\n)\n</code></pre>"},{"location":"implementation-summary/#add-role-to-user","title":"Add Role to User","text":"<pre><code>keycloakTool.executeKeycloakOperation(\n KeycloakOperation.ADD_ROLE_TO_USER,\n \"{\" +\n \" \\\"realm\\\": \\\"quarkus\\\",\" +\n \" \\\"userId\\\": \\\"user-id-123\\\",\" +\n \" \\\"roleName\\\": \\\"admin\\\"\" +\n \"}\"\n)\n</code></pre>"},{"location":"implementation-summary/#testing","title":"Testing","text":""},{"location":"implementation-summary/#manual-testing","title":"Manual Testing","text":"<p>To test the implementation:</p> <pre><code># Compile\nmvn clean compile\n\n# Build\nmvn package\n\n# Run\njava -jar target/keycloak-mcp-server-0.2.0-runner.jar\n</code></pre>"},{"location":"implementation-summary/#integration-testing","title":"Integration Testing","text":"<p>Test with an MCP client (Goose, Claude Desktop, etc.) by: 1. Configuring the client to use the server 2. Attempting various operations 3. Verifying responses</p>"},{"location":"implementation-summary/#performance","title":"Performance","text":""},{"location":"implementation-summary/#expected-performance-characteristics","title":"Expected Performance Characteristics","text":"<ul> <li>Startup Time: No change (same service initialization)</li> <li>Memory Usage: Slightly reduced (fewer tool class instances)</li> <li>Execution Time: O(1) switch statement, negligible overhead</li> <li>JSON Parsing: One-time per call, minimal impact</li> </ul>"},{"location":"implementation-summary/#benchmark-expectations","title":"Benchmark Expectations","text":"<ul> <li>Switch statement: &lt; 1\u03bcs</li> <li>JSON parsing: 100-500\u03bcs (depends on param size)</li> <li>Service calls: Unchanged (majority of execution time)</li> </ul>"},{"location":"implementation-summary/#future-enhancements","title":"Future Enhancements","text":""},{"location":"implementation-summary/#potential-improvements","title":"Potential Improvements","text":"<ol> <li>Parameter Validation: Add JSON schema validation</li> <li>Rate Limiting: Add per-operation rate limits</li> <li>Metrics: Add operation-level metrics</li> <li>Caching: Cache frequently accessed data</li> <li>Async Support: Add async operation variants</li> <li>Bulk Operations: Add batch operation support</li> </ol>"},{"location":"implementation-summary/#extension-examples","title":"Extension Examples","text":"<p>Adding a new operation is straightforward:</p> <pre><code>// 1. Add to enum\npublic enum KeycloakOperation {\n // ... existing operations\n MY_NEW_OPERATION\n}\n\n// 2. Add to switch statement\ncase MY_NEW_OPERATION:\n return myService.myNewMethod(\n paramsNode.get(\"param1\").asText()\n );\n</code></pre>"},{"location":"implementation-summary/#conclusion","title":"Conclusion","text":"<p>The Parametric Collapse implementation successfully: - Reduced 37+ tools to 1 tool - Maintained all existing functionality - Preserved service layer (zero changes) - Improved code maintainability - Enhanced AI model usability - Provided comprehensive documentation - Included practical examples - Compiled successfully</p> <p>This implementation serves as a reference for applying the Parametric Collapse pattern to other MCP servers and API designs facing tool proliferation challenges.</p>"},{"location":"implementation-summary/#references","title":"References","text":"<ul> <li>parametric-collapse.md - Detailed pattern documentation</li> <li>migration-guide.md - Migration from old tools</li> <li>KeycloakToolExample.java (deleted) - Code examples</li> <li>index.md - Updated project documentation</li> </ul> <p>Status: COMPLETE AND READY FOR USE Build: PASSING Documentation: COMPREHENSIVE Examples: PROVIDED</p>"},{"location":"jib-container-guide/","title":"Jib Container Image Guide","text":""},{"location":"jib-container-guide/#overview","title":"Overview","text":"<p>The Keycloak MCP Server now supports building container images using Jib (Java Image Builder), a fast and efficient container image builder that doesn't require Docker to be installed.</p>"},{"location":"jib-container-guide/#what-is-jib","title":"What is Jib?","text":"<p>Jib is a containerization tool from Google that builds optimized Docker and OCI images for Java applications without needing: - Docker daemon - Dockerfile - Complex build scripts</p>"},{"location":"jib-container-guide/#benefits","title":"Benefits","text":"<p>No Docker Required - Build images without Docker daemon  Fast Builds - Only rebuilds changed layers  Reproducible - Same source = same image  Optimized Layers - Separates dependencies from classes  Multi-Platform - Build for linux/amd64 and linux/arm64  CI/CD Friendly - Perfect for pipelines</p>"},{"location":"jib-container-guide/#configuration","title":"Configuration","text":""},{"location":"jib-container-guide/#base-configuration","title":"Base Configuration","text":"<p>The project is configured in <code>application.properties</code>:</p> <pre><code># Container Image Configuration\nquarkus.container-image.build=false\nquarkus.container-image.registry=quay.io\nquarkus.container-image.group=sshaaf\nquarkus.container-image.name=keycloak-mcp-server\nquarkus.container-image.tag=@git.commit.id.abbrev@ # Automatic: Git SHA\nquarkus.container-image.additional-tags=latest # Automatic: Latest\n\n# Jib specific\nquarkus.jib.base-jvm-image=registry.access.redhat.com/ubi9/openjdk-21-runtime:1.20\nquarkus.jib.platforms=linux/amd64,linux/arm64\n</code></pre> <p>Note: The <code>@git.commit.id.abbrev@</code> is automatically replaced with the current git commit SHA during the build.</p>"},{"location":"jib-container-guide/#image-details","title":"Image Details","text":"<ul> <li>Registry: Quay.io</li> <li>Base Image: Red Hat UBI 9 with OpenJDK 21</li> <li>Platforms: AMD64 (x86_64) and ARM64 (Apple Silicon, AWS Graviton)</li> <li>Full Image: <code>quay.io/sshaaf/keycloak-mcp-server</code></li> <li>Primary Tag: Git commit SHA (e.g., <code>49ff54e</code>) - automatically generated</li> <li>Additional Tags: Version (<code>0.3.0</code>) + Latest (<code>latest</code>)</li> </ul>"},{"location":"jib-container-guide/#automatic-git-sha-tagging","title":"Automatic Git SHA Tagging","text":"<p>Images are automatically tagged with the git commit SHA for perfect traceability:</p> <pre><code># Every build automatically creates:\nquay.io/sshaaf/keycloak-mcp-server:49ff54e # Git commit SHA (primary)\nquay.io/sshaaf/keycloak-mcp-server:latest # Latest build\n\n# Semantic versions are manually tagged when ready for release:\ndocker tag quay.io/sshaaf/keycloak-mcp-server:49ff54e \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre> <p>Benefits: - Every image traceable to exact source code - Reproducible builds (same commit = same tag) - Easy rollbacks (use previous commit SHA) - No automatic SHA management needed - Manual control over semantic versions</p> <p>See Git Commit Tagging Guide for complete details.</p>"},{"location":"jib-container-guide/#building-container-images","title":"Building Container Images","text":""},{"location":"jib-container-guide/#1-build-and-push-to-quayio","title":"1. Build and Push to Quay.io","text":"<pre><code># Set Quay.io credentials\nexport QUAY_USERNAME=your-username\nexport QUAY_PASSWORD=your-password # or robot token\n\n# Build and push\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.username=${QUAY_USERNAME} \\\n -Dquarkus.container-image.password=${QUAY_PASSWORD}\n</code></pre> <p>Result: <code>quay.io/sshaaf/keycloak-mcp-server:0.3.0</code> and <code>:latest</code> pushed to Quay.io</p>"},{"location":"jib-container-guide/#2-build-and-push-to-custom-registry","title":"2. Build and Push to Custom Registry","text":"<pre><code># For GitHub Container Registry\n./mvnw package \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=ghcr.io \\\n -Dquarkus.container-image.group=your-username \\\n -Dquarkus.container-image.username=${GITHUB_USERNAME} \\\n -Dquarkus.container-image.password=${GITHUB_TOKEN}\n</code></pre> <p>Result: <code>ghcr.io/your-username/keycloak-mcp-server:0.3.0</code></p>"},{"location":"jib-container-guide/#3-build-and-load-to-docker-daemon","title":"3. Build and Load to Docker Daemon","text":"<pre><code># Build and load into local Docker\n./mvnw package -Dquarkus.jib.docker-executable-name=docker\n\n# Verify\ndocker images | grep keycloak-mcp-server\n</code></pre> <p>Result: Image available locally in Docker</p>"},{"location":"jib-container-guide/#4-build-to-tarball-offline-distribution","title":"4. Build to Tarball (Offline Distribution)","text":"<pre><code># Build to tar file\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Djib.outputPaths.tar=target/keycloak-mcp-server.tar\n\n# Load into Docker\ndocker load &lt; target/keycloak-mcp-server.tar\n</code></pre> <p>Result: <code>target/keycloak-mcp-server.tar</code> file created</p>"},{"location":"jib-container-guide/#5-build-for-specific-platform","title":"5. Build for Specific Platform","text":"<pre><code># Build only for ARM64 (Apple Silicon)\n./mvnw package -Dquarkus.jib.platforms=linux/arm64\n\n# Build only for AMD64\n./mvnw package -Dquarkus.jib.platforms=linux/amd64\n\n# Build for both (default)\n./mvnw package -Dquarkus.jib.platforms=linux/amd64,linux/arm64\n</code></pre>"},{"location":"jib-container-guide/#running-the-container","title":"Running the Container","text":""},{"location":"jib-container-guide/#using-docker","title":"Using Docker","text":"<pre><code># Pull and run from Quay.io\ndocker run -d \\\n -p 8080:8080 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n --name keycloak-mcp \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# Check logs\ndocker logs -f keycloak-mcp\n\n# Test health\ncurl http://localhost:8080/q/health\n</code></pre>"},{"location":"jib-container-guide/#using-podman","title":"Using Podman","text":"<pre><code># Same commands work with Podman\npodman run -d \\\n -p 8080:8080 \\\n -e KC_URL=http://host.containers.internal:8180 \\\n --name keycloak-mcp \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n</code></pre>"},{"location":"jib-container-guide/#using-docker-compose","title":"Using Docker Compose","text":"<pre><code>version: '3.8'\n\nservices:\n keycloak-mcp-server:\n image: quay.io/sshaaf/keycloak-mcp-server:0.3.0\n ports:\n - \"8080:8080\"\n environment:\n KC_URL: http://keycloak:8080 depends_on:\n - keycloak\n networks:\n - keycloak-net\n\n keycloak:\n image: quay.io/keycloak/keycloak:23.0\n ports:\n - \"8180:8080\"\n environment:\n KEYCLOAK_ADMIN: admin\n KEYCLOAK_ADMIN_PASSWORD: admin\n command: start-dev\n networks:\n - keycloak-net\n\nnetworks:\n keycloak-net:\n driver: bridge\n</code></pre> <p>Run with: <pre><code>docker compose up -d\n</code></pre></p>"},{"location":"jib-container-guide/#kubernetesopenshift-deployment","title":"Kubernetes/OpenShift Deployment","text":""},{"location":"jib-container-guide/#kubernetes-deployment","title":"Kubernetes Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n name: keycloak-mcp-server\n labels:\n app: keycloak-mcp-server\nspec:\n replicas: 1\n selector:\n matchLabels:\n app: keycloak-mcp-server\n template:\n metadata:\n labels:\n app: keycloak-mcp-server\n spec:\n containers:\n - name: server\n image: quay.io/sshaaf/keycloak-mcp-server:0.3.0\n ports:\n - containerPort: 8080\n name: http\n protocol: TCP\n env:\n - name: KC_URL\n value: \"http://keycloak:8080\" secretKeyRef:\n name: keycloak-admin\n key: password\n livenessProbe:\n httpGet:\n path: /q/health/live\n port: 8080\n initialDelaySeconds: 30\n periodSeconds: 10\n readinessProbe:\n httpGet:\n path: /q/health/ready\n port: 8080\n initialDelaySeconds: 10\n periodSeconds: 5\n resources:\n requests:\n memory: \"256Mi\"\n cpu: \"250m\"\n limits:\n memory: \"512Mi\"\n cpu: \"500m\"\n---\napiVersion: v1\nkind: Service\nmetadata:\n name: keycloak-mcp-server\nspec:\n type: ClusterIP\n selector:\n app: keycloak-mcp-server\n ports:\n - port: 8080\n targetPort: 8080\n name: http\n---\napiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n name: keycloak-mcp-server\n annotations:\n nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n rules:\n - host: mcp.example.com\n http:\n paths:\n - path: /\n pathType: Prefix\n backend:\n service:\n name: keycloak-mcp-server\n port:\n number: 8080\n</code></pre> <p>Deploy with: <pre><code>kubectl apply -f k8s-deployment.yaml\n</code></pre></p>"},{"location":"jib-container-guide/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"jib-container-guide/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Build and Push Container\n\non:\n push:\n branches: [ main ]\n tags: [ 'v*' ]\n\njobs:\n build:\n runs-on: ubuntu-latest\n steps:\n - uses: actions/checkout@v4\n\n - name: Set up JDK 21\n uses: actions/setup-java@v4\n with:\n java-version: '21'\n distribution: 'temurin'\n cache: maven\n\n - name: Build and Push Container Image\n run: |\n ./mvnw package \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=ghcr.io \\\n -Dquarkus.container-image.group=${{ github.repository_owner }} \\\n -Dquarkus.container-image.username=${{ github.actor }} \\\n -Dquarkus.container-image.password=${{ secrets.GITHUB_TOKEN }}\n</code></pre>"},{"location":"jib-container-guide/#gitlab-ci","title":"GitLab CI","text":"<pre><code>build-container:\n stage: build\n image: maven:3.9-eclipse-temurin-21\n script:\n - ./mvnw package\n -Dquarkus.container-image.push=true\n -Dquarkus.container-image.registry=$CI_REGISTRY\n -Dquarkus.container-image.group=$CI_PROJECT_NAMESPACE\n -Dquarkus.container-image.username=$CI_REGISTRY_USER\n -Dquarkus.container-image.password=$CI_REGISTRY_PASSWORD\n only:\n - main\n - tags\n</code></pre>"},{"location":"jib-container-guide/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"jib-container-guide/#custom-base-image","title":"Custom Base Image","text":"<pre><code># Use a different base image\nquarkus.jib.base-jvm-image=eclipse-temurin:21-jre\n</code></pre>"},{"location":"jib-container-guide/#additional-ports","title":"Additional Ports","text":"<pre><code># Expose additional ports\nquarkus.jib.ports=8080,8443\n</code></pre>"},{"location":"jib-container-guide/#custom-labels","title":"Custom Labels","text":"<pre><code># Add custom OCI labels\nquarkus.jib.labels.\"com.example.team\"=platform\nquarkus.jib.labels.\"com.example.maintainer\"=devops@example.com\n</code></pre>"},{"location":"jib-container-guide/#working-directory","title":"Working Directory","text":"<pre><code># Set working directory in container\nquarkus.jib.working-directory=/app\n</code></pre>"},{"location":"jib-container-guide/#user-configuration","title":"User Configuration","text":"<pre><code># Run as non-root user\nquarkus.jib.user=1001:1001\n</code></pre>"},{"location":"jib-container-guide/#jvm-arguments","title":"JVM Arguments","text":"<pre><code># Customize JVM arguments\nquarkus.jib.jvm-arguments=-Xmx512m,-Xms256m,-XX:+UseG1GC\n</code></pre>"},{"location":"jib-container-guide/#registry-specific-configurations","title":"Registry-Specific Configurations","text":""},{"location":"jib-container-guide/#quayio-default","title":"Quay.io (Default)","text":"<pre><code># Login to Quay.io (optional, for authentication)\ndocker login quay.io\n\n# Build and push\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.username=${QUAY_USERNAME} \\\n -Dquarkus.container-image.password=${QUAY_PASSWORD}\n\n# Or use robot account\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.username=sshaaf+robot \\\n -Dquarkus.container-image.password=${QUAY_ROBOT_TOKEN}\n</code></pre> <p>Repository: https://quay.io/repository/sshaaf/keycloak-mcp-server</p>"},{"location":"jib-container-guide/#docker-hub","title":"Docker Hub","text":"<pre><code>./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=docker.io \\\n -Dquarkus.container-image.username=${DOCKER_USERNAME} \\\n -Dquarkus.container-image.password=${DOCKER_PASSWORD}\n</code></pre>"},{"location":"jib-container-guide/#github-container-registry-ghcrio","title":"GitHub Container Registry (ghcr.io)","text":"<pre><code>./mvnw package \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=ghcr.io \\\n -Dquarkus.container-image.username=${GITHUB_USERNAME} \\\n -Dquarkus.container-image.password=${GITHUB_TOKEN}\n</code></pre>"},{"location":"jib-container-guide/#aws-ecr","title":"AWS ECR","text":"<pre><code># Login to ECR first\naws ecr get-login-password --region us-east-1 | \\\n docker login --username AWS --password-stdin 123456789012.dkr.ecr.us-east-1.amazonaws.com\n\n# Build and push\n./mvnw package \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=123456789012.dkr.ecr.us-east-1.amazonaws.com \\\n -Dquarkus.container-image.username=AWS \\\n -Dquarkus.container-image.password=$(aws ecr get-login-password --region us-east-1)\n</code></pre>"},{"location":"jib-container-guide/#azure-container-registry-acr","title":"Azure Container Registry (ACR)","text":"<pre><code># Login to ACR first\naz acr login --name myregistry\n\n# Build and push\n./mvnw package \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=myregistry.azurecr.io \\\n -Dquarkus.container-image.username=${ACR_USERNAME} \\\n -Dquarkus.container-image.password=${ACR_PASSWORD}\n</code></pre>"},{"location":"jib-container-guide/#google-container-registry-gcr","title":"Google Container Registry (GCR)","text":"<pre><code># Configure Docker to use gcloud as credential helper\ngcloud auth configure-docker\n\n# Build and push\n./mvnw package \\\n -Dquarkus.container-image.push=true \\\n -Dquarkus.container-image.registry=gcr.io \\\n -Dquarkus.container-image.group=${GCP_PROJECT_ID}\n</code></pre>"},{"location":"jib-container-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"jib-container-guide/#issue-unauthorized-authentication-required","title":"Issue: \"unauthorized: authentication required\"","text":"<p>Solution: Ensure you are logged in to the registry: <pre><code>docker login\n# or\necho $GITHUB_TOKEN | docker login ghcr.io -u $GITHUB_USERNAME --password-stdin\n</code></pre></p>"},{"location":"jib-container-guide/#issue-platform-not-supported","title":"Issue: \"platform not supported\"","text":"<p>Solution: Build for specific platform: <pre><code>./mvnw package -Dquarkus.jib.platforms=linux/amd64\n</code></pre></p>"},{"location":"jib-container-guide/#issue-build-is-slow","title":"Issue: Build is slow","text":"<p>Solution: Jib caches layers. First build is slow, subsequent builds are fast. To disable cache: <pre><code>./mvnw package -Dquarkus.jib.use-current-timestamp=true\n</code></pre></p>"},{"location":"jib-container-guide/#issue-base-image-pull-fails","title":"Issue: Base image pull fails","text":"<p>Solution: Check network connectivity or use alternative base image: <pre><code>quarkus.jib.base-jvm-image=eclipse-temurin:21-jre\n</code></pre></p>"},{"location":"jib-container-guide/#comparison-jib-vs-docker","title":"Comparison: Jib vs Docker","text":"Feature Jib Docker Build Docker Daemon Required No Yes Dockerfile Required No Yes Build Speed (incremental) Very Fast Slower Layer Optimization Automatic Manual Multi-Platform Native buildx required CI/CD Friendly Excellent Good Reproducibility Perfect Good Maven/Gradle Integration Native External"},{"location":"jib-container-guide/#best-practices","title":"Best Practices","text":""},{"location":"jib-container-guide/#1-use-specific-base-image-versions","title":"1. Use Specific Base Image Versions","text":"<pre><code># Good - pinned version\nquarkus.jib.base-jvm-image=registry.access.redhat.com/ubi9/openjdk-21-runtime:1.20\n\n# Avoid - floating tag\nquarkus.jib.base-jvm-image=openjdk:21\n</code></pre>"},{"location":"jib-container-guide/#2-tag-with-version-and-commit-sha","title":"2. Tag with Version and Commit SHA","text":"<pre><code>./mvnw package \\\n -Dquarkus.container-image.tag=0.3.0-${GIT_COMMIT_SHA}\n</code></pre>"},{"location":"jib-container-guide/#3-use-non-root-user","title":"3. Use Non-Root User","text":"<pre><code>quarkus.jib.user=1001:1001\n</code></pre>"},{"location":"jib-container-guide/#4-optimize-for-size","title":"4. Optimize for Size","text":"<ul> <li>Use minimal base images (UBI Micro, Alpine)</li> <li>Enable compression</li> <li>Remove unnecessary dependencies</li> </ul>"},{"location":"jib-container-guide/#5-security-scanning","title":"5. Security Scanning","text":"<pre><code># Scan with Trivy\ntrivy image quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# Scan with Snyk\nsnyk container test quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# Quay.io also provides built-in security scanning\n# View results at: https://quay.io/repository/sshaaf/keycloak-mcp-server?tab=tags\n</code></pre>"},{"location":"jib-container-guide/#image-information","title":"Image Information","text":""},{"location":"jib-container-guide/#default-built-image","title":"Default Built Image","text":"<ul> <li>Registry: Quay.io</li> <li>Full Name: <code>quay.io/sshaaf/keycloak-mcp-server</code></li> <li>Automatic Tags: <code>&lt;git-sha&gt;</code> (e.g., <code>49ff54e</code>), <code>latest</code></li> <li>Manual Tags: <code>0.3.0</code>, <code>1.0.0</code>, etc. (when you decide to release)</li> <li>Base: Red Hat UBI 9 + OpenJDK 21</li> <li>Size: ~250-300 MB</li> <li>Platforms: linux/amd64, linux/arm64</li> <li>Exposed Port: 8080 (overridden from default port 0)</li> <li>Endpoint: <code>/mcp/sse</code></li> </ul>"},{"location":"jib-container-guide/#port-configuration-strategy","title":"Port Configuration Strategy","text":"<p>The application uses smart port assignment:</p> Deployment Mode Port Reason Local JAR/Native <code>0</code> (random) Avoids port conflicts in development Container <code>8080</code> (fixed) Reliable networking for Docker/Kubernetes <p>The container automatically overrides port 0 to 8080 via the <code>QUARKUS_HTTP_PORT</code> environment variable.</p>"},{"location":"jib-container-guide/#labels","title":"Labels","text":"<p>All images include OCI-compliant labels: - <code>org.opencontainers.image.title</code> - <code>org.opencontainers.image.description</code> - <code>org.opencontainers.image.version</code> - <code>org.opencontainers.image.source</code> - <code>org.opencontainers.image.licenses</code></p>"},{"location":"jib-container-guide/#summary","title":"Summary","text":"<p>Jib Extension Added: <code>quarkus-container-image-jib</code> Configuration Complete: Ready to build images  Multi-Platform Support: AMD64 &amp; ARM64  CI/CD Ready: No Docker daemon required  Optimized Layers: Fast incremental builds</p> <p>Quick Start: <pre><code># Pull and run from Quay.io\ndocker pull quay.io/sshaaf/keycloak-mcp-server:latest\n\n# Run\ndocker run -d -p 8080:8080 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n quay.io/sshaaf/keycloak-mcp-server:0.3.0\n\n# Or build locally and load to Docker\n./mvnw package \\\n -Dquarkus.container-image.build=true \\\n -Dquarkus.jib.docker-executable-name=docker\n</code></pre></p> <p>For more information, see: - Quarkus Container Images Guide - Jib Documentation</p>"},{"location":"keycloak-tls-setup/","title":"Keycloak HTTPS/TLS Configuration Guide","text":""},{"location":"keycloak-tls-setup/#overview","title":"Overview","text":"<p>In production, Keycloak always uses HTTPS. This guide explains how to configure the Keycloak MCP Server to connect to HTTPS-enabled Keycloak instances.</p>"},{"location":"keycloak-tls-setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Keycloak deployed with HTTPS enabled</li> <li>Knowledge of your Keycloak TLS certificate type:</li> <li>Trusted CA-signed certificate</li> <li>Self-signed certificate</li> <li>OpenShift service CA</li> </ul>"},{"location":"keycloak-tls-setup/#scenarios","title":"Scenarios","text":""},{"location":"keycloak-tls-setup/#scenario-1-keycloak-with-trusted-ca-certificate","title":"Scenario 1: Keycloak with Trusted CA Certificate","text":"<p>If your Keycloak uses a certificate from a trusted CA (We will Encrypt, DigiCert, etc.), no additional configuration is needed.</p> <pre><code># configmap.yaml\ndata:\n keycloak-url: \"https://keycloak.example.com\"\n</code></pre> <p>The Java runtime will trust these certificates by default.</p>"},{"location":"keycloak-tls-setup/#scenario-2-keycloak-with-self-signed-certificate","title":"Scenario 2: Keycloak with Self-Signed Certificate","text":"<p>When Keycloak uses self-signed certificates (common in development/test), you need to configure trust.</p>"},{"location":"keycloak-tls-setup/#step-1-extract-keycloak-ca-certificate","title":"Step 1: Extract Keycloak CA Certificate","text":"<p>If Keycloak was deployed using the Keycloak Operator (as shown in your tutorial):</p> <pre><code># Get the TLS secret name from Keycloak CR\nKEYCLOAK_NAMESPACE=rhbk # Your Keycloak namespace\nKEYCLOAK_TLS_SECRET=example-tls-secret # From Keycloak CR spec.http.tlsSecret\n\n# Extract CA certificate\noc get secret ${KEYCLOAK_TLS_SECRET} -n ${KEYCLOAK_NAMESPACE} \\\n -o jsonpath='{.data.tls\\.crt}' | base64 -d &gt; keycloak-ca.crt\n</code></pre>"},{"location":"keycloak-tls-setup/#step-2-create-configmap-with-ca-certificate","title":"Step 2: Create ConfigMap with CA Certificate","text":"<pre><code># Create ConfigMap in your namespace\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=keycloak-ca.crt \\\n -n keycloak-mcp\n</code></pre>"},{"location":"keycloak-tls-setup/#step-3-update-deployment","title":"Step 3: Update Deployment","text":"<p>Edit <code>deploy/openshift/deployment.yaml</code>:</p> <pre><code>spec:\n template:\n spec:\n containers:\n - name: keycloak-mcp-server\n volumeMounts:\n - name: keycloak-ca-cert\n mountPath: /certs\n readOnly: true\n env:\n # Add JVM trust store configuration\n - name: JAVA_OPTS\n value: \"-Djavax.net.ssl.trustStore=/certs/cacerts -Djavax.net.ssl.trustStorePassword=changeit\"\n volumes:\n - name: keycloak-ca-cert\n configMap:\n name: keycloak-ca-bundle\n</code></pre>"},{"location":"keycloak-tls-setup/#step-4-build-custom-truststore-alternative","title":"Step 4: Build Custom Truststore (Alternative)","text":"<p>For more control, create a custom Java truststore:</p> <pre><code># Import CA certificate into truststore\nkeytool -import -trustcacerts \\\n -alias keycloak-ca \\\n -file keycloak-ca.crt \\\n -keystore truststore.jks \\\n -storepass changeit \\\n -noprompt\n\n# Create secret with truststore\noc create secret generic keycloak-truststore \\\n --from-file=truststore.jks=truststore.jks\n</code></pre> <p>Update deployment:</p> <pre><code>spec:\n template:\n spec:\n containers:\n - name: keycloak-mcp-server\n volumeMounts:\n - name: truststore\n mountPath: /certs\n readOnly: true\n env:\n - name: JAVAX_NET_SSL_TRUSTSTORE\n value: /certs/truststore.jks\n - name: JAVAX_NET_SSL_TRUSTSTOREPASSWORD\n value: changeit\n volumes:\n - name: truststore\n secret:\n secretName: keycloak-truststore\n</code></pre>"},{"location":"keycloak-tls-setup/#scenario-3-keycloak-with-openshift-service-ca","title":"Scenario 3: Keycloak with OpenShift Service CA","text":"<p>When Keycloak is deployed on OpenShift and uses the platform's service CA:</p>"},{"location":"keycloak-tls-setup/#step-1-create-configmap-with-injection-annotation","title":"Step 1: Create ConfigMap with Injection Annotation","text":"<pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n name: keycloak-ca-bundle\n annotations:\n service.beta.openshift.io/inject-cabundle: \"true\"\ndata: {}\n</code></pre> <p>OpenShift automatically injects the service CA certificate.</p>"},{"location":"keycloak-tls-setup/#step-2-mount-in-deployment","title":"Step 2: Mount in Deployment","text":"<pre><code>spec:\n template:\n spec:\n containers:\n - name: keycloak-mcp-server\n volumeMounts:\n - name: keycloak-ca-cert\n mountPath: /etc/ssl/certs/openshift-ca.crt\n subPath: service-ca.crt\n readOnly: true\n env:\n - name: JAVA_OPTS\n value: \"-Djavax.net.ssl.trustStore=/etc/ssl/certs/openshift-ca.crt\"\n volumes:\n - name: keycloak-ca-cert\n configMap:\n name: keycloak-ca-bundle\n</code></pre>"},{"location":"keycloak-tls-setup/#scenario-4-keycloak-operator-deployment","title":"Scenario 4: Keycloak Operator Deployment","text":"<p>When using the Keycloak Operator (recommended approach from your tutorial):</p>"},{"location":"keycloak-tls-setup/#keycloak-cr-example","title":"Keycloak CR Example","text":"<pre><code>apiVersion: k8s.keycloak.org/v2alpha1\nkind: Keycloak\nmetadata:\n name: example-kc\n namespace: rhbk\nspec:\n instances: 1\n db:\n vendor: postgres\n host: postgres-db\n usernameSecret:\n name: keycloak-db-secret\n key: username\n passwordSecret:\n name: keycloak-db-secret\n key: password\n http:\n tlsSecret: example-tls-secret # TLS certificate\n hostname:\n hostname: keycloak.rhbk.apps.example.com\n</code></pre>"},{"location":"keycloak-tls-setup/#mcp-server-configuration","title":"MCP Server Configuration","text":"<pre><code># configmap.yaml\ndata:\n # Use the hostname from Keycloak CR with HTTPS\n keycloak-url: \"https://keycloak.rhbk.apps.example.com\"\n</code></pre>"},{"location":"keycloak-tls-setup/#extract-and-use-ca-certificate","title":"Extract and Use CA Certificate","text":"<pre><code># Extract CA from Keycloak's TLS secret\noc get secret example-tls-secret -n rhbk \\\n -o jsonpath='{.data.tls\\.crt}' | base64 -d &gt; keycloak-ca.crt\n\n# Create ConfigMap in MCP namespace\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=keycloak-ca.crt \\\n -n keycloak-mcp\n</code></pre>"},{"location":"keycloak-tls-setup/#complete-deployment-example","title":"Complete Deployment Example","text":""},{"location":"keycloak-tls-setup/#with-self-signed-certificate","title":"With Self-Signed Certificate","text":"<pre><code># 1. Create namespace\noc new-project keycloak-mcp\n\n# 2. Extract Keycloak CA certificate\noc get secret example-tls-secret -n rhbk \\\n -o jsonpath='{.data.tls\\.crt}' | base64 -d &gt; keycloak-ca.crt\n\n# 3. Create CA ConfigMap\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=keycloak-ca.crt\n\n# 4. Create secrets\noc create secret generic keycloak-mcp-secret \\\n --from-literal=username=admin \\\n --from-literal=password='YourPassword'\n\n# 5. Create ConfigMap with HTTPS URL\ncat &lt;&lt;EOF | oc apply -f -\napiVersion: v1\nkind: ConfigMap\nmetadata:\n name: keycloak-mcp-config\ndata:\n keycloak-url: \"https://keycloak.rhbk.apps.example.com\"\nEOF\n\n# 6. Deploy with CA certificate mounting\n# (Use updated deployment.yaml with uncommented volumes)\noc apply -f deploy/openshift/deployment.yaml\noc apply -f deploy/openshift/service.yaml\noc apply -f deploy/openshift/route.yaml\n</code></pre>"},{"location":"keycloak-tls-setup/#testing-connection","title":"Testing Connection","text":""},{"location":"keycloak-tls-setup/#test-from-pod","title":"Test from Pod","text":"<pre><code># Execute into the pod\noc exec -it deployment/keycloak-mcp-server -- /bin/sh\n\n# Test HTTPS connection\ncurl -v https://keycloak.rhbk.apps.example.com/realms/master\n\n# If using custom CA, test with certificate\ncurl --cacert /certs/ca.crt https://keycloak.rhbk.apps.example.com/realms/master\n</code></pre>"},{"location":"keycloak-tls-setup/#check-application-logs","title":"Check Application Logs","text":"<pre><code># View logs for connection errors\noc logs -f deployment/keycloak-mcp-server\n\n# Look for SSL/TLS errors like:\n# - \"PKIX path building failed\"\n# - \"unable to find valid certification path\"\n# - \"SSLHandshakeException\"\n</code></pre>"},{"location":"keycloak-tls-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"keycloak-tls-setup/#error-pkix-path-building-failed","title":"Error: \"PKIX path building failed\"","text":"<p>Cause: Java doesn't trust the Keycloak certificate.</p> <p>Solution: 1. Verify CA certificate is mounted: <code>oc exec deployment/keycloak-mcp-server -- ls -la /certs</code> 2. Check Java trust store configuration 3. Ensure certificate is valid and not expired</p>"},{"location":"keycloak-tls-setup/#error-unable-to-find-valid-certification-path","title":"Error: \"unable to find valid certification path\"","text":"<p>Cause: Certificate chain is incomplete or CA certificate is missing.</p> <p>Solution: 1. Extract the full certificate chain from Keycloak 2. Include intermediate certificates 3. Verify with: <code>openssl s_client -connect keycloak.example.com:443 -showcerts</code></p>"},{"location":"keycloak-tls-setup/#error-sslhandshakeexception-received-fatal-alert-handshake_failure","title":"Error: \"SSLHandshakeException: Received fatal alert: handshake_failure\"","text":"<p>Cause: TLS version mismatch or cipher suite incompatibility.</p> <p>Solution: 1. Check Keycloak TLS configuration 2. Enable TLS 1.2+ in Java:  <pre><code>env:\n- name: JAVA_OPTS\nvalue: \"-Dhttps.protocols=TLSv1.2,TLSv1.3\"\n</code></pre></p>"},{"location":"keycloak-tls-setup/#error-connection-refused-on-https-port","title":"Error: \"Connection refused\" on HTTPS port","text":"<p>Cause: Keycloak not listening on HTTPS or firewall blocking.</p> <p>Solution: 1. Verify Keycloak route: <code>oc get route -n rhbk</code> 2. Test connectivity: <code>curl -v https://keycloak.example.com</code> 3. Check if Keycloak pods are running: <code>oc get pods -n rhbk</code></p>"},{"location":"keycloak-tls-setup/#security-best-practices","title":"Security Best Practices","text":""},{"location":"keycloak-tls-setup/#1-never-disable-certificate-verification","title":"1. Never Disable Certificate Verification","text":"<p>Don't do this: <pre><code>env:\n- name: JAVA_OPTS\n value: \"-Djavax.net.ssl.trustAll=true\" # INSECURE!\n</code></pre></p> <p>Do this: Always configure proper certificate trust.</p>"},{"location":"keycloak-tls-setup/#2-rotate-certificates-regularly","title":"2. Rotate Certificates Regularly","text":"<pre><code># Update CA certificate\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=new-keycloak-ca.crt \\\n --dry-run=client -o yaml | oc replace -f -\n\n# Restart pods to pick up new certificate\noc rollout restart deployment/keycloak-mcp-server\n</code></pre>"},{"location":"keycloak-tls-setup/#3-use-secrets-for-truststore-passwords","title":"3. Use Secrets for Truststore Passwords","text":"<pre><code>env:\n- name: JAVAX_NET_SSL_TRUSTSTOREPASSWORD\n valueFrom:\n secretKeyRef:\n name: keycloak-mcp-secret\n key: truststore-password\n</code></pre>"},{"location":"keycloak-tls-setup/#4-monitor-certificate-expiration","title":"4. Monitor Certificate Expiration","text":"<pre><code># Check certificate expiration\nopenssl s_client -connect keycloak.example.com:443 2&gt;/dev/null | \\\n openssl x509 -noout -dates\n</code></pre>"},{"location":"keycloak-tls-setup/#reference-keycloak-operator-installation","title":"Reference: Keycloak Operator Installation","text":"<p>Based on your tutorial, here is the complete Keycloak setup:</p>"},{"location":"keycloak-tls-setup/#1-install-keycloak-operator","title":"1. Install Keycloak Operator","text":"<pre><code># Via OpenShift Console or CLI\noc create -f https://operatorhub.io/install/keycloak-operator.yaml\n</code></pre>"},{"location":"keycloak-tls-setup/#2-deploy-postgresql","title":"2. Deploy PostgreSQL","text":"<pre><code>apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n name: postgresql-db\n namespace: rhbk\nspec:\n serviceName: postgresql-db-service\n selector:\n matchLabels:\n app: postgresql-db\n replicas: 1\n template:\n metadata:\n labels:\n app: postgresql-db\n spec:\n containers:\n - name: postgresql-db\n image: postgres:latest\n env:\n - name: POSTGRES_PASSWORD\n value: testpassword\n - name: POSTGRES_DB\n value: keycloak\n</code></pre>"},{"location":"keycloak-tls-setup/#3-create-tls-certificate","title":"3. Create TLS Certificate","text":"<pre><code># Create self-signed certificate\nopenssl req -subj '/CN=keycloak.rhbk.apps.example.com/O=Example Org/C=US' \\\n -newkey rsa:2048 -nodes -keyout key.pem \\\n -x509 -days 365 -out certificate.pem\n\n# Create secret\noc create secret tls example-tls-secret \\\n --cert certificate.pem \\\n --key key.pem \\\n -n rhbk\n</code></pre>"},{"location":"keycloak-tls-setup/#4-deploy-keycloak","title":"4. Deploy Keycloak","text":"<pre><code>apiVersion: k8s.keycloak.org/v2alpha1\nkind: Keycloak\nmetadata:\n name: example-kc\n namespace: rhbk\nspec:\n instances: 1\n db:\n vendor: postgres\n host: postgres-db\n usernameSecret:\n name: keycloak-db-secret\n key: username\n passwordSecret:\n name: keycloak-db-secret\n key: password\n http:\n tlsSecret: example-tls-secret\n hostname:\n hostname: keycloak.rhbk.apps.example.com\n</code></pre>"},{"location":"keycloak-tls-setup/#5-configure-mcp-server","title":"5. Configure MCP Server","text":"<pre><code># Extract Keycloak CA\noc get secret example-tls-secret -n rhbk \\\n -o jsonpath='{.data.tls\\.crt}' | base64 -d &gt; keycloak-ca.crt\n\n# Deploy MCP Server with CA trust\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=keycloak-ca.crt \\\n -n keycloak-mcp\n\n# Update configmap with HTTPS URL\noc patch configmap keycloak-mcp-config \\\n -p '{\"data\":{\"keycloak-url\":\"https://keycloak.rhbk.apps.example.com\"}}'\n</code></pre>"},{"location":"keycloak-tls-setup/#summary","title":"Summary","text":"<p>Production Keycloak always uses HTTPS Configure certificate trust based on CA type Use Keycloak Operator for managed deployments Never disable certificate verification Test connections before deploying Monitor certificate expiration</p> <p>For more details on Keycloak Operator deployment, see: Keycloak Operator for Kubernetes - a Basic Tutorial</p>"},{"location":"migration-guide/","title":"Migration Guide: Individual Tools \u2192 Unified KeycloakTool","text":"<p>This guide explains the transition from individual tool classes to the unified <code>KeycloakTool</code> using the Parametric Collapse pattern.</p>"},{"location":"migration-guide/#overview-of-changes","title":"Overview of Changes","text":""},{"location":"migration-guide/#before-multiple-tool-classes-old-approach","title":"Before: Multiple Tool Classes (Old Approach)","text":"<pre><code>src/main/java/dev/shaaf/keycloak/mcp/server/\n user/\n UserService.java\n UserTool.java (9 methods)\n realm/\n RealmService.java\n RealmTool.java (3 methods)\n client/\n ClientService.java\n ClientTool.java (9 methods)\n role/\n RoleService.java\n RoleTool.java (2 methods)\n group/\n GroupService.java\n GroupTool.java (5 methods)\n idp/\n IdentityProviderService.java\n IdentityProviderTool.java (3 methods)\n authentication/\n AuthenticationService.java\n AuthenticationTool.java (6 methods)\n\nTotal: 7 Tool Classes, 37+ Methods exposed as individual MCP tools\n</code></pre>"},{"location":"migration-guide/#after-single-unified-tool-new-approach","title":"After: Single Unified Tool (New Approach)","text":"<pre><code>src/main/java/dev/shaaf/keycloak/mcp/server/\n KeycloakTool.java (1 method, 45+ operations)\n user/\n UserService.java\n realm/\n RealmService.java\n client/\n ClientService.java\n role/\n RoleService.java\n group/\n GroupService.java\n idp/\n IdentityProviderService.java\n authentication/\n AuthenticationService.java\n\nTotal: 1 Tool Class, 1 Method, 45+ Operations via enum\n</code></pre>"},{"location":"migration-guide/#what-changed","title":"What Changed","text":""},{"location":"migration-guide/#service-layer","title":"Service Layer","text":"<p>NO CHANGES - All service classes remain unchanged - <code>UserService.java</code> - <code>RealmService.java</code> - <code>ClientService.java</code> - <code>RoleService.java</code> - <code>GroupService.java</code> - <code>IdentityProviderService.java</code> - <code>AuthenticationService.java</code></p>"},{"location":"migration-guide/#tool-layer","title":"Tool Layer","text":"<p>Deprecated/Replaced - Individual tool classes (can be kept for backward compatibility or removed) - <code>UserTool.java</code> - <code>RealmTool.java</code> - <code>ClientTool.java</code> - <code>RoleTool.java</code> - <code>GroupTool.java</code> - <code>IdentityProviderTool.java</code> - <code>AuthenticationTool.java</code></p> <p>NEW - Single unified tool class - <code>KeycloakTool.java</code></p>"},{"location":"migration-guide/#migration-examples","title":"Migration Examples","text":""},{"location":"migration-guide/#user-operations","title":"User Operations","text":""},{"location":"migration-guide/#before-usertoolgetusers","title":"Before: UserTool.getUsers()","text":"<pre><code>@Tool(description = \"Get all users from a keycloak realm\")\nString getUsers(@ToolArg(description = \"A String denoting the name of the realm\") String realm) {\n try {\n return mapper.writeValueAsString(userService.getUsers(realm));\n } catch (Exception e) {\n throw new ToolCallException(\"Failed to get users from realm\");\n }\n}\n</code></pre>"},{"location":"migration-guide/#after-keycloaktoolexecutekeycloakoperation","title":"After: KeycloakTool.executeKeycloakOperation()","text":"<pre><code>// Operation: GET_USERS\n// Params: {\"realm\": \"quarkus\"}\n\ncase GET_USERS:\n return mapper.writeValueAsString(\n userService.getUsers(paramsNode.get(\"realm\").asText())\n );\n</code></pre>"},{"location":"migration-guide/#before-usertooladduser","title":"Before: UserTool.addUser()","text":"<pre><code>@Tool(description = \"Create a new user in keycloak realm\")\nString addUser(@ToolArg(description = \"realm\") String realm,\n @ToolArg(description = \"username\") String username,\n @ToolArg(description = \"firstName\") String firstName,\n @ToolArg(description = \"lastName\") String lastName,\n @ToolArg(description = \"email\") String email,\n @ToolArg(description = \"password\") String password) {\n return userService.addUser(realm, username, firstName, lastName, email, password);\n}\n</code></pre>"},{"location":"migration-guide/#after-keycloaktoolexecutekeycloakoperation_1","title":"After: KeycloakTool.executeKeycloakOperation()","text":"<pre><code>// Operation: CREATE_USER\n// Params: {\n// \"realm\": \"quarkus\",\n// \"username\": \"jdoe\",\n// \"firstName\": \"John\",\n// \"lastName\": \"Doe\",\n// \"email\": \"john@example.com\",\n// \"password\": \"secure123\"\n// }\n\ncase CREATE_USER:\n return userService.addUser(\n paramsNode.get(\"realm\").asText(),\n paramsNode.get(\"username\").asText(),\n paramsNode.get(\"firstName\").asText(),\n paramsNode.get(\"lastName\").asText(),\n paramsNode.get(\"email\").asText(),\n paramsNode.get(\"password\").asText()\n );\n</code></pre>"},{"location":"migration-guide/#client-operations","title":"Client Operations","text":""},{"location":"migration-guide/#before-clienttoolgetclients","title":"Before: ClientTool.getClients()","text":"<pre><code>@Tool(description = \"Get all clients from a keycloak realm\")\nString getClients(@ToolArg(description = \"realm name\") String realm) {\n try {\n return mapper.writeValueAsString(clientService.getClients(realm));\n } catch (Exception e) {\n throw new ToolCallException(\"Unable to get clients from realm\");\n }\n}\n</code></pre>"},{"location":"migration-guide/#after-keycloaktoolexecutekeycloakoperation_2","title":"After: KeycloakTool.executeKeycloakOperation()","text":"<pre><code>// Operation: GET_CLIENTS\n// Params: {\"realm\": \"quarkus\"}\n\ncase GET_CLIENTS:\n return mapper.writeValueAsString(\n clientService.getClients(paramsNode.get(\"realm\").asText())\n );\n</code></pre>"},{"location":"migration-guide/#group-operations","title":"Group Operations","text":""},{"location":"migration-guide/#before-grouptoolcreategroup","title":"Before: GroupTool.createGroup()","text":"<pre><code>@Tool(description = \"Create a group in a realm\")\nString createGroup(@ToolArg(description = \"realm name\") String realm,\n @ToolArg(description = \"group name\") String groupName) {\n return groupService.createGroup(realm, groupName);\n}\n</code></pre>"},{"location":"migration-guide/#after-keycloaktoolexecutekeycloakoperation_3","title":"After: KeycloakTool.executeKeycloakOperation()","text":"<pre><code>// Operation: CREATE_GROUP\n// Params: {\n// \"realm\": \"quarkus\",\n// \"groupName\": \"Developers\"\n// }\n\ncase CREATE_GROUP:\n return groupService.createGroup(\n paramsNode.get(\"realm\").asText(),\n paramsNode.get(\"groupName\").asText()\n );\n</code></pre>"},{"location":"migration-guide/#complete-operation-mapping","title":"Complete Operation Mapping","text":""},{"location":"migration-guide/#user-operations-15","title":"User Operations (15)","text":"Old Method New Operation Parameters <code>getUsers(realm)</code> <code>GET_USERS</code> <code>{realm}</code> <code>getUserByUsername(realm, username)</code> <code>GET_USER_BY_USERNAME</code> <code>{realm, username}</code> <code>addUser(realm, username, ...)</code> <code>CREATE_USER</code> <code>{realm, username, firstName, lastName, email, password}</code> <code>getUserRoles(realm, userId)</code> <code>GET_USER_ROLES</code> <code>{realm, userId}</code> <code>addRoleToUser(realm, userId, roleName)</code> <code>ADD_ROLE_TO_USER</code> <code>{realm, userId, roleName}</code> <code>removeRoleFromUser(realm, userId, roleName)</code> <code>REMOVE_ROLE_FROM_USER</code> <code>{realm, userId, roleName}</code> <code>addUserToGroup(realm, userId, groupId)</code> <code>ADD_USER_TO_GROUP</code> <code>{realm, userId, groupId}</code> <code>removeUserFromGroup(realm, userId, groupId)</code> <code>REMOVE_USER_FROM_GROUP</code> <code>{realm, userId, groupId}</code> Not exposed before <code>DELETE_USER</code> <code>{realm, username}</code> Not exposed before <code>UPDATE_USER</code> <code>{realm, userId, userRepresentation}</code> Not exposed before <code>GET_USER_BY_ID</code> <code>{realm, userId}</code> Not exposed before <code>GET_USER_GROUPS</code> <code>{realm, userId}</code> Not exposed before <code>RESET_PASSWORD</code> <code>{realm, userId, newPassword, temporary}</code> Not exposed before <code>SEND_VERIFICATION_EMAIL</code> <code>{realm, userId}</code> Not exposed before <code>COUNT_USERS</code> <code>{realm}</code>"},{"location":"migration-guide/#realm-operations-3","title":"Realm Operations (3)","text":"Old Method New Operation Parameters <code>getRealms()</code> <code>GET_REALMS</code> <code>{}</code> <code>getRealm(realmName)</code> <code>GET_REALM</code> <code>{realmName}</code> <code>createRealm(realmName, displayName, enabled)</code> <code>CREATE_REALM</code> <code>{realmName, displayName, enabled}</code>"},{"location":"migration-guide/#client-operations-8","title":"Client Operations (8)","text":"Old Method New Operation Parameters <code>getClients(realm)</code> <code>GET_CLIENTS</code> <code>{realm}</code> <code>getClient(realm, clientId)</code> <code>GET_CLIENT</code> <code>{realm, clientId}</code> <code>addClient(realm, clientId, redirectUris)</code> <code>CREATE_CLIENT</code> <code>{realm, clientId, redirectUris}</code> <code>deleteClient(realm, clientId)</code> <code>DELETE_CLIENT</code> <code>{realm, clientId}</code> <code>generateNewClientSecret(realm, clientId)</code> <code>GENERATE_CLIENT_SECRET</code> <code>{realm, clientId}</code> <code>getClientRoles(realm, clientId)</code> <code>GET_CLIENT_ROLES</code> <code>{realm, clientId}</code> <code>createClientRole(realm, clientId, roleName, desc)</code> <code>CREATE_CLIENT_ROLE</code> <code>{realm, clientId, roleName, description}</code> <code>deleteClientRole(realm, clientId, roleName)</code> <code>DELETE_CLIENT_ROLE</code> <code>{realm, clientId, roleName}</code>"},{"location":"migration-guide/#role-operations-2","title":"Role Operations (2)","text":"Old Method New Operation Parameters <code>getRealmRoles(realm)</code> <code>GET_REALM_ROLES</code> <code>{realm}</code> <code>getRealmRole(realm, roleName)</code> <code>GET_REALM_ROLE</code> <code>{realm, roleName}</code>"},{"location":"migration-guide/#group-operations-6","title":"Group Operations (6)","text":"Old Method New Operation Parameters <code>getGroups(realm)</code> <code>GET_GROUPS</code> <code>{realm}</code> <code>getGroupMembers(realm, groupId)</code> <code>GET_GROUP_MEMBERS</code> <code>{realm, groupId}</code> <code>createGroup(realm, groupName)</code> <code>CREATE_GROUP</code> <code>{realm, groupName}</code> <code>updateGroup(realm, groupId, groupJson)</code> <code>UPDATE_GROUP</code> <code>{realm, groupId, groupRepresentation}</code> <code>deleteGroup(realm, groupId)</code> <code>DELETE_GROUP</code> <code>{realm, groupId}</code> <code>createSubGroup(realm, parentId, subName)</code> <code>CREATE_SUBGROUP</code> <code>{realm, parentGroupId, subGroupName}</code>"},{"location":"migration-guide/#identity-provider-operations-3","title":"Identity Provider Operations (3)","text":"Old Method New Operation Parameters <code>getIdentityProviders(realm)</code> <code>GET_IDENTITY_PROVIDERS</code> <code>{realm}</code> <code>getIdentityProvider(realm, alias)</code> <code>GET_IDENTITY_PROVIDER</code> <code>{realm, alias}</code> <code>getIdentityProviderMappers(realm, alias)</code> <code>GET_IDENTITY_PROVIDER_MAPPERS</code> <code>{realm, alias}</code>"},{"location":"migration-guide/#authentication-operations-6","title":"Authentication Operations (6)","text":"Old Method New Operation Parameters <code>getAuthenticationFlows(realm)</code> <code>GET_AUTHENTICATION_FLOWS</code> <code>{realm}</code> <code>getAuthenticationFlow(realm, flowId)</code> <code>GET_AUTHENTICATION_FLOW</code> <code>{realm, flowId}</code> <code>createAuthenticationFlow(realm, authFlowNameId)</code> <code>CREATE_AUTHENTICATION_FLOW</code> <code>{realm, authFlowNameId}</code> <code>deleteAuthenticationFlow(realm, flowId)</code> <code>DELETE_AUTHENTICATION_FLOW</code> <code>{realm, flowId}</code> <code>getFlowExecutions(realm, flowAlias)</code> <code>GET_FLOW_EXECUTIONS</code> <code>{realm, flowAlias}</code> <code>updateFlowExecution(realm, flowAlias, json)</code> <code>UPDATE_FLOW_EXECUTION</code> <code>{realm, flowAlias, executionRepresentation}</code>"},{"location":"migration-guide/#backward-compatibility","title":"Backward Compatibility","text":""},{"location":"migration-guide/#option-1-keep-both-recommended-for-gradual-migration","title":"Option 1: Keep Both (Recommended for Gradual Migration)","text":"<p>Keep the old tool classes alongside the new <code>KeycloakTool</code> for a transition period: - Allows existing integrations to continue working - Gives users time to migrate - Deprecate old tools in documentation - Remove in a future major version</p>"},{"location":"migration-guide/#option-2-remove-old-tools-clean-break","title":"Option 2: Remove Old Tools (Clean Break)","text":"<p>Remove all individual tool classes immediately: - Cleaner codebase - Forces migration - May break existing integrations - Recommended only if you control all clients</p>"},{"location":"migration-guide/#testing","title":"Testing","text":"<p>After migration, verify that all operations work:</p> <pre><code># Compile\nmvn clean compile\n\n# Run tests\nmvn test\n\n# Build native image\nmvn package -Pnative\n</code></pre>"},{"location":"migration-guide/#common-migration-patterns","title":"Common Migration Patterns","text":""},{"location":"migration-guide/#pattern-1-simple-parameter-mapping","title":"Pattern 1: Simple Parameter Mapping","text":"<pre><code>// Old: Direct parameters\nuserTool.getUsers(\"quarkus\")\n\n// New: JSON params\nkeycloakTool.executeKeycloakOperation(\n GET_USERS,\n \"{\\\"realm\\\":\\\"quarkus\\\"}\"\n)\n</code></pre>"},{"location":"migration-guide/#pattern-2-complex-object-parameters","title":"Pattern 2: Complex Object Parameters","text":"<pre><code>// Old: Parsed JSON string\ngroupTool.updateGroup(realm, groupId, groupJsonString)\n\n// New: Nested JSON object\nkeycloakTool.executeKeycloakOperation(\n UPDATE_GROUP,\n \"{\\\"realm\\\":\\\"...\\\", \\\"groupId\\\":\\\"...\\\", \\\"groupRepresentation\\\":{...}}\"\n)\n</code></pre>"},{"location":"migration-guide/#pattern-3-optional-parameters","title":"Pattern 3: Optional Parameters","text":"<pre><code>// Old: Separate method or default values\n// Not easily supported\n\n// New: Optional fields in JSON\nkeycloakTool.executeKeycloakOperation(\n RESET_PASSWORD,\n \"{\\\"realm\\\":\\\"...\\\", \\\"userId\\\":\\\"...\\\", \\\"newPassword\\\":\\\"...\\\", \\\"temporary\\\":false}\"\n)\n// If 'temporary' is not provided, defaults to false\n</code></pre>"},{"location":"migration-guide/#benefits-recap","title":"Benefits Recap","text":"<ol> <li>Reduced Complexity: 37+ tools \u2192 1 tool</li> <li>Better Error Handling: Centralized error management</li> <li>Type Safety: Enum prevents operation name typos</li> <li>Flexibility: JSON allows easy addition of optional parameters</li> <li>Maintainability: One place to add logging, metrics, validation</li> <li>Documentation: Single comprehensive doc instead of scattered docs</li> <li>AI-Friendly: Models process 1 tool faster than 37 tools</li> </ol>"},{"location":"migration-guide/#support","title":"Support","text":"<p>For questions or issues during migration: - Check parametric-collapse.md for detailed examples - See KeycloakTool.java for code samples - Open an issue on GitHub</p> <p>Migration Status: Complete - New unified tool ready for use Backward Compatibility: Optional - Old tool classes can be kept or removed based on your needs</p>"},{"location":"openshift-deployment/","title":"OpenShift Deployment Guide","text":""},{"location":"openshift-deployment/#overview","title":"Overview","text":"<p>This guide explains how to deploy the Keycloak MCP Server container to OpenShift using various methods.</p>"},{"location":"openshift-deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>OpenShift cluster access (v4.x or later)</li> <li><code>oc</code> CLI installed and configured</li> <li>Appropriate permissions to create resources in a namespace</li> <li>Keycloak instance with HTTPS enabled (production requirement)</li> <li>Keycloak CA certificate (if using self-signed certificates)</li> </ul>"},{"location":"openshift-deployment/#important-user-based-authentication-v040","title":"Important: User-Based Authentication (v0.4.0+)","text":"<p>** NEW: The MCP Server uses JWT Bearer tokens - each user authenticates with their OWN credentials!**</p> <p>See authentication.md for complete authentication guide</p> <p>How it works: <pre><code>User \u2192 Gets JWT token from Keycloak\n \u2193\nUser \u2192 MCP Server (with JWT in headers)\n \u2193\nMCP Server \u2192 Validates token (OIDC)\n \u2193\nMCP Server \u2192 Keycloak API (with user's token)\n \u2193\nKeycloak \u2192 Enforces user's permissions\n</code></pre></p> <p>Benefits: - Each user has their own permissions (no shared admin access) - Keycloak enforces its existing permission system - Realm isolation works automatically - Role-based access control (admin/manager/viewer) - Full audit trail by user - No service account needed!</p> <p>Getting your token: <pre><code>./scripts/get-mcp-token.sh \\\n --keycloak-url https://keycloak.example.com \\\n --username your-username \\\n --password your-password\n</code></pre></p>"},{"location":"openshift-deployment/#important-https-keycloak-configuration","title":"Important: HTTPS Keycloak Configuration","text":"<p>** Production Keycloak always uses HTTPS.** Before deploying, configure TLS trust:</p> <p>See keycloak-tls-setup.md for complete TLS configuration guide</p> <p>Quick summary: - Trusted CA: No additional configuration needed - Self-signed: Extract and mount CA certificate - OpenShift Service CA: Use ConfigMap annotation for auto-injection - Keycloak Operator: Extract certificate from Keycloak TLS secret</p> <p>Reference: Keycloak Operator Installation Tutorial</p>"},{"location":"openshift-deployment/#quick-start","title":"Quick Start","text":""},{"location":"openshift-deployment/#method-1-using-oc-cli-recommended","title":"Method 1: Using oc CLI (Recommended)","text":"<pre><code># 1. Login to OpenShift\noc login --server=https://your-openshift-cluster:6443\n\n# 2. Create a new project\noc new-project keycloak-mcp\n\n# 3. Deploy using manifests\noc apply -f deploy/openshift/\n\n# 4. Get the route URL\noc get route keycloak-mcp-server -o jsonpath='{.spec.host}'\n</code></pre>"},{"location":"openshift-deployment/#method-2-using-kustomize","title":"Method 2: Using Kustomize","text":"<pre><code># Deploy with kustomize\noc apply -k deploy/openshift/\n\n# Check deployment status\noc get pods -l app=keycloak-mcp-server\n</code></pre>"},{"location":"openshift-deployment/#method-3-using-openshift-web-console","title":"Method 3: Using OpenShift Web Console","text":"<ol> <li>Log in to OpenShift Web Console</li> <li>Navigate to Developer perspective</li> <li>Click +Add \u2192 Import from Git or Container Image</li> <li>Use image: <code>quay.io/sshaaf/keycloak-mcp-server:latest</code></li> <li>Configure environment variables and create</li> </ol>"},{"location":"openshift-deployment/#detailed-deployment","title":"Detailed Deployment","text":""},{"location":"openshift-deployment/#step-1-create-projectnamespace","title":"Step 1: Create Project/Namespace","text":"<pre><code># Create a dedicated project\noc new-project keycloak-mcp\n\n# Or use existing project\noc project keycloak-mcp\n</code></pre>"},{"location":"openshift-deployment/#step-2-configure-keycloak-connection","title":"Step 2: Configure Keycloak Connection","text":"<p>** Important: Use HTTPS URL for production Keycloak**</p> <p>Update ConfigMap (<code>deploy/openshift/configmap.yaml</code>):</p> <pre><code>data:\n # Production Keycloak HTTPS URL\n keycloak-url: \"https://keycloak.rhbk.apps.example.com\"\n # OR if using internal service (with custom CA)\n # keycloak-url: \"https://keycloak.keycloak-system.svc.cluster.local\"\n</code></pre> <p>Note: No secret is required. The MCP server validates JWT tokens using public OIDC discovery.</p> <p>Previous versions required a secret, but with JWT authentication, no secrets are needed for deployment.</p> <p>Environment Variables (in <code>deploy/openshift/deployment.yaml</code>):</p> <pre><code>stringData:\n username: \"your-keycloak-admin\"\n password: \"your-keycloak-password\"\n</code></pre> <p>Or create Secret from command line:</p> <pre><code>oc create secret generic keycloak-mcp-secret \\\n --from-literal=username=admin \\\n --from-literal=password='YourSecurePassword123!'\n</code></pre> <p>If using self-signed certificates, configure CA trust:</p> <pre><code># Extract CA certificate from Keycloak TLS secret\noc get secret example-tls-secret -n rhbk \\\n -o jsonpath='{.data.tls\\.crt}' | base64 -d &gt; keycloak-ca.crt\n\n# Create CA ConfigMap\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=keycloak-ca.crt\n\n# See keycloak-tls-setup.md for complete configuration\n</code></pre>"},{"location":"openshift-deployment/#step-3-apply-manifests","title":"Step 3: Apply Manifests","text":"<pre><code># Apply all resources\noc apply -f deploy/openshift/configmap.yaml\noc apply -f deploy/openshift/deployment.yaml\noc apply -f deploy/openshift/service.yaml\noc apply -f deploy/openshift/route.yaml\n</code></pre> <p>Or apply all at once:</p> <pre><code>oc apply -f deploy/openshift/\n</code></pre>"},{"location":"openshift-deployment/#step-4-verify-deployment","title":"Step 4: Verify Deployment","text":"<pre><code># Check pods\noc get pods -l app=keycloak-mcp-server\n\n# Check deployment\noc get deployment keycloak-mcp-server\n\n# Check service\noc get svc keycloak-mcp-server\n\n# Check route\noc get route keycloak-mcp-server\n\n# View logs\noc logs -f deployment/keycloak-mcp-server\n</code></pre>"},{"location":"openshift-deployment/#step-5-access-the-application","title":"Step 5: Access the Application","text":"<pre><code># Get the route URL\nROUTE_URL=$(oc get route keycloak-mcp-server -o jsonpath='{.spec.host}')\necho \"Application URL: https://${ROUTE_URL}\"\n\n# Test SSE endpoint\ncurl https://${ROUTE_URL}/mcp/sse\n</code></pre>"},{"location":"openshift-deployment/#deployment-options","title":"Deployment Options","text":""},{"location":"openshift-deployment/#option-1-using-specific-image-tag","title":"Option 1: Using Specific Image Tag","text":"<p>Deploy with a specific git commit SHA for production:</p> <pre><code># Edit deployment.yaml or use kustomize\noc set image deployment/keycloak-mcp-server \\\n keycloak-mcp-server=quay.io/sshaaf/keycloak-mcp-server:49ff54e\n</code></pre>"},{"location":"openshift-deployment/#option-2-using-helm-if-available","title":"Option 2: Using Helm (if available)","text":"<p>Create a Helm chart for more flexibility:</p> <pre><code># Install using Helm\nhelm install keycloak-mcp-server ./charts/keycloak-mcp-server \\\n --set image.tag=0.3.0 \\\n --set keycloak.url=http://keycloak:8080 \\\n --set keycloak.username=admin \\\n --set keycloak.password=admin\n</code></pre>"},{"location":"openshift-deployment/#option-3-using-openshift-template","title":"Option 3: Using OpenShift Template","text":"<p>Create and process an OpenShift template:</p> <pre><code>oc process -f deploy/openshift/template.yaml \\\n -p KEYCLOAK_URL=http://keycloak:8080 \\\n -p KEYCLOAK_USERNAME=admin \\\n -p KEYCLOAK_PASSWORD=admin \\\n | oc apply -f -\n</code></pre>"},{"location":"openshift-deployment/#configuration","title":"Configuration","text":""},{"location":"openshift-deployment/#environment-variables","title":"Environment Variables","text":"<p>The deployment supports the following environment variables:</p> Variable Description Default Required <code>KC_URL</code> Keycloak server URL - Yes <code>KC_USER</code> Keycloak admin username - Yes <code>KC_PASSWORD</code> Keycloak admin password - Yes <code>QUARKUS_HTTP_PORT</code> HTTP port <code>8080</code> No <code>QUARKUS_LOG_LEVEL</code> Log level <code>INFO</code> No"},{"location":"openshift-deployment/#resource-limits","title":"Resource Limits","text":"<p>Default resource configuration:</p> <pre><code>resources:\n requests:\n memory: \"256Mi\"\n cpu: \"100m\"\n limits:\n memory: \"512Mi\"\n cpu: \"500m\"\n</code></pre> <p>Adjust for your workload:</p> <pre><code>oc set resources deployment/keycloak-mcp-server \\\n --requests=cpu=200m,memory=512Mi \\\n --limits=cpu=1000m,memory=1Gi\n</code></pre>"},{"location":"openshift-deployment/#scaling","title":"Scaling","text":"<pre><code># Scale up\noc scale deployment/keycloak-mcp-server --replicas=3\n\n# Enable autoscaling\noc autoscale deployment/keycloak-mcp-server \\\n --min=1 --max=5 --cpu-percent=80\n</code></pre>"},{"location":"openshift-deployment/#security","title":"Security","text":""},{"location":"openshift-deployment/#running-as-non-root","title":"Running as Non-Root","text":"<p>The container runs as non-root by default. To enforce:</p> <pre><code>spec:\n template:\n spec:\n securityContext:\n runAsNonRoot: true\n seccompProfile:\n type: RuntimeDefault\n containers:\n - name: keycloak-mcp-server\n securityContext:\n allowPrivilegeEscalation: false\n capabilities:\n drop:\n - ALL\n</code></pre>"},{"location":"openshift-deployment/#using-sealed-secrets","title":"Using Sealed Secrets","text":"<p>For production, use Sealed Secrets or External Secrets Operator:</p> <pre><code># Create sealed secret\necho -n 'admin' | \\\n kubectl create secret generic keycloak-mcp-secret \\\n --dry-run=client \\\n -o yaml | \\\n kubeseal -o yaml &gt; sealed-configmap.yaml\n\noc apply -f sealed-configmap.yaml\n</code></pre>"},{"location":"openshift-deployment/#network-policies","title":"Network Policies","text":"<p>Restrict network access:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n name: keycloak-mcp-server-netpol\nspec:\n podSelector:\n matchLabels:\n app: keycloak-mcp-server\n policyTypes:\n - Ingress\n - Egress\n ingress:\n - from:\n - namespaceSelector:\n matchLabels:\n name: openshift-ingress\n ports:\n - protocol: TCP\n port: 8080\n egress:\n - to:\n - namespaceSelector:\n matchLabels:\n name: keycloak-system\n ports:\n - protocol: TCP\n port: 8080\n</code></pre>"},{"location":"openshift-deployment/#health-checks","title":"Health Checks","text":"<p>The deployment includes comprehensive health checks:</p>"},{"location":"openshift-deployment/#liveness-probe","title":"Liveness Probe","text":"<ul> <li>Path: <code>/q/health/live</code></li> <li>Checks if the application is alive</li> <li>Restarts pod if failing</li> </ul>"},{"location":"openshift-deployment/#readiness-probe","title":"Readiness Probe","text":"<ul> <li>Path: <code>/q/health/ready</code></li> <li>Checks if application can accept traffic</li> <li>Removes from service if failing</li> </ul>"},{"location":"openshift-deployment/#startup-probe","title":"Startup Probe","text":"<ul> <li>Path: <code>/q/health/started</code></li> <li>Checks if application has started</li> <li>Gives more time for slow startup</li> </ul>"},{"location":"openshift-deployment/#monitoring","title":"Monitoring","text":""},{"location":"openshift-deployment/#viewing-logs","title":"Viewing Logs","text":"<pre><code># Stream logs\noc logs -f deployment/keycloak-mcp-server\n\n# Last 100 lines\noc logs --tail=100 deployment/keycloak-mcp-server\n\n# Previous container (if crashed)\noc logs deployment/keycloak-mcp-server --previous\n</code></pre>"},{"location":"openshift-deployment/#metrics-if-prometheus-is-installed","title":"Metrics (if Prometheus is installed)","text":"<pre><code># Check metrics endpoint\noc exec deployment/keycloak-mcp-server -- \\\n curl http://localhost:8080/q/metrics\n\n# Create ServiceMonitor for Prometheus\ncat &lt;&lt;EOF | oc apply -f -\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n name: keycloak-mcp-server\n labels:\n app: keycloak-mcp-server\nspec:\n selector:\n matchLabels:\n app: keycloak-mcp-server\n endpoints:\n - port: http\n path: /q/metrics\n interval: 30s\nEOF\n</code></pre>"},{"location":"openshift-deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"openshift-deployment/#pod-not-starting","title":"Pod Not Starting","text":"<pre><code># Check pod status\noc get pods -l app=keycloak-mcp-server\n\n# Describe pod for events\noc describe pod -l app=keycloak-mcp-server\n\n# Check logs\noc logs -l app=keycloak-mcp-server\n</code></pre>"},{"location":"openshift-deployment/#connection-to-keycloak-fails","title":"Connection to Keycloak Fails","text":"<pre><code># Test from pod\noc exec deployment/keycloak-mcp-server -- \\\n curl -v $KC_URL\n\n# Check DNS resolution\noc exec deployment/keycloak-mcp-server -- \\\n nslookup keycloak.keycloak-system.svc.cluster.local\n\n# Check network policy\noc get networkpolicy\n</code></pre>"},{"location":"openshift-deployment/#image-pull-errors","title":"Image Pull Errors","text":"<pre><code># Check image pull secret (if using private registry)\noc get secret -n keycloak-mcp\n\n# Create image pull secret\noc create secret docker-registry quay-pull-secret \\\n --docker-server=quay.io \\\n --docker-username=sshaaf \\\n --docker-password=&lt;token&gt;\n\n# Link to service account\noc secrets link default quay-pull-secret --for=pull\n</code></pre>"},{"location":"openshift-deployment/#route-not-accessible","title":"Route Not Accessible","text":"<pre><code># Check route\noc get route keycloak-mcp-server\n\n# Check if TLS is configured\noc describe route keycloak-mcp-server\n\n# Test from inside cluster\noc run test --rm -it --image=curlimages/curl -- \\\n curl http://keycloak-mcp-server/mcp/sse\n</code></pre>"},{"location":"openshift-deployment/#advanced-configurations","title":"Advanced Configurations","text":""},{"location":"openshift-deployment/#using-external-keycloak","title":"Using External Keycloak","text":"<p>If Keycloak is outside OpenShift (e.g., managed service, different cluster):</p> <pre><code># configmap.yaml\ndata:\n # External Keycloak with trusted CA certificate\n keycloak-url: \"https://keycloak.example.com\"\n</code></pre> <p>If using custom CA or self-signed certificate:</p> <ol> <li>Get the CA certificate from your Keycloak administrator</li> <li>Create ConfigMap:  <pre><code>oc create configmap keycloak-ca-bundle --from-file=ca.crt=external-keycloak-ca.crt\n</code></pre></li> <li>Update deployment to mount the certificate (see keycloak-tls-setup.md)</li> </ol> <p>If using Keycloak Operator (recommended approach from this tutorial):</p> <pre><code># Keycloak is deployed with operator in 'rhbk' namespace\n# Extract the TLS certificate\noc get secret example-tls-secret -n rhbk \\\n -o jsonpath='{.data.tls\\.crt}' | base64 -d &gt; keycloak-ca.crt\n\n# Create CA bundle in MCP namespace\noc create configmap keycloak-ca-bundle \\\n --from-file=ca.crt=keycloak-ca.crt \\\n -n keycloak-mcp\n</code></pre>"},{"location":"openshift-deployment/#blue-green-deployment","title":"Blue-Green Deployment","text":"<pre><code># Create blue deployment\noc apply -f deploy/openshift/ -l version=blue\n\n# Test blue\noc get route keycloak-mcp-server-blue\n\n# Deploy green\noc apply -f deploy/openshift/ -l version=green\n\n# Switch traffic\noc patch route keycloak-mcp-server \\\n -p '{\"spec\":{\"to\":{\"name\":\"keycloak-mcp-server-green\"}}}'\n</code></pre>"},{"location":"openshift-deployment/#using-s2i-source-to-image","title":"Using S2I (Source-to-Image)","text":"<p>Build from source using OpenShift S2I:</p> <pre><code>oc new-app quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21~https://github.com/sshaaf/keycloak-mcp-server \\\n --name=keycloak-mcp-server \\\n --env KC_URL=http://keycloak:8080 \\\n --env KC_USER=admin \\\n --env KC_PASSWORD=admin\n</code></pre>"},{"location":"openshift-deployment/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"openshift-deployment/#using-tekton-pipelines","title":"Using Tekton Pipelines","text":"<p>Create a Tekton pipeline for automated deployment:</p> <pre><code>apiVersion: tekton.dev/v1beta1\nkind: Pipeline\nmetadata:\n name: keycloak-mcp-deploy\nspec:\n params:\n - name: image-tag\n description: Image tag to deploy\n default: latest\n tasks:\n - name: deploy\n taskRef:\n name: openshift-client\n params:\n - name: SCRIPT\n value: |\n oc set image deployment/keycloak-mcp-server \\\n keycloak-mcp-server=quay.io/sshaaf/keycloak-mcp-server:$(params.image-tag)\n oc rollout status deployment/keycloak-mcp-server\n</code></pre>"},{"location":"openshift-deployment/#using-argocd","title":"Using ArgoCD","text":"<p>Deploy using GitOps with ArgoCD:</p> <pre><code>apiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n name: keycloak-mcp-server\n namespace: argocd\nspec:\n project: default\n source:\n repoURL: https://github.com/sshaaf/keycloak-mcp-server\n targetRevision: main\n path: deploy/openshift\n destination:\n server: https://kubernetes.default.svc\n namespace: keycloak-mcp\n syncPolicy:\n automated:\n prune: true\n selfHeal: true\n</code></pre>"},{"location":"openshift-deployment/#backup-and-restore","title":"Backup and Restore","text":""},{"location":"openshift-deployment/#backup-resources","title":"Backup Resources","text":"<pre><code># Backup all resources\noc get all,configmap,secret -l app=keycloak-mcp-server -o yaml &gt; backup.yaml\n\n# Backup specific resources\noc get deployment,service,route keycloak-mcp-server -o yaml &gt; resources-backup.yaml\n</code></pre>"},{"location":"openshift-deployment/#restore","title":"Restore","text":"<pre><code># Restore from backup\noc apply -f backup.yaml\n</code></pre>"},{"location":"openshift-deployment/#cleanup","title":"Cleanup","text":"<pre><code># Delete all resources\noc delete -f deploy/openshift/\n\n# Or delete by label\noc delete all -l app=keycloak-mcp-server\n\n# Delete project\noc delete project keycloak-mcp\n</code></pre>"},{"location":"openshift-deployment/#best-practices","title":"Best Practices","text":""},{"location":"openshift-deployment/#1-use-specific-image-tags","title":"1. Use Specific Image Tags","text":"<p>Don't use <code>latest</code> in production: <pre><code>image: quay.io/sshaaf/keycloak-mcp-server:latest\n</code></pre></p> <p>Use specific git commit SHA or version: <pre><code>image: quay.io/sshaaf/keycloak-mcp-server:49ff54e\n</code></pre></p>"},{"location":"openshift-deployment/#2-resource-limits","title":"2. Resource Limits","text":"<p>Always set resource limits to prevent resource exhaustion:</p> <pre><code>resources:\n requests:\n memory: \"256Mi\"\n cpu: \"100m\"\n limits:\n memory: \"512Mi\"\n cpu: \"500m\"\n</code></pre>"},{"location":"openshift-deployment/#3-health-checks","title":"3. Health Checks","text":"<p>Include comprehensive health checks for reliability:</p> <pre><code>livenessProbe: ...\nreadinessProbe: ...\nstartupProbe: ...\n</code></pre>"},{"location":"openshift-deployment/#4-security","title":"4. Security","text":"<ul> <li>Run as non-root user</li> <li>Drop all capabilities</li> <li>Use read-only root filesystem where possible</li> <li>Implement network policies</li> <li>Use secrets for sensitive data</li> </ul>"},{"location":"openshift-deployment/#5-high-availability","title":"5. High Availability","text":"<ul> <li>Use multiple replicas (2-3 minimum)</li> <li>Configure pod disruption budgets</li> <li>Distribute across availability zones</li> </ul> <pre><code>spec:\n replicas: 3\n template:\n spec:\n affinity:\n podAntiAffinity:\n preferredDuringSchedulingIgnoredDuringExecution:\n - weight: 100\n podAffinityTerm:\n labelSelector:\n matchLabels:\n app: keycloak-mcp-server\n topologyKey: kubernetes.io/hostname\n</code></pre>"},{"location":"openshift-deployment/#summary","title":"Summary","text":"<p>Quick deployment with pre-configured manifests  Secure by default with non-root containers  Production-ready with health checks and resource limits  HTTPS configured for secure Keycloak communication  OpenShift native using Routes and SecurityContextConstraints  Flexible supporting multiple deployment methods  Scalable with horizontal pod autoscaling support</p>"},{"location":"openshift-deployment/#key-configuration-files","title":"Key Configuration Files","text":"File Purpose <code>deployment.yaml</code> Main application deployment with TLS support <code>service.yaml</code> ClusterIP service definition <code>route.yaml</code> OpenShift route for external access <code>configmap.yaml</code> Keycloak URL and OIDC client configuration <code>ca-configmap.yaml</code> CA certificate for self-signed Keycloak TLS <code>kustomization.yaml</code> Kustomize configuration keycloak-tls-setup.md Complete TLS/HTTPS configuration guide"},{"location":"openshift-deployment/#important-notes","title":"Important Notes","text":"<p>Production Keycloak uses HTTPS only - Configure TLS trust before deploying  Read keycloak-tls-setup.md for TLS configuration  Keycloak Operator: See installation tutorial Use specific image tags in production (not <code>latest</code>)</p> <p>Your Keycloak MCP Server is now ready for OpenShift!</p> <p>For issues or questions: - Check logs: <code>oc logs -f deployment/keycloak-mcp-server</code> - TLS issues: See keycloak-tls-setup.md - Keycloak setup: Tutorial</p>"},{"location":"parametric-collapse/","title":"Parametric Collapse Strategy Implementation","text":""},{"location":"parametric-collapse/#overview","title":"Overview","text":"<p>This project implements the \"Parametric Collapse\" strategy to consolidate multiple tool classes into a single, generic <code>KeycloakTool</code> class. This design pattern significantly reduces tool proliferation and improves API maintainability.</p>"},{"location":"parametric-collapse/#the-problem","title":"The Problem","text":"<p>Before the implementation, the project had 7+ separate tool classes: - <code>UserTool</code> (9 methods) - <code>RealmTool</code> (3 methods) - <code>ClientTool</code> (9 methods) - <code>RoleTool</code> (2 methods) - <code>GroupTool</code> (5 methods) - <code>IdentityProviderTool</code> (3 methods) - <code>AuthenticationTool</code> (6 methods)</p> <p>This resulted in 37+ individual tool methods exposed through the MCP protocol, creating a cluttered API surface.</p>"},{"location":"parametric-collapse/#the-solution","title":"The Solution","text":"<p>The new <code>KeycloakTool</code> class consolidates all operations into: - 1 unified tool method: <code>executeKeycloakOperation()</code> - 1 enum parameter: <code>KeycloakOperation</code> (45+ values) - 1 JSON parameter: <code>params</code> containing operation-specific arguments</p>"},{"location":"parametric-collapse/#architecture","title":"Architecture","text":"<pre><code> KeycloakTool\n (Single Unified Tool Class)\n\n + executeKeycloakOperation()\n - operation: KeycloakOperation\n - params: JSON\n\n\n Routes to appropriate service\n\n\n\n\n\n UserService RealmService ...etc\n</code></pre>"},{"location":"parametric-collapse/#benefits","title":"Benefits","text":"<ol> <li>Reduced Tool Count: From 37+ tools to 1 tool</li> <li>Better Maintainability: All routing logic in one place</li> <li>Consistent Error Handling: Centralized exception management</li> <li>Type Safety: Enum-based operation selection</li> <li>Flexible Parameters: JSON allows optional and complex parameters</li> <li>Easy Extension: Add new operations by adding enum values and cases</li> </ol>"},{"location":"parametric-collapse/#usage-examples","title":"Usage Examples","text":""},{"location":"parametric-collapse/#user-operations","title":"User Operations","text":""},{"location":"parametric-collapse/#get-all-users-in-a-realm","title":"Get all users in a realm","text":"<pre><code>{\n \"operation\": \"GET_USERS\",\n \"params\": {\n \"realm\": \"quarkus\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#create-a-new-user","title":"Create a new user","text":"<pre><code>{\n \"operation\": \"CREATE_USER\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"username\": \"jdoe\",\n \"firstName\": \"John\",\n \"lastName\": \"Doe\",\n \"email\": \"john.doe@example.com\",\n \"password\": \"SecurePass123!\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#add-role-to-user","title":"Add role to user","text":"<pre><code>{\n \"operation\": \"ADD_ROLE_TO_USER\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"userId\": \"1eed6a8e-a853-4597-b4c6-c4c2533546a0\",\n \"roleName\": \"admin\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#reset-user-password","title":"Reset user password","text":"<pre><code>{\n \"operation\": \"RESET_PASSWORD\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"userId\": \"1eed6a8e-a853-4597-b4c6-c4c2533546a0\",\n \"newPassword\": \"NewSecurePass456!\",\n \"temporary\": false\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#realm-operations","title":"Realm Operations","text":""},{"location":"parametric-collapse/#get-all-realms","title":"Get all realms","text":"<pre><code>{\n \"operation\": \"GET_REALMS\",\n \"params\": {}\n}\n</code></pre>"},{"location":"parametric-collapse/#create-a-realm","title":"Create a realm","text":"<pre><code>{\n \"operation\": \"CREATE_REALM\",\n \"params\": {\n \"realmName\": \"my-new-realm\",\n \"displayName\": \"My New Realm\",\n \"enabled\": true\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#client-operations","title":"Client Operations","text":""},{"location":"parametric-collapse/#get-all-clients","title":"Get all clients","text":"<pre><code>{\n \"operation\": \"GET_CLIENTS\",\n \"params\": {\n \"realm\": \"quarkus\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#create-a-client","title":"Create a client","text":"<pre><code>{\n \"operation\": \"CREATE_CLIENT\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"clientId\": \"my-app\",\n \"redirectUris\": \"http://localhost:8080/*\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#generate-new-client-secret","title":"Generate new client secret","text":"<pre><code>{\n \"operation\": \"GENERATE_CLIENT_SECRET\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"clientId\": \"my-app\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#group-operations","title":"Group Operations","text":""},{"location":"parametric-collapse/#get-all-groups","title":"Get all groups","text":"<pre><code>{\n \"operation\": \"GET_GROUPS\",\n \"params\": {\n \"realm\": \"quarkus\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#create-a-group","title":"Create a group","text":"<pre><code>{\n \"operation\": \"CREATE_GROUP\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"groupName\": \"Developers\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#create-a-subgroup","title":"Create a subgroup","text":"<pre><code>{\n \"operation\": \"CREATE_SUBGROUP\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"parentGroupId\": \"abc123\",\n \"subGroupName\": \"Backend Developers\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#authentication-operations","title":"Authentication Operations","text":""},{"location":"parametric-collapse/#get-authentication-flows","title":"Get authentication flows","text":"<pre><code>{\n \"operation\": \"GET_AUTHENTICATION_FLOWS\",\n \"params\": {\n \"realm\": \"quarkus\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#get-flow-executions","title":"Get flow executions","text":"<pre><code>{\n \"operation\": \"GET_FLOW_EXECUTIONS\",\n \"params\": {\n \"realm\": \"quarkus\",\n \"flowAlias\": \"browser\"\n }\n}\n</code></pre>"},{"location":"parametric-collapse/#complete-operation-list","title":"Complete Operation List","text":""},{"location":"parametric-collapse/#user-operations-15","title":"User Operations (15)","text":"<ul> <li><code>GET_USERS</code> - List all users in a realm</li> <li><code>GET_USER_BY_USERNAME</code> - Find a user by username</li> <li><code>GET_USER_BY_ID</code> - Get user by ID</li> <li><code>CREATE_USER</code> - Create a new user</li> <li><code>DELETE_USER</code> - Delete a user</li> <li><code>UPDATE_USER</code> - Update user details</li> <li><code>GET_USER_GROUPS</code> - Get groups for a user</li> <li><code>ADD_USER_TO_GROUP</code> - Add user to group</li> <li><code>REMOVE_USER_FROM_GROUP</code> - Remove user from group</li> <li><code>GET_USER_ROLES</code> - Get roles for a user</li> <li><code>ADD_ROLE_TO_USER</code> - Assign role to user</li> <li><code>REMOVE_ROLE_FROM_USER</code> - Remove role from user</li> <li><code>RESET_PASSWORD</code> - Reset user password</li> <li><code>SEND_VERIFICATION_EMAIL</code> - Send verification email</li> <li><code>COUNT_USERS</code> - Count users in realm</li> </ul>"},{"location":"parametric-collapse/#realm-operations-3","title":"Realm Operations (3)","text":"<ul> <li><code>GET_REALMS</code> - List all realms</li> <li><code>GET_REALM</code> - Get specific realm</li> <li><code>CREATE_REALM</code> - Create new realm</li> </ul>"},{"location":"parametric-collapse/#client-operations-8","title":"Client Operations (8)","text":"<ul> <li><code>GET_CLIENTS</code> - List all clients</li> <li><code>GET_CLIENT</code> - Get specific client</li> <li><code>CREATE_CLIENT</code> - Create new client</li> <li><code>DELETE_CLIENT</code> - Delete a client</li> <li><code>GENERATE_CLIENT_SECRET</code> - Generate new client secret</li> <li><code>GET_CLIENT_ROLES</code> - Get client roles</li> <li><code>CREATE_CLIENT_ROLE</code> - Create client role</li> <li><code>DELETE_CLIENT_ROLE</code> - Delete client role</li> </ul>"},{"location":"parametric-collapse/#role-operations-2","title":"Role Operations (2)","text":"<ul> <li><code>GET_REALM_ROLES</code> - List realm roles</li> <li><code>GET_REALM_ROLE</code> - Get specific realm role</li> </ul>"},{"location":"parametric-collapse/#group-operations-6","title":"Group Operations (6)","text":"<ul> <li><code>GET_GROUPS</code> - List all groups</li> <li><code>GET_GROUP_MEMBERS</code> - Get group members</li> <li><code>CREATE_GROUP</code> - Create new group</li> <li><code>UPDATE_GROUP</code> - Update group</li> <li><code>DELETE_GROUP</code> - Delete group</li> <li><code>CREATE_SUBGROUP</code> - Create subgroup</li> </ul>"},{"location":"parametric-collapse/#identity-provider-operations-3","title":"Identity Provider Operations (3)","text":"<ul> <li><code>GET_IDENTITY_PROVIDERS</code> - List identity providers</li> <li><code>GET_IDENTITY_PROVIDER</code> - Get specific identity provider</li> <li><code>GET_IDENTITY_PROVIDER_MAPPERS</code> - Get IDP mappers</li> </ul>"},{"location":"parametric-collapse/#authentication-operations-6","title":"Authentication Operations (6)","text":"<ul> <li><code>GET_AUTHENTICATION_FLOWS</code> - List authentication flows</li> <li><code>GET_AUTHENTICATION_FLOW</code> - Get specific flow</li> <li><code>CREATE_AUTHENTICATION_FLOW</code> - Create new flow</li> <li><code>DELETE_AUTHENTICATION_FLOW</code> - Delete flow</li> <li><code>GET_FLOW_EXECUTIONS</code> - Get flow executions</li> <li><code>UPDATE_FLOW_EXECUTION</code> - Update flow execution</li> </ul>"},{"location":"parametric-collapse/#implementation-details","title":"Implementation Details","text":""},{"location":"parametric-collapse/#service-layer","title":"Service Layer","text":"<p>The <code>KeycloakTool</code> directly injects and uses all service classes: - <code>UserService</code> - <code>RealmService</code> - <code>ClientService</code> - <code>RoleService</code> - <code>GroupService</code> - <code>IdentityProviderService</code> - <code>AuthenticationService</code></p>"},{"location":"parametric-collapse/#error-handling","title":"Error Handling","text":"<p>All operations are wrapped in try-catch blocks with: - Logging via <code>io.quarkus.logging.Log</code> - Consistent error messages via <code>ToolCallException</code> - Detailed error context including operation type</p>"},{"location":"parametric-collapse/#json-processing","title":"JSON Processing","text":"<p>Uses Jackson <code>ObjectMapper</code> for: - Parsing input parameters - Serializing return values - Converting JSON to Keycloak representation objects</p>"},{"location":"parametric-collapse/#migration-from-old-tools","title":"Migration from Old Tools","text":"<p>If you were using the old individual tool classes, here is how to migrate:</p>"},{"location":"parametric-collapse/#before-usertoolgetusers","title":"Before (UserTool.getUsers)","text":"<pre><code>@Tool(description = \"Get all users from a keycloak realm\")\nString getUsers(String realm)\n</code></pre>"},{"location":"parametric-collapse/#after-keycloaktool","title":"After (KeycloakTool)","text":"<pre><code>executeKeycloakOperation(\n KeycloakOperation.GET_USERS,\n \"{\\\"realm\\\": \\\"quarkus\\\"}\"\n)\n</code></pre>"},{"location":"parametric-collapse/#extending-the-tool","title":"Extending the Tool","text":"<p>To add a new operation:</p> <ol> <li> <p>Add enum value to <code>KeycloakOperation</code>: <pre><code>public enum KeycloakOperation {\n // ... existing operations\n MY_NEW_OPERATION\n}\n</code></pre></p> </li> <li> <p>Add case to switch statement in <code>executeKeycloakOperation()</code>: <pre><code>case MY_NEW_OPERATION:\n return myService.myNewMethod(\n paramsNode.get(\"param1\").asText(),\n paramsNode.get(\"param2\").asInt()\n );\n</code></pre></p> </li> <li> <p>Update tool description with the new operation name</p> </li> </ol>"},{"location":"parametric-collapse/#design-pattern-benefits","title":"Design Pattern Benefits","text":""},{"location":"parametric-collapse/#before-tool-explosion","title":"Before: Tool Explosion","text":"<pre><code>UserTool {\n getUsers()\n createUser()\n deleteUser()\n ...\n}\n\nClientTool {\n getClients()\n createClient()\n deleteClient()\n ...\n}\n\n// 7+ more tool classes...\n</code></pre>"},{"location":"parametric-collapse/#after-parametric-collapse","title":"After: Parametric Collapse","text":"<pre><code>KeycloakTool {\n executeKeycloakOperation(\n operation: KeycloakOperation,\n params: JSON\n )\n}\n</code></pre> <p>The AI model sees 1 tool definition instead of 37+ tool definitions, making it: - Easier to understand - Faster to process - Less prone to tool selection errors - More maintainable</p>"},{"location":"parametric-collapse/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Lazy Parameter Parsing: JSON is only parsed once per call</li> <li>Direct Service Delegation: No additional abstraction layers</li> <li>Minimal Overhead: Switch statement is O(1) with modern JVM optimization</li> <li>Same Memory Footprint: Services are still singletons</li> </ul>"},{"location":"parametric-collapse/#testing","title":"Testing","text":"<p>To test the implementation:</p> <pre><code># Compile the project\nmvn clean compile\n\n# Run tests\nmvn test\n\n# Build the native executable\nmvn package -Pnative\n</code></pre>"},{"location":"parametric-collapse/#conclusion","title":"Conclusion","text":"<p>The Parametric Collapse strategy successfully reduced the Keycloak MCP Server from 37+ individual tools to 1 unified tool, while maintaining all functionality and improving maintainability. This pattern can be applied to any domain where you have multiple similar operations that can be categorized and parameterized.</p>"},{"location":"port-configuration/","title":"Port Configuration Guide","text":""},{"location":"port-configuration/#overview","title":"Overview","text":"<p>The Keycloak MCP Server uses smart port assignment that automatically adapts to your deployment mode:</p> <ul> <li>Local Development (JAR/Native): Port <code>0</code> (random)</li> <li>Container (Docker/Kubernetes): Port <code>8080</code> (fixed)</li> </ul>"},{"location":"port-configuration/#why-this-strategy","title":"Why This Strategy?","text":""},{"location":"port-configuration/#port-0-for-local-development","title":"Port 0 for Local Development","text":"<p>Benefits: - No port conflicts with other services - Run multiple instances simultaneously - No need to manually manage ports - Perfect for CI/CD and automated tests</p> <p>How it works: When you set <code>quarkus.http.port=0</code>, the operating system automatically assigns an available port.</p>"},{"location":"port-configuration/#port-8080-for-containers","title":"Port 8080 for Containers","text":"<p>Benefits: - Predictable networking for Docker/Kubernetes - Easy port mapping (<code>-p 8080:8080</code>) - Standard HTTP alternative port - Works with load balancers and ingress</p>"},{"location":"port-configuration/#configuration","title":"Configuration","text":""},{"location":"port-configuration/#applicationproperties","title":"application.properties","text":"<pre><code># SSE Server Configuration\n# Port 0 = random port (avoids conflicts in local dev)\n# Overridden to 8080 in containers via QUARKUS_HTTP_PORT env var\nquarkus.http.port=0\nquarkus.http.host=0.0.0.0\n\n# Container configuration (Jib)\nquarkus.jib.ports=8080\nquarkus.jib.environment-variables.QUARKUS_HTTP_PORT=8080\n</code></pre>"},{"location":"port-configuration/#usage-examples","title":"Usage Examples","text":""},{"location":"port-configuration/#local-jar-execution","title":"Local JAR Execution","text":"<pre><code># Build\nmvn clean package\n\n# Run with random port\njava -jar target/quarkus-app/quarkus-run.jar\n\n# Output shows assigned port:\n# __ ____ __ _____ ___ __ ____ ______\n# --/ __ \\/ / / / _ | / _ \\/ //_/ / / / __/\n# -/ /_/ / /_/ / __ |/ , _/ ,&lt; / /_/ /\\ \\\n# --\\___\\_\\____/_/ |_/_/|_/_/|_|\\____/___/\n# Listening on: http://0.0.0.0:54321 \u2190 Random port assigned\n</code></pre> <p>Finding the assigned port: <pre><code># From logs\ngrep \"Listening on:\" server.log\n\n# Or use lsof\nlsof -i -P | grep java\n</code></pre></p>"},{"location":"port-configuration/#override-port-locally","title":"Override Port Locally","text":"<p>If you need a specific port for local development:</p> <pre><code># Option 1: System property\njava -Dquarkus.http.port=8080 -jar target/quarkus-app/quarkus-run.jar\n\n# Option 2: Environment variable\nexport QUARKUS_HTTP_PORT=8080\njava -jar target/quarkus-app/quarkus-run.jar\n\n# Option 3: Command line for Quarkus dev mode\nmvn quarkus:dev -Dquarkus.http.port=8080\n</code></pre>"},{"location":"port-configuration/#native-binary-execution","title":"Native Binary Execution","text":"<pre><code># Build native\nmvn clean package -Pnative\n\n# Run with random port\n./target/keycloak-mcp-server-0.3.0-runner\n\n# Override port\nQUARKUS_HTTP_PORT=8080 ./target/keycloak-mcp-server-0.3.0-runner\n</code></pre>"},{"location":"port-configuration/#container-execution","title":"Container Execution","text":"<p>The container automatically uses port 8080 via environment variable:</p> <pre><code># Run container (port 8080 is automatic)\ndocker run -d \\\n -p 8080:8080 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n -e KC_USER=admin \\\n -e KC_PASSWORD=admin \\\n quay.io/sshaaf/keycloak-mcp-server:latest\n\n# Access SSE endpoint\ncurl http://localhost:8080/mcp/sse\n</code></pre>"},{"location":"port-configuration/#override-container-port","title":"Override Container Port","text":"<p>You can override the container port if needed:</p> <pre><code># Use different port in container\ndocker run -d \\\n -p 9090:9090 \\\n -e QUARKUS_HTTP_PORT=9090 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n -e KC_USER=admin \\\n -e KC_PASSWORD=admin \\\n quay.io/sshaaf/keycloak-mcp-server:latest\n\n# Access on custom port\ncurl http://localhost:9090/mcp/sse\n</code></pre>"},{"location":"port-configuration/#kubernetesopenshift-deployment","title":"Kubernetes/OpenShift Deployment","text":""},{"location":"port-configuration/#standard-deployment-port-8080","title":"Standard Deployment (Port 8080)","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n name: keycloak-mcp-server\nspec:\n replicas: 1\n selector:\n matchLabels:\n app: keycloak-mcp-server\n template:\n metadata:\n labels:\n app: keycloak-mcp-server\n spec:\n containers:\n - name: server\n image: quay.io/sshaaf/keycloak-mcp-server:latest\n ports:\n - containerPort: 8080\n name: http\n env:\n - name: KC_URL\n value: \"http://keycloak:8080\"\n - name: KC_USER\n value: \"admin\"\n - name: KC_PASSWORD\n valueFrom:\n secretKeyRef:\n name: keycloak-admin\n key: password\n---\napiVersion: v1\nkind: Service\nmetadata:\n name: keycloak-mcp-server\nspec:\n selector:\n app: keycloak-mcp-server\n ports:\n - name: http\n port: 80\n targetPort: 8080\n type: LoadBalancer\n</code></pre>"},{"location":"port-configuration/#custom-port-deployment","title":"Custom Port Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n name: keycloak-mcp-server\nspec:\n template:\n spec:\n containers:\n - name: server\n image: quay.io/sshaaf/keycloak-mcp-server:latest\n ports:\n - containerPort: 9090\n name: http\n env:\n - name: QUARKUS_HTTP_PORT\n value: \"9090\"\n - name: KC_URL\n value: \"http://keycloak:8080\"\n</code></pre>"},{"location":"port-configuration/#development-workflow","title":"Development Workflow","text":""},{"location":"port-configuration/#single-instance-development","title":"Single Instance Development","text":"<pre><code># Just run - port assigned automatically\njava -jar target/quarkus-app/quarkus-run.jar\n\n# Check logs for actual port\n# Listening on: http://0.0.0.0:54321\n</code></pre>"},{"location":"port-configuration/#multiple-instances-testing-load-balancing","title":"Multiple Instances (Testing, Load Balancing)","text":"<pre><code># Terminal 1 - First instance\njava -jar target/quarkus-app/quarkus-run.jar\n# Listening on: http://0.0.0.0:54321\n\n# Terminal 2 - Second instance (different port automatically)\njava -jar target/quarkus-app/quarkus-run.jar\n# Listening on: http://0.0.0.0:54322\n\n# Terminal 3 - Third instance\njava -jar target/quarkus-app/quarkus-run.jar\n# Listening on: http://0.0.0.0:54323\n</code></pre> <p>No port conflicts! Each instance gets its own port automatically.</p>"},{"location":"port-configuration/#cicd-testing","title":"CI/CD Testing","text":"<pre><code># In CI pipeline - no need to manage ports\nfor i in {1..10}; do\n java -jar target/quarkus-app/quarkus-run.jar &amp;\ndone\n\n# All 10 instances run simultaneously without conflicts\n</code></pre>"},{"location":"port-configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"port-configuration/#issue-cant-find-the-assigned-port","title":"Issue: Can't Find the Assigned Port","text":"<p>Solution: Check the startup logs:</p> <pre><code># Run and capture logs\njava -jar target/quarkus-app/quarkus-run.jar 2&gt;&amp;1 | tee server.log\n\n# Or grep for the port\njava -jar target/quarkus-app/quarkus-run.jar 2&gt;&amp;1 | grep \"Listening on\"\n</code></pre>"},{"location":"port-configuration/#issue-want-fixed-port-for-local-development","title":"Issue: Want Fixed Port for Local Development","text":"<p>Solution: Override with environment variable:</p> <pre><code># Add to your shell profile (~/.bashrc, ~/.zshrc, etc.)\nexport QUARKUS_HTTP_PORT=8080\n\n# Or create a .env file\necho \"QUARKUS_HTTP_PORT=8080\" &gt; .env\nsource .env\njava -jar target/quarkus-app/quarkus-run.jar\n</code></pre>"},{"location":"port-configuration/#issue-container-not-responding-on-port-8080","title":"Issue: Container Not Responding on Port 8080","text":"<p>Check: 1. Verify port mapping: <code>docker ps</code> shows <code>0.0.0.0:8080-&gt;8080/tcp</code> 2. Check container logs: <code>docker logs &lt;container-id&gt;</code> 3. Verify environment variable: <code>docker exec &lt;container-id&gt; env | grep QUARKUS_HTTP_PORT</code></p> <p>Solution: <pre><code># Ensure port mapping is correct\ndocker run -p 8080:8080 quay.io/sshaaf/keycloak-mcp-server:latest\n\n# Verify container is listening\ndocker exec &lt;container-id&gt; netstat -tlnp | grep 8080\n</code></pre></p>"},{"location":"port-configuration/#issue-port-already-in-use-local-override","title":"Issue: Port Already in Use (Local Override)","text":"<p>Solution: <pre><code># Find what is using the port\nlsof -i :8080\n\n# Use a different port\nQUARKUS_HTTP_PORT=9090 java -jar target/quarkus-app/quarkus-run.jar\n\n# Or use port 0 (default - random port)\nunset QUARKUS_HTTP_PORT\njava -jar target/quarkus-app/quarkus-run.jar\n</code></pre></p>"},{"location":"port-configuration/#port-discovery-in-code","title":"Port Discovery in Code","text":"<p>If you need to programmatically discover the assigned port:</p>"},{"location":"port-configuration/#java-code","title":"Java Code","text":"<pre><code>import io.quarkus.runtime.StartupEvent;\nimport jakarta.enterprise.event.Observes;\nimport org.eclipse.microprofile.config.inject.ConfigProperty;\nimport io.quarkus.logging.Log;\n\npublic class PortDiscovery {\n\n @ConfigProperty(name = \"quarkus.http.port\")\n int httpPort;\n\n void onStart(@Observes StartupEvent ev) {\n Log.info(\"Server started on port: \" + httpPort);\n }\n}\n</code></pre>"},{"location":"port-configuration/#shell-script","title":"Shell Script","text":"<pre><code>#!/bin/bash\n\n# Start server in background\njava -jar target/quarkus-app/quarkus-run.jar &gt; server.log 2&gt;&amp;1 &amp;\nPID=$!\n\n# Wait for startup\nsleep 5\n\n# Extract port from logs\nPORT=$(grep \"Listening on:\" server.log | grep -oP 'http://[^:]+:\\K\\d+')\n\necho \"Server running on port: $PORT\"\necho \"SSE endpoint: http://localhost:$PORT/mcp/sse\"\n\n# Use the port\ncurl \"http://localhost:$PORT/mcp/sse\"\n</code></pre>"},{"location":"port-configuration/#summary","title":"Summary","text":"Scenario Configuration Port Local JAR/Native Default Random (0) Local with override <code>QUARKUS_HTTP_PORT=8080</code> 8080 Container (default) Automatic via Jib 8080 Container (custom) <code>-e QUARKUS_HTTP_PORT=9090</code> 9090 Kubernetes/OpenShift Default 8080 Multiple local instances Default Random (each different)"},{"location":"port-configuration/#benefits-summary","title":"Benefits Summary","text":"<p>No Port Conflicts: Random ports eliminate conflicts in local development  Parallel Testing: Run multiple instances simultaneously  Container-Friendly: Fixed port 8080 for predictable networking  Flexible: Easy to override when needed  CI/CD Ready: No port management in automated pipelines  Production Ready: Fixed ports for containers and cloud deployments</p> <p>Default Behavior: - Local: Port <code>0</code> (random) - perfect for development - Container: Port <code>8080</code> (fixed) - perfect for deployment</p> <p>The best of both worlds!</p>"},{"location":"scripts-guide/","title":"Keycloak MCP Server Scripts","text":"<p>This directory contains helper scripts for managing the Keycloak MCP Server.</p>"},{"location":"scripts-guide/#available-scripts","title":"Available Scripts","text":""},{"location":"scripts-guide/#get-mcp-tokensh","title":"<code>get-mcp-token.sh</code>","text":"<p>Helper script for obtaining JWT tokens from Keycloak and generating Cursor MCP configuration.</p> <p>Features: - Authenticates with Keycloak - Retrieves JWT token for the user - Generates Cursor MCP configuration - Shows token expiration time - Displays user roles and permissions</p> <p>Prerequisites: - <code>curl</code> command installed - <code>jq</code> command installed (JSON processor) - Keycloak user credentials</p> <p>Usage:</p> <pre><code># Basic usage\n./get-mcp-token.sh \\\n --keycloak-url https://keycloak.example.com \\\n --username your-username \\\n --password your-password\n\n# With custom realm and MCP URL\n./get-mcp-token.sh \\\n --keycloak-url https://keycloak.example.com \\\n --realm master \\\n --username your-username \\\n --password your-password \\\n --mcp-url https://mcp-server.example.com/mcp/sse\n\n# Show help\n./get-mcp-token.sh --help\n</code></pre> <p>Options:</p> Option Description Required Default <code>--keycloak-url</code> Keycloak server URL Yes - <code>--username</code> Your Keycloak username Yes - <code>--password</code> Your Keycloak password Yes - <code>--realm</code> Keycloak realm No <code>master</code> <code>--mcp-url</code> MCP server URL No <code>http://localhost:8080/mcp/sse</code> <code>--help</code> Display help message No - <p>Output:</p> <p>The script will: 1. Authenticate with Keycloak using your credentials 2. Retrieve your JWT token 3. Generate Cursor MCP configuration 4. Show token expiration time 5. Display your realm roles</p> <p>Example Output:</p> <pre><code> Token obtained successfully!\n\nToken expires in: 300 seconds (5 minutes)\n\n Cursor MCP Configuration:\n{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"https://mcp-server.example.com/mcp/sse\",\n \"headers\": {\n \"Authorization\": \"Bearer eyJhbGciOiJS...\"\n }\n }\n }\n}\n\n To use:\n1. Copy the configuration above\n2. Update ~/.cursor/mcp.json\n3. Reload MCP servers in Cursor (Cmd+Shift+P \u2192 \"Reload MCP Servers\")\n</code></pre>"},{"location":"scripts-guide/#installing-dependencies","title":"Installing Dependencies","text":""},{"location":"scripts-guide/#macos-homebrew","title":"macOS (Homebrew)","text":"<pre><code>brew install curl jq\n</code></pre>"},{"location":"scripts-guide/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>sudo apt-get install curl jq\n</code></pre>"},{"location":"scripts-guide/#rhelcentosfedora","title":"RHEL/CentOS/Fedora","text":"<pre><code>sudo dnf install curl jq\n</code></pre>"},{"location":"scripts-guide/#windows-wsl","title":"Windows (WSL)","text":"<pre><code>sudo apt-get install curl jq\n</code></pre>"},{"location":"scripts-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"scripts-guide/#jq-command-not-found","title":"<code>jq: command not found</code>","text":"<p>Install <code>jq</code> using your package manager (see above).</p>"},{"location":"scripts-guide/#curl-command-not-found","title":"<code>curl: command not found</code>","text":"<p>Install <code>curl</code> using your package manager (see above).</p>"},{"location":"scripts-guide/#authentication-failed","title":"Authentication Failed","text":"<ul> <li>Verify your Keycloak URL is correct and accessible</li> <li>Check admin username and password</li> <li>Ensure your admin user has sufficient permissions</li> </ul>"},{"location":"scripts-guide/#client-already-exists","title":"Client Already Exists","text":"<p>The script will update the existing client configuration. This is safe and ensures the client has the correct settings.</p>"},{"location":"scripts-guide/#network-timeout","title":"Network Timeout","text":"<ul> <li>Check your network connection</li> <li>Verify Keycloak server is accessible</li> <li>Try increasing timeout by modifying the curl commands in the script</li> </ul>"},{"location":"scripts-guide/#security-considerations","title":"Security Considerations","text":"<p>Important Security Notes:</p> <ol> <li>Never commit JWT tokens to version control</li> <li>Tokens expire - Refresh them regularly (typically 5-60 minutes)</li> <li>Use strong passwords for your Keycloak account</li> <li>Each user has their own token - Don't share tokens between users</li> <li>Monitor your account activity in Keycloak audit logs</li> </ol>"},{"location":"scripts-guide/#contributing","title":"Contributing","text":"<p>If you find issues or have suggestions for improving these scripts, please:</p> <ol> <li>Open an issue on GitHub</li> <li>Submit a pull request</li> <li>Discuss in the Keycloak Discourse</li> </ol>"},{"location":"scripts-guide/#license","title":"License","text":"<p>These scripts are part of the Keycloak MCP Server project and are licensed under the same license (MIT).</p>"},{"location":"sse-migration-guide/","title":"SSE Migration Guide","text":""},{"location":"sse-migration-guide/#overview","title":"Overview","text":"<p>The Keycloak MCP Server has been migrated from stdin/stdout communication to SSE (Server-Sent Events) transport. This enables HTTP-based communication and makes the server accessible via web browsers and HTTP clients.</p>"},{"location":"sse-migration-guide/#version","title":"Version","text":"<p>v0.3.0 - SSE-enabled version</p>"},{"location":"sse-migration-guide/#what-changed","title":"What Changed","text":""},{"location":"sse-migration-guide/#1-dependency-changes","title":"1. Dependency Changes","text":"<p>Before (v0.2.0 - stdin): <pre><code>&lt;dependency&gt;\n &lt;groupId&gt;io.quarkiverse.mcp&lt;/groupId&gt;\n &lt;artifactId&gt;quarkus-mcp-server-stdio&lt;/artifactId&gt;\n &lt;version&gt;1.4.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p> <p>After (v0.3.0 - SSE): <pre><code>&lt;dependency&gt;\n &lt;groupId&gt;io.quarkiverse.mcp&lt;/groupId&gt;\n &lt;artifactId&gt;quarkus-mcp-server-sse&lt;/artifactId&gt;\n &lt;version&gt;1.4.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p>"},{"location":"sse-migration-guide/#2-configuration-changes","title":"2. Configuration Changes","text":"<p>application.properties:</p> <pre><code># SSE Server Configuration\n# Port 0 = random port for local dev (avoids conflicts)\n# Containers override this to 8080 via QUARKUS_HTTP_PORT env var\nquarkus.http.port=0\nquarkus.http.host=0.0.0.0\n\n# CORS Configuration for browser access\nquarkus.http.cors=true\nquarkus.http.cors.origins=*\nquarkus.http.cors.methods=GET,POST,OPTIONS\n\n# MCP SSE Configuration (enabled by default with quarkus-mcp-server-sse)\n# Default endpoint: /mcp/sse\n</code></pre> <p>Smart Port Assignment: - Local (JAR/Native): Uses port <code>0</code> (random available port) to avoid conflicts - Container: Automatically uses port <code>8080</code> (fixed port for networking)</p>"},{"location":"sse-migration-guide/#3-tool-classes","title":"3. Tool Classes","text":"<p>NO CHANGES REQUIRED - All tool classes including the unified <code>KeycloakTool</code> work exactly the same!</p>"},{"location":"sse-migration-guide/#how-to-use","title":"How to Use","text":""},{"location":"sse-migration-guide/#starting-the-server","title":"Starting the Server","text":""},{"location":"sse-migration-guide/#development-mode","title":"Development Mode","text":"<pre><code>./mvnw quarkus:dev\n</code></pre>"},{"location":"sse-migration-guide/#production-mode","title":"Production Mode","text":"<pre><code># Build\n./mvnw package\n\n# Run\njava -jar target/quarkus-app/quarkus-run.jar\n</code></pre>"},{"location":"sse-migration-guide/#using-the-uber-jar","title":"Using the Uber JAR","text":"<pre><code># Build\n./mvnw package -Dquarkus.package.jar.type=uber-jar\n\n# Run\njava -jar target/keycloak-mcp-server-0.3.0-runner.jar\n</code></pre>"},{"location":"sse-migration-guide/#server-endpoints","title":"Server Endpoints","text":"<p>Once started, the server will be available at:</p> <ul> <li>MCP SSE Endpoint: <code>http://localhost:8080/mcp/sse</code></li> <li>Health Check: <code>http://localhost:8080/q/health</code></li> <li>Metrics: <code>http://localhost:8080/q/metrics</code></li> </ul>"},{"location":"sse-migration-guide/#connecting-to-the-sse-server","title":"Connecting to the SSE Server","text":""},{"location":"sse-migration-guide/#using-mcp-client-libraries","title":"Using MCP Client Libraries","text":"<pre><code>// Example using MCP SDK\nimport { Client } from \"@modelcontextprotocol/sdk/client/index.js\";\nimport { SSEClientTransport } from \"@modelcontextprotocol/sdk/client/sse.js\";\n\nconst transport = new SSEClientTransport(\n new URL(\"http://localhost:8080/mcp/sse\")\n);\n\nconst client = new Client({\n name: \"keycloak-client\",\n version: \"1.0.0\",\n}, {\n capabilities: {}\n});\n\nawait client.connect(transport);\n\n// List available tools\nconst tools = await client.listTools();\nconsole.log(\"Available tools:\", tools);\n\n// Call a tool\nconst result = await client.callTool({\n name: \"executeKeycloakOperation\",\n arguments: {\n operation: \"GET_USERS\",\n params: JSON.stringify({ realm: \"quarkus\" })\n }\n});\n</code></pre>"},{"location":"sse-migration-guide/#using-curl","title":"Using curl","text":"<pre><code># Test the SSE endpoint\ncurl -N -H \"Accept: text/event-stream\" http://localhost:8080/mcp/sse\n\n# List tools (requires MCP protocol handshake)\ncurl -X POST http://localhost:8080/mcp/sse \\\n -H \"Content-Type: application/json\" \\\n -d '{\n \"jsonrpc\": \"2.0\",\n \"id\": 1,\n \"method\": \"tools/list\"\n }'\n</code></pre>"},{"location":"sse-migration-guide/#using-browser","title":"Using Browser","text":"<p>You can connect to the SSE server directly from a web browser:</p> <pre><code>const eventSource = new EventSource('http://localhost:8080/mcp/sse');\n\neventSource.onmessage = (event) =&gt; {\n console.log('Received:', event.data);\n};\n\neventSource.onerror = (error) =&gt; {\n console.error('SSE Error:', error);\n};\n</code></pre>"},{"location":"sse-migration-guide/#client-configuration-examples","title":"Client Configuration Examples","text":""},{"location":"sse-migration-guide/#claude-desktop-mcp-config","title":"Claude Desktop (MCP Config)","text":"<p>Update your <code>~/.config/claude-desktop/mcp.json</code> or <code>~/Library/Application Support/Claude/claude_desktop_config.json</code>:</p> <pre><code>{\n \"mcpServers\": {\n \"keycloak\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\",\n \"env\": {\n \"KC_URL\": \"http://localhost:8180\",\n \"KC_USER\": \"admin\",\n \"KC_PASSWORD\": \"admin\"\n }\n }\n }\n}\n</code></pre>"},{"location":"sse-migration-guide/#cursor-ide-mcp-config","title":"Cursor IDE (MCP Config)","text":"<p>Update your <code>~/.cursor/mcp.json</code>:</p> <pre><code>{\n \"mcpServers\": {\n \"keycloak-mcp-server\": {\n \"transport\": \"sse\",\n \"url\": \"http://localhost:8080/mcp/sse\",\n \"env\": {\n \"KC_URL\": \"http://localhost:8180\",\n \"KC_USER\": \"admin\",\n \"KC_PASSWORD\": \"admin\"\n }\n }\n }\n}\n</code></pre>"},{"location":"sse-migration-guide/#advantages-of-sse-over-stdin","title":"Advantages of SSE over stdin","text":""},{"location":"sse-migration-guide/#1-http-based-communication","title":"1. HTTP-Based Communication","text":"<ul> <li>Standard HTTP protocol</li> <li>Works through firewalls and proxies</li> <li>Easy to monitor with standard HTTP tools</li> </ul>"},{"location":"sse-migration-guide/#2-browser-accessibility","title":"2. Browser Accessibility","text":"<ul> <li>Can be accessed directly from web browsers</li> <li>Enables web-based MCP clients</li> <li>Real-time updates via Server-Sent Events</li> </ul>"},{"location":"sse-migration-guide/#3-network-distribution","title":"3. Network Distribution","text":"<ul> <li>Server can run on different machines</li> <li>Multiple clients can connect simultaneously</li> <li>Better for microservices architectures</li> </ul>"},{"location":"sse-migration-guide/#4-development-debugging","title":"4. Development &amp; Debugging","text":"<ul> <li>Easier to test with curl/Postman</li> <li>Better logging and monitoring</li> <li>Health checks and metrics endpoints</li> </ul>"},{"location":"sse-migration-guide/#5-production-ready","title":"5. Production Ready","text":"<ul> <li>Can be deployed behind load balancers</li> <li>Kubernetes/OpenShift friendly</li> <li>Better observability</li> </ul>"},{"location":"sse-migration-guide/#environment-variables","title":"Environment Variables","text":"<p>The server still requires Keycloak connection details via environment variables:</p> <pre><code>export KC_URL=http://localhost:8180\nexport KC_USER=admin\nexport KC_PASSWORD=admin\n</code></pre> <p>Or pass them when starting:</p> <pre><code>KC_URL=http://localhost:8180 \\\nKC_USER=admin \\\nKC_PASSWORD=admin \\\njava -jar target/quarkus-app/quarkus-run.jar\n</code></pre>"},{"location":"sse-migration-guide/#docker-deployment","title":"Docker Deployment","text":""},{"location":"sse-migration-guide/#build-docker-image","title":"Build Docker Image","text":"<pre><code># JVM mode\n./mvnw package\ndocker build -f src/main/docker/Dockerfile.jvm -t keycloak-mcp-server:0.3.0 .\n\n# Native mode (requires GraalVM)\n./mvnw package -Pnative\ndocker build -f src/main/docker/Dockerfile.native -t keycloak-mcp-server:0.3.0-native .\n</code></pre>"},{"location":"sse-migration-guide/#run-docker-container","title":"Run Docker Container","text":"<pre><code>docker run -d \\\n -p 8080:8080 \\\n -e KC_URL=http://host.docker.internal:8180 \\\n -e KC_USER=admin \\\n -e KC_PASSWORD=admin \\\n --name keycloak-mcp \\\n keycloak-mcp-server:0.3.0\n</code></pre>"},{"location":"sse-migration-guide/#kubernetesopenshift-deployment","title":"Kubernetes/OpenShift Deployment","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n name: keycloak-mcp-server\nspec:\n replicas: 1\n selector:\n matchLabels:\n app: keycloak-mcp-server\n template:\n metadata:\n labels:\n app: keycloak-mcp-server\n spec:\n containers:\n - name: server\n image: keycloak-mcp-server:0.3.0\n ports:\n - containerPort: 8080\n name: http\n env:\n - name: KC_URL\n value: \"http://keycloak:8080\"\n - name: KC_USER\n valueFrom:\n secretKeyRef:\n name: keycloak-admin\n key: username\n - name: KC_PASSWORD\n valueFrom:\n secretKeyRef:\n name: keycloak-admin\n key: password\n---\napiVersion: v1\nkind: Service\nmetadata:\n name: keycloak-mcp-server\nspec:\n selector:\n app: keycloak-mcp-server\n ports:\n - port: 8080\n targetPort: 8080\n name: http\n</code></pre>"},{"location":"sse-migration-guide/#security-considerations","title":"Security Considerations","text":""},{"location":"sse-migration-guide/#cors-configuration","title":"CORS Configuration","text":"<p>The default configuration allows all origins (<code>*</code>). For production, restrict this:</p> <pre><code>quarkus.http.cors.origins=https://yourdomain.com,https://app.yourdomain.com\n</code></pre>"},{"location":"sse-migration-guide/#authentication","title":"Authentication","text":"<p>Consider adding authentication for production deployments:</p> <pre><code># Example: Basic Auth\nquarkus.http.auth.basic=true\n</code></pre> <p>Or use OAuth2/OIDC with Keycloak itself:</p> <pre><code>quarkus.oidc.auth-server-url=http://localhost:8180/realms/master\nquarkus.oidc.client-id=mcp-server\nquarkus.oidc.credentials.secret=secret\n</code></pre>"},{"location":"sse-migration-guide/#tlshttps","title":"TLS/HTTPS","text":"<p>For production, enable HTTPS:</p> <pre><code>quarkus.http.ssl.certificate.file=/path/to/certificate.pem\nquarkus.http.ssl.certificate.key-file=/path/to/key.pem\nquarkus.http.ssl-port=8443\n</code></pre>"},{"location":"sse-migration-guide/#monitoring","title":"Monitoring","text":""},{"location":"sse-migration-guide/#health-checks","title":"Health Checks","text":"<pre><code># Liveness\ncurl http://localhost:8080/q/health/live\n\n# Readiness\ncurl http://localhost:8080/q/health/ready\n</code></pre>"},{"location":"sse-migration-guide/#metrics","title":"Metrics","text":"<pre><code># Prometheus metrics\ncurl http://localhost:8080/q/metrics\n</code></pre>"},{"location":"sse-migration-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"sse-migration-guide/#server-wont-start","title":"Server Won't Start","text":"<p>Check if port 8080 is already in use: <pre><code>lsof -i :8080\n</code></pre></p> <p>Change the port in <code>application.properties</code>: <pre><code>quarkus.http.port=8081\n</code></pre></p>"},{"location":"sse-migration-guide/#cors-errors","title":"CORS Errors","text":"<p>If you see CORS errors in browser console, ensure CORS is properly configured in <code>application.properties</code>.</p>"},{"location":"sse-migration-guide/#connection-refused","title":"Connection Refused","text":"<p>Ensure: 1. Server is running: <code>curl http://localhost:8080/q/health</code> 2. Keycloak is accessible: <code>curl $KC_URL</code> 3. Environment variables are set correctly</p>"},{"location":"sse-migration-guide/#migration-checklist","title":"Migration Checklist","text":"<ul> <li>[x] Replace <code>quarkus-mcp-server-stdio</code> with <code>quarkus-mcp-server-sse</code></li> <li>[x] Update <code>application.properties</code> with SSE configuration</li> <li>[x] Add CORS configuration</li> <li>[x] Update version to 0.3.0</li> <li>[x] Test compilation</li> <li>[ ] Update client configurations (Claude Desktop, Cursor, etc.)</li> <li>[ ] Test SSE endpoint connectivity</li> <li>[ ] Update deployment scripts/documentation</li> <li>[ ] Configure production security settings</li> </ul>"},{"location":"sse-migration-guide/#backward-compatibility","title":"Backward Compatibility","text":"<p>The tool interface remains exactly the same. All 46 operations (including SEARCH_DISCOURSE) work identically via SSE as they did with stdin.</p>"},{"location":"sse-migration-guide/#summary","title":"Summary","text":"<p>Converted from: stdin/stdout MCP server (v0.2.0)  Converted to: SSE HTTP-based MCP server (v0.3.0)  Port: 8080 (configurable)  Endpoint: <code>/mcp/sse</code> All 46 operations: Fully functional  Parametric Collapse pattern: Maintained</p> <p>Status: Ready for HTTP/SSE communication</p>"},{"location":"version-automation/","title":"Automatic Version Management from pom.xml","text":""},{"location":"version-automation/#overview","title":"Overview","text":"<p>The GitHub Actions workflows now automatically extract the version from <code>pom.xml</code> instead of using hardcoded values. This ensures the release version is always in sync with your Maven project.</p>"},{"location":"version-automation/#what-changed","title":"What Changed","text":""},{"location":"version-automation/#before-hardcoded","title":"Before (Hardcoded)","text":"<pre><code>env:\n APP_VERSION: '0.2.0' # Manual update required\n</code></pre> <p>Problems: - Had to update workflow file manually when version changes - Could get out of sync with pom.xml - Easy to forget to update - Version existed in two places</p>"},{"location":"version-automation/#after-automatic","title":"After (Automatic)","text":"<pre><code>env:\n # APP_VERSION is automatically extracted from pom.xml in each job\n\nsteps:\n - name: Extract Version from POM\n id: get-version\n run: |\n VERSION=$(mvn help:evaluate -Dexpression=project.version -q -DforceStdout)\n echo \"version=$VERSION\" &gt;&gt; $GITHUB_OUTPUT\n echo \"Extracted version from pom.xml: $VERSION\"\n\n - name: Prepare release assets\n env:\n APP_VERSION: ${{ steps.get-version.outputs.version }}\n run: |\n # Uses dynamic version from pom.xml\n mv artifacts/runner-jar/${{ env.APP_NAME }}-${{ env.APP_VERSION }}-runner.jar ...\n</code></pre> <p>Benefits: - Single source of truth (pom.xml) - Always in sync - No manual updates needed - Version bumps automatically flow to CI/CD</p>"},{"location":"version-automation/#how-it-works","title":"How It Works","text":""},{"location":"version-automation/#maven-command","title":"Maven Command","text":"<p>The workflow uses Maven's <code>help:evaluate</code> goal to extract the version:</p> <pre><code>mvn help:evaluate -Dexpression=project.version -q -DforceStdout\n</code></pre> <p>Flags explained: - <code>-Dexpression=project.version</code> - Extract the project version - <code>-q</code> - Quiet mode (minimal output) - <code>-DforceStdout</code> - Force output to stdout (no log formatting)</p> <p>Example output: <pre><code>0.3.0\n</code></pre></p>"},{"location":"version-automation/#workflow-steps","title":"Workflow Steps","text":"<ol> <li>Checkout code - Get the repository including <code>pom.xml</code></li> <li>Set up JDK - Required to run Maven commands</li> <li>Extract version - Run Maven command and save to output</li> <li>Use version - Reference the extracted version in subsequent steps</li> </ol>"},{"location":"version-automation/#where-its-used","title":"Where It's Used","text":""},{"location":"version-automation/#releaseyml-release-workflow","title":"<code>release.yml</code> - Release Workflow","text":"<p>The version is extracted in the <code>release</code> job and used to: - Name release artifacts - Tag container images - Create GitHub releases</p> <pre><code>mv artifacts/runner-jar/keycloak-mcp-server-0.3.0-runner.jar ...\n \u2191 From pom.xml\n</code></pre>"},{"location":"version-automation/#build-artifactsyml-build-and-push-workflow","title":"<code>build-artifacts.yml</code> - Build and Push Workflow","text":"<p>The version is extracted in the <code>build-and-push-container</code> job and used to: - Tag container images with semantic version</p> <pre><code>-Dquarkus.container-image.additional-tags=0.3.0,latest\n \u2191 From pom.xml\n</code></pre>"},{"location":"version-automation/#example-version-bump-workflow","title":"Example: Version Bump Workflow","text":""},{"location":"version-automation/#1-update-version-in-pomxml","title":"1. Update Version in pom.xml","text":"<pre><code>&lt;project&gt;\n &lt;groupId&gt;dev.shaaf.keycloak.mcp.server&lt;/groupId&gt;\n &lt;artifactId&gt;keycloak-mcp-server&lt;/artifactId&gt;\n &lt;version&gt;0.4.0&lt;/version&gt; &lt;!-- Only place to update --&gt;\n ...\n&lt;/project&gt;\n</code></pre>"},{"location":"version-automation/#2-commit-and-push","title":"2. Commit and Push","text":"<pre><code>git add pom.xml\ngit commit -m \"chore: bump version to 0.4.0\"\ngit push origin main\n</code></pre>"},{"location":"version-automation/#3-trigger-release","title":"3. Trigger Release","text":"<p>Manually trigger the release workflow from GitHub Actions UI.</p>"},{"location":"version-automation/#4-automatic-results","title":"4. Automatic Results","text":"<p>Container images created: - <code>quay.io/sshaaf/keycloak-mcp-server:49ff54e</code> (git SHA) - <code>quay.io/sshaaf/keycloak-mcp-server:0.4.0</code> (from pom.xml) - <code>quay.io/sshaaf/keycloak-mcp-server:latest</code></p> <p>Release artifacts named: - <code>keycloak-mcp-server-0.4.0-runner.jar</code> (from pom.xml) - <code>keycloak-mcp-server-0.4.0-linux</code> (from pom.xml) - <code>keycloak-mcp-server-0.4.0-macos</code> (from pom.xml) - <code>keycloak-mcp-server-0.4.0-windows.exe</code> (from pom.xml)</p> <p>GitHub Release: - Tag: <code>v0.4.0</code> (from pom.xml) - Title: <code>Release v0.4.0</code> (from pom.xml)</p>"},{"location":"version-automation/#benefits","title":"Benefits","text":""},{"location":"version-automation/#1-single-source-of-truth","title":"1. Single Source of Truth","text":"<pre><code>pom.xml\n \u2193\n \u2192 GitHub Actions (extracts)\n \u2193\n \u2192 Container Tags\n \u2192 Release Artifacts\n \u2192 GitHub Releases\n</code></pre> <p>One place to update = No synchronization issues</p>"},{"location":"version-automation/#2-reduced-maintenance","title":"2. Reduced Maintenance","text":"<p>Before: <pre><code># Update version in 2 places\nvim pom.xml # Change to 0.4.0\nvim .github/workflows/release.yml # Change to 0.4.0\ngit add pom.xml .github/workflows/release.yml\n</code></pre></p> <p>After: <pre><code># Update version in 1 place\nvim pom.xml # Change to 0.4.0\ngit add pom.xml\n# Complete.\n</code></pre></p>"},{"location":"version-automation/#3-prevents-drift","title":"3. Prevents Drift","text":"<p>Before: - pom.xml: <code>0.3.0</code> - release.yml: <code>0.2.0</code> - Result: Wrong version in releases!</p> <p>After: - pom.xml: <code>0.3.0</code> - release.yml: Automatically uses <code>0.3.0</code> - Result: Always correct!</p>"},{"location":"version-automation/#4-semantic-versioning-support","title":"4. Semantic Versioning Support","text":"<p>Works with any valid Maven version format:</p> <ul> <li>Release: <code>1.0.0</code></li> <li>Snapshot: <code>1.0.1-SNAPSHOT</code></li> <li>Qualifier: <code>1.0.0-RC1</code></li> <li>Date-based: <code>2024.11.20</code></li> </ul> <p>All automatically extracted and used!</p>"},{"location":"version-automation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"version-automation/#issue-version-shows-as-empty","title":"Issue: Version Shows as Empty","text":"<p>Symptoms: <pre><code>Extracted version from pom.xml:\n# Empty!\n</code></pre></p> <p>Cause: Maven command failed or pom.xml has issues</p> <p>Solution: 1. Check pom.xml is valid:  <pre><code>mvn validate\n</code></pre> 2. Check version is defined:  <pre><code>mvn help:evaluate -Dexpression=project.version -q -DforceStdout\n</code></pre> 3. Check GitHub Actions logs for Maven errors</p>"},{"location":"version-automation/#issue-wrong-version-extracted","title":"Issue: Wrong Version Extracted","text":"<p>Symptoms: <pre><code>Extracted version from pom.xml: 3.29.4\n# Expected: 0.3.0\n</code></pre></p> <p>Cause: Maven is reading a parent POM version or dependency version</p> <p>Solution: 1. Ensure <code>&lt;version&gt;</code> tag is in your project's <code>pom.xml</code>:  <pre><code>&lt;project&gt;\n&lt;version&gt;0.3.0&lt;/version&gt; &lt;!-- Must be here --&gt;\n</code></pre> 2. If using parent POM, ensure project has its own version 3. Check with local Maven:  <pre><code>cd /path/to/project\nmvn help:evaluate -Dexpression=project.version -q -DforceStdout\n</code></pre></p>"},{"location":"version-automation/#issue-artifacts-not-found","title":"Issue: Artifacts Not Found","text":"<p>Symptoms: <pre><code>mv: cannot stat 'artifacts/runner-jar/keycloak-mcp-server-0.3.0-runner.jar': No such file\n</code></pre></p> <p>Cause: Artifact filenames don't match the extracted version</p> <p>Solution: 1. Ensure build jobs use the same version from pom.xml 2. Check artifact upload step uses wildcard: <code>keycloak-mcp-server-*-runner.jar</code> 3. Verify pom.xml version matches built artifact names</p>"},{"location":"version-automation/#testing-locally","title":"Testing Locally","text":"<p>You can test the version extraction locally:</p> <pre><code># Extract version\nVERSION=$(mvn help:evaluate -Dexpression=project.version -q -DforceStdout)\necho \"Version: $VERSION\"\n\n# Test artifact naming\necho \"Artifact would be: keycloak-mcp-server-${VERSION}-runner.jar\"\n\n# Test container tag\necho \"Container tag would be: quay.io/sshaaf/keycloak-mcp-server:${VERSION}\"\n</code></pre>"},{"location":"version-automation/#best-practices","title":"Best Practices","text":""},{"location":"version-automation/#1-version-bumping","title":"1. Version Bumping","text":"<p>Use Maven versions plugin for consistency:</p> <pre><code># Bump to next development version\nmvn versions:set -DnewVersion=0.4.0-SNAPSHOT\n\n# Bump to release version\nmvn versions:set -DnewVersion=0.4.0\n\n# Remove backup files\nmvn versions:commit\n</code></pre>"},{"location":"version-automation/#2-semantic-versioning","title":"2. Semantic Versioning","text":"<p>Follow semantic versioning in pom.xml:</p> <ul> <li>Major (breaking changes): <code>1.0.0</code> \u2192 <code>2.0.0</code></li> <li>Minor (new features): <code>1.0.0</code> \u2192 <code>1.1.0</code></li> <li>Patch (bug fixes): <code>1.0.0</code> \u2192 <code>1.0.1</code></li> </ul> <p>GitHub Actions will automatically use the correct version!</p>"},{"location":"version-automation/#3-pre-release-versions","title":"3. Pre-release Versions","text":"<p>Use qualifiers for pre-releases:</p> <pre><code>&lt;version&gt;1.0.0-RC1&lt;/version&gt; &lt;!-- Release Candidate --&gt;\n&lt;version&gt;1.0.0-beta.1&lt;/version&gt; &lt;!-- Beta --&gt;\n&lt;version&gt;1.0.0-alpha&lt;/version&gt; &lt;!-- Alpha --&gt;\n</code></pre> <p>These will be extracted and used as-is in container tags and releases.</p>"},{"location":"version-automation/#4-snapshot-development","title":"4. Snapshot Development","text":"<p>Use <code>-SNAPSHOT</code> for development:</p> <pre><code>&lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n</code></pre> <p>Note: Snapshots are typically not released, but the version will still be extracted correctly if you trigger a release workflow.</p>"},{"location":"version-automation/#summary","title":"Summary","text":"<p>Single source of truth: Version only in <code>pom.xml</code> Automatic extraction: Maven reads version at runtime  Always in sync: No drift between pom.xml and CI/CD  Less maintenance: No manual workflow updates  Semantic versioning: Works with any Maven version format  Transparent: Logs show extracted version</p> <p>No more version drift!</p> <p>Your GitHub Actions will always use the version from <code>pom.xml</code> automatically.</p>"},{"location":"version-automation/#related-documentation","title":"Related Documentation","text":"<ul> <li>github-actions-setup.md - CI/CD setup guide</li> <li>git-commit-tagging.md - Git SHA tagging</li> <li>ci-cd-updates.md - All CI/CD changes</li> </ul>"}]}